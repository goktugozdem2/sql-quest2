window.SUPABASE_URL="https://abmgtjafghpupaqsjnwe.supabase.co",window.SUPABASE_ANON_KEY="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFibWd0amFmZ2hwdXBhcXNqbndlIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njg5MzIzMjMsImV4cCI6MjA4NDUwODMyM30.8KS-UKN1r8YANggQ9HqsQmSHY95ghRL1Oq_d5LO19y4",window.gameLevels=[{name:"Novice",minXP:0},{name:"Apprentice",minXP:100},{name:"Developer",minXP:300},{name:"Engineer",minXP:600},{name:"Architect",minXP:1e3},{name:"Master",minXP:1500},{name:"SQL Wizard",minXP:2500}],window.gameAchievements=[{id:"first_query",name:"First Steps",desc:"Run your first SQL query",icon:"Star",xp:10},{id:"streak_3",name:"On Fire!",desc:"3 correct in a row",icon:"Flame",xp:25},{id:"streak_5",name:"Unstoppable",desc:"5 correct in a row",icon:"Zap",xp:50},{id:"data_explorer",name:"Data Explorer",desc:"Try 3 different datasets",icon:"Database",xp:30},{id:"csv_master",name:"CSV Master",desc:"Upload your own dataset",icon:"Upload",xp:40},{id:"query_50",name:"Query Machine",desc:"Run 50 queries",icon:"Code",xp:50},{id:"analyst",name:"Data Analyst",desc:"Use GROUP BY with HAVING",icon:"BarChart3",xp:35},{id:"challenge_5",name:"Challenger",desc:"Solve 5 challenges",icon:"Target",xp:40},{id:"challenge_10",name:"Problem Solver",desc:"Solve 10 challenges",icon:"Award",xp:75},{id:"challenge_20",name:"SQL Expert",desc:"Solve 20 challenges",icon:"Zap",xp:100},{id:"challenge_30",name:"SQL Pro",desc:"Solve 30 challenges",icon:"Medal",xp:150},{id:"challenge_all",name:"Challenge Master",desc:"Solve all 40 challenges",icon:"Trophy",xp:250},{id:"string_master",name:"String Wizard",desc:"Complete all String Function challenges",icon:"Code",xp:100},{id:"graduate",name:"Graduate",desc:"Complete all AI lessons",icon:"Trophy",xp:100},{id:"first_interview",name:"Interview Ready",desc:"Complete your first mock interview",icon:"Briefcase",xp:50},{id:"interview_pass",name:"Hired!",desc:"Pass a mock interview",icon:"CheckCircle",xp:75},{id:"perfect_interview",name:"Perfect Candidate",desc:"Score 100% on any interview",icon:"Crown",xp:150},{id:"speed_demon",name:"Speed Demon",desc:"Pass an interview using less than 50% of time",icon:"Zap",xp:100},{id:"no_hints",name:"Self-Reliant",desc:"Pass an interview without using hints",icon:"Brain",xp:75},{id:"comeback_king",name:"Comeback King",desc:"Pass an interview after failing it",icon:"TrendingUp",xp:100},{id:"interview_streak",name:"Interview Marathon",desc:"Complete 3 interviews in one day",icon:"Flame",xp:100},{id:"all_interviews",name:"Interview Master",desc:"Pass all available interviews",icon:"Trophy",xp:300},{id:"sql_master_30",name:"30-Day SQL Master",desc:"Complete all 30 days of the SQL Master Challenge",icon:"Crown",xp:500},{id:"weakness_first",name:"Self Improver",desc:"Master your first weakness",icon:"Target",xp:50},{id:"weakness_5",name:"Weakness Crusher",desc:"Master 5 weaknesses",icon:"Shield",xp:150},{id:"weakness_10",name:"Skill Master",desc:"Master 10 weaknesses",icon:"Trophy",xp:300},{id:"skill_70",name:"Well Rounded",desc:"Reach 70%+ on all skill areas",icon:"Star",xp:200},{id:"review_streak",name:"Consistent Learner",desc:"Complete 7 spaced repetition reviews",icon:"Calendar",xp:100}],window.publicDatasetsData={titanic:{name:"Titanic Passengers",icon:"Ship",description:"891 passengers from the Titanic disaster - Classic Kaggle ML dataset",source:"Kaggle",tables:{passengers:{columns:["passenger_id","survived","pclass","name","sex","age","sibsp","parch","fare","embarked"],data:[[1,0,3,"Braund, Mr. Owen Harris","male",22,1,0,7.25,"S"],[2,1,1,"Cumings, Mrs. John Bradley","female",38,1,0,71.28,"C"],[3,1,3,"Heikkinen, Miss. Laina","female",26,0,0,7.93,"S"],[4,1,1,"Futrelle, Mrs. Jacques Heath","female",35,1,0,53.1,"S"],[5,0,3,"Allen, Mr. William Henry","male",35,0,0,8.05,"S"],[6,0,3,"Moran, Mr. James","male",null,0,0,8.46,"Q"],[7,0,1,"McCarthy, Mr. Timothy J","male",54,0,0,51.86,"S"],[8,0,3,"Palsson, Master. Gosta Leonard","male",2,3,1,21.08,"S"],[9,1,3,"Johnson, Mrs. Oscar W","female",27,0,2,11.13,"S"],[10,1,2,"Nasser, Mrs. Nicholas","female",14,1,0,30.07,"C"],[11,1,3,"Sandstrom, Miss. Marguerite Rut","female",4,1,1,16.7,"S"],[12,1,1,"Bonnell, Miss. Elizabeth","female",58,0,0,26.55,"S"],[13,0,3,"Saundercock, Mr. William Henry","male",20,0,0,8.05,"S"],[14,0,3,"Andersson, Mr. Anders Johan","male",39,1,5,31.28,"S"],[15,0,3,"Vestrom, Miss. Hulda Amanda","female",14,0,0,7.85,"S"],[16,1,2,"Hewlett, Mrs. (Mary D Kingcome)","female",55,0,0,16,"S"],[17,0,3,"Rice, Master. Eugene","male",2,4,1,29.13,"Q"],[18,1,2,"Williams, Mr. Charles Eugene","male",null,0,0,13,"S"],[19,0,3,"Vander Planke, Mrs. Julius","female",31,1,0,18,"S"],[20,1,3,"Masselmani, Mrs. Fatima","female",null,0,0,7.23,"C"],[21,0,2,"Fynney, Mr. Joseph J","male",35,0,0,26,"S"],[22,1,2,"Beesley, Mr. Lawrence","male",34,0,0,13,"S"],[23,1,3,"McGowan, Miss. Anna","female",15,0,0,8.03,"Q"],[24,1,1,"Sloper, Mr. William Thompson","male",28,0,0,35.5,"S"],[25,0,3,"Palsson, Miss. Torborg Danira","female",8,3,1,21.08,"S"],[26,1,3,"Asplund, Mrs. Carl Oscar","female",38,1,5,31.39,"S"],[27,0,3,"Emir, Mr. Farred Chehab","male",null,0,0,7.23,"C"],[28,0,1,"Fortune, Mr. Charles Alexander","male",19,3,2,263,"S"],[29,1,3,"O'Dwyer, Miss. Ellen","female",null,0,0,7.88,"Q"],[30,0,3,"Todoroff, Mr. Lalio","male",null,0,0,7.9,"S"],[31,0,1,"Uruchurtu, Don. Manuel E","male",40,0,0,27.72,"C"],[32,1,1,"Spencer, Mrs. William Augustus","female",null,1,0,146.52,"C"],[33,1,3,"Glynn, Miss. Mary Agatha","female",null,0,0,7.75,"Q"],[34,0,2,"Wheadon, Mr. Edward H","male",66,0,0,10.5,"S"],[35,0,1,"Meyer, Mr. Edgar Joseph","male",28,1,0,82.17,"C"],[36,0,1,"Holverson, Mr. Alexander Oskar","male",42,1,0,52,"S"],[37,1,3,"Mamee, Mr. Hanna","male",null,0,0,7.23,"C"],[38,0,3,"Cann, Mr. Ernest Charles","male",21,0,0,8.05,"S"],[39,0,3,"Vander Planke, Miss. Augusta","female",18,2,0,18,"S"],[40,1,3,"Nicola-Yarred, Miss. Jamila","female",14,1,0,11.24,"C"],[41,0,3,"Ahlin, Mrs. Johan","female",40,1,0,9.48,"S"],[42,0,2,"Turpin, Mrs. William John","female",27,1,0,21,"S"],[43,0,3,"Kraeff, Mr. Theodor","male",null,0,0,7.9,"C"],[44,1,2,"Laroche, Miss. Simonne Marie","female",3,1,2,41.58,"C"],[45,1,3,"Devaney, Miss. Margaret Delia","female",19,0,0,7.88,"Q"],[46,0,3,"Rogers, Mr. William John","male",null,0,0,8.05,"S"],[47,0,3,"Lennon, Mr. Denis","male",null,1,0,15.5,"Q"],[48,1,3,"O'Driscoll, Miss. Bridget","female",null,0,0,7.75,"Q"],[49,0,3,"Samaan, Mr. Youssef","male",null,2,0,21.68,"C"],[50,0,3,"Arnold-Franchi, Mrs. Josef","female",18,1,0,17.8,"S"],[51,0,3,"Panula, Master. Juha Niilo","male",7,4,1,39.69,"S"],[52,0,3,"Nosworthy, Mr. Richard Cater","male",21,0,0,7.8,"S"],[53,1,1,"Harper, Mrs. Henry Sleeper","female",49,1,0,76.73,"C"],[54,1,2,"Faunthorpe, Mrs. Lizzie","female",29,1,0,26,"S"],[55,0,1,"Ostby, Mr. Engelhart Cornelius","male",65,0,1,61.98,"C"],[56,1,1,"Woolner, Mr. Hugh","male",null,0,0,35.5,"S"],[57,1,2,"Rugg, Miss. Emily","female",21,0,0,10.5,"S"],[58,0,3,"Novel, Mr. Mansouer","male",28.5,0,0,7.23,"C"],[59,1,2,"West, Miss. Constance Mirium","female",5,1,2,27.75,"S"],[60,0,3,"Goodwin, Master. William Frederick","male",11,5,2,46.9,"S"],[61,0,3,"Sirayanian, Mr. Orsen","male",22,0,0,7.23,"C"],[62,1,1,"Icard, Miss. Amelie","female",38,0,0,80,""],[63,0,1,"Harris, Mr. Henry Birkhardt","male",45,1,0,83.48,"S"],[64,0,3,"Skoog, Master. Harald","male",4,3,2,27.9,"S"],[65,0,1,"Stewart, Mr. Albert A","male",null,0,0,27.72,"C"],[66,1,3,"Moubarek, Master. Gerios","male",null,1,1,15.25,"C"],[67,1,2,"Nye, Mrs. (Elizabeth Ramell)","female",29,0,0,10.5,"S"],[68,0,3,"Crease, Mr. Ernest James","male",19,0,0,8.16,"S"],[69,1,3,"Andersson, Miss. Erna Alexandra","female",17,4,2,7.93,"S"],[70,0,3,"Kink, Mr. Vincenz","male",26,2,0,8.66,"S"],[71,0,2,"Jenkin, Mr. Stephen Curnow","male",32,0,0,10.5,"S"],[72,0,3,"Goodwin, Miss. Lillian Amy","female",16,5,2,46.9,"S"],[73,0,2,"Hood, Mr. Ambrose Jr","male",21,0,0,73.5,"S"],[74,0,3,"Chronopoulos, Mr. Apostolos","male",26,1,0,14.45,"C"],[75,1,3,"Bing, Mr. Lee","male",32,0,0,56.5,"S"],[76,0,3,"Moen, Mr. Sigurd Hansen","male",25,0,0,7.65,"S"],[77,0,3,"Staneff, Mr. Ivan","male",null,0,0,7.9,"S"],[78,0,3,"Moutal, Mr. Rahamin Haim","male",null,0,0,8.05,"S"],[79,1,2,"Caldwell, Master. Alden Gates","male",.83,0,2,29,"S"],[80,1,3,"Dowdell, Miss. Elizabeth","female",30,0,0,12.48,"S"],[81,0,3,"Waelens, Mr. Achille","male",22,0,0,9,"S"],[82,1,3,"Sheerlinck, Mr. Jan Baptist","male",29,0,0,9.5,"S"],[83,1,3,"McDermott, Miss. Brigdet Delia","female",null,0,0,7.79,"Q"],[84,0,1,"Carrau, Mr. Francisco M","male",28,0,0,47.1,"S"],[85,1,2,"Ilett, Miss. Bertha","female",17,0,0,10.5,"S"],[86,1,3,"Backstrom, Mrs. Karl Alfred","female",33,3,0,15.85,"S"],[87,0,3,"Ford, Mr. William Neal","male",16,1,3,34.38,"S"],[88,0,3,"Slocovski, Mr. Selman Francis","male",null,0,0,8.05,"S"],[89,1,1,"Fortune, Miss. Mabel Helen","female",23,3,2,263,"S"],[90,0,3,"Celotti, Mr. Francesco","male",24,0,0,8.05,"S"],[91,0,3,"Christmann, Mr. Emil","male",29,0,0,8.05,"S"],[92,0,3,"Andreasson, Mr. Paul Edvin","male",20,0,0,7.85,"S"],[93,0,1,"Chaffee, Mr. Herbert Fuller","male",46,1,0,61.18,"S"],[94,0,3,"Dean, Mr. Bertram Frank","male",26,1,2,20.58,"S"],[95,0,3,"Coxon, Mr. Daniel","male",59,0,0,7.25,"S"],[96,0,3,"Shorney, Mr. Charles Joseph","male",null,0,0,8.05,"S"],[97,0,1,"Goldschmidt, Mr. George B","male",71,0,0,34.65,"C"],[98,1,1,"Greenfield, Mr. William Bertram","male",23,0,1,63.36,"C"],[99,1,2,"Doling, Mrs. John T","female",34,0,1,23,"S"],[100,0,2,"Kantor, Mr. Sinai","male",34,1,0,26,"S"]]}},sampleQueries:["SELECT * FROM passengers LIMIT 10","SELECT name, age, survived FROM passengers WHERE survived = 1","SELECT pclass, COUNT(*) as count FROM passengers GROUP BY pclass","SELECT sex, AVG(age) as avg_age, COUNT(*) as count FROM passengers GROUP BY sex","SELECT * FROM passengers WHERE age > 50 ORDER BY age DESC"]},movies:{name:"Top Movies",icon:"Film",description:"100 top-rated movies with box office data",source:"IMDB",tables:{movies:{columns:["id","title","year","genre","rating","votes","revenue_millions","runtime","director"],data:[[1,"Guardians of the Galaxy",2014,"Action",8.1,757074,333.13,121,"James Gunn"],[2,"Prometheus",2012,"Adventure",7,485820,126.46,124,"Ridley Scott"],[3,"Split",2016,"Horror",7.3,157606,138.12,117,"M. Night Shyamalan"],[4,"Sing",2016,"Animation",7.2,60545,270.32,108,"Christophe Lourdelet"],[5,"Suicide Squad",2016,"Action",6.2,393727,325.02,123,"David Ayer"],[6,"The Great Wall",2016,"Action",6.1,56036,45.13,103,"Yimou Zhang"],[7,"La La Land",2016,"Comedy",8.3,258682,151.06,128,"Damien Chazelle"],[8,"Mindhorn",2016,"Comedy",6.4,2490,0,89,"Sean Foley"],[9,"The Lost City of Z",2016,"Action",7.1,7188,8.01,141,"James Gray"],[10,"Passengers",2016,"Adventure",7,192177,100.01,116,"Morten Tyldum"],[11,"Fantastic Beasts",2016,"Adventure",7.5,232072,234.02,133,"David Yates"],[12,"Hidden Figures",2016,"Biography",7.8,93103,169.27,127,"Theodore Melfi"],[13,"Rogue One",2016,"Action",7.9,323118,532.17,133,"Gareth Edwards"],[14,"Moana",2016,"Animation",7.7,118151,248.75,107,"Ron Clements"],[15,"Colossal",2016,"Action",6.4,12262,2.87,109,"Nacho Vigalondo"],[16,"The Secret Life of Pets",2016,"Animation",6.6,120259,368.31,87,"Chris Renaud"],[17,"Hacksaw Ridge",2016,"Biography",8.2,211760,67.12,139,"Mel Gibson"],[18,"Jason Bourne",2016,"Action",6.7,150823,162.16,123,"Paul Greengrass"],[19,"Lion",2016,"Biography",8.1,102061,51.69,118,"Garth Davis"],[20,"Gold",2016,"Adventure",6.7,19053,7.22,120,"Stephen Gaghan"],[21,"Hail, Caesar!",2016,"Comedy",6.3,56671,30,106,"Ethan Coen"],[22,"Sausage Party",2016,"Animation",6.3,88557,97.66,89,"Greg Tiernan"],[23,"Trolls",2016,"Animation",6.5,45465,153.69,92,"Mike Mitchell"],[24,"Independence Day: Resurgence",2016,"Action",5.3,107950,103.14,120,"Roland Emmerich"],[25,"Paris pieds nus",2016,"Comedy",6.8,222,0,83,"Dominique Abel"],[26,"Captain Fantastic",2016,"Drama",7.9,87596,5.88,118,"Matt Ross"],[27,"Tarzan",2016,"Action",6.3,66706,126.64,109,"David Yates"],[28,"Doctor Strange",2016,"Action",7.5,269189,232.6,115,"Scott Derrickson"],[29,"Bad Moms",2016,"Comedy",6.2,78340,113.08,100,"Jon Lucas"],[30,"Assassin's Creed",2016,"Action",5.9,112759,54.65,115,"Justin Kurzel"],[31,"Why Him?",2016,"Comedy",6.3,35847,60.31,111,"John Hamburg"],[32,"X-Men: Apocalypse",2016,"Action",7,285990,155.33,144,"Bryan Singer"],[33,"Deadpool",2016,"Action",8,649113,363.02,108,"Tim Miller"],[34,"Resident Evil: The Final Chapter",2016,"Action",5.6,40867,26.84,107,"Paul W.S. Anderson"],[35,"Captain America: Civil War",2016,"Action",7.8,383958,408.08,147,"Anthony Russo"],[36,"Interstellar",2014,"Adventure",8.6,1047747,187.99,169,"Christopher Nolan"],[37,"The Dark Knight",2008,"Action",9,1791916,533.32,152,"Christopher Nolan"],[38,"Inception",2010,"Action",8.8,1583625,292.57,148,"Christopher Nolan"],[39,"The Matrix",1999,"Action",8.7,1350219,171.38,136,"Lana Wachowski"],[40,"Fight Club",1999,"Drama",8.8,1418355,37.03,139,"David Fincher"],[41,"Pulp Fiction",1994,"Crime",8.9,1473449,107.93,154,"Quentin Tarantino"],[42,"Forrest Gump",1994,"Drama",8.8,1379518,677.39,142,"Robert Zemeckis"],[43,"The Lord of the Rings: Fellowship",2001,"Adventure",8.8,1366916,314.78,178,"Peter Jackson"],[44,"The Lord of the Rings: Two Towers",2002,"Adventure",8.7,1225974,340.48,179,"Peter Jackson"],[45,"The Lord of the Rings: Return",2003,"Adventure",8.9,1343557,377.02,201,"Peter Jackson"],[46,"Star Wars: Episode IV",1977,"Action",8.7,999258,460.94,121,"George Lucas"],[47,"Star Wars: Episode V",1980,"Action",8.8,913780,290.27,124,"Irvin Kershner"],[48,"Star Wars: Episode VI",1983,"Action",8.4,742697,309.13,131,"Richard Marquand"],[49,"The Godfather",1972,"Crime",9.2,1188644,134.97,175,"Francis Ford Coppola"],[50,"The Godfather Part II",1974,"Crime",9,855894,57.3,202,"Francis Ford Coppola"],[51,"Goodfellas",1990,"Biography",8.7,823697,46.84,146,"Martin Scorsese"],[52,"The Shawshank Redemption",1994,"Drama",9.3,1879049,28.34,142,"Frank Darabont"],[53,"Schindler's List",1993,"Biography",8.9,994095,96.07,195,"Steven Spielberg"],[54,"Saving Private Ryan",1998,"Drama",8.6,979380,216.12,169,"Steven Spielberg"],[55,"The Silence of the Lambs",1991,"Crime",8.6,1005055,130.74,118,"Jonathan Demme"],[56,"Se7en",1995,"Crime",8.6,1166021,100.13,127,"David Fincher"],[57,"The Departed",2006,"Crime",8.5,951957,132.37,151,"Martin Scorsese"],[58,"The Usual Suspects",1995,"Crime",8.6,832265,23.24,106,"Bryan Singer"],[59,"Memento",2e3,"Mystery",8.5,947854,25.53,113,"Christopher Nolan"],[60,"American History X",1998,"Drama",8.5,889770,6.72,119,"Tony Kaye"],[61,"Gladiator",2e3,"Action",8.5,1116191,187.71,155,"Ridley Scott"],[62,"The Prestige",2006,"Drama",8.5,933087,53.09,130,"Christopher Nolan"],[63,"Django Unchained",2012,"Drama",8.4,1070750,162.81,165,"Quentin Tarantino"],[64,"The Wolf of Wall Street",2013,"Biography",8.2,899680,116.87,180,"Martin Scorsese"],[65,"Inglourious Basterds",2009,"Adventure",8.3,937850,120.52,153,"Quentin Tarantino"],[66,"The Revenant",2015,"Adventure",8,510850,183.64,156,"Alejandro Iñárritu"],[67,"Mad Max: Fury Road",2015,"Action",8.1,640554,153.63,120,"George Miller"],[68,"The Martian",2015,"Adventure",8,528268,228.43,144,"Ridley Scott"],[69,"Whiplash",2014,"Drama",8.5,487582,13.09,107,"Damien Chazelle"],[70,"Gone Girl",2014,"Drama",8.1,646679,167.77,149,"David Fincher"],[71,"John Wick",2014,"Action",7.2,309848,43.04,101,"Chad Stahelski"],[72,"Ex Machina",2014,"Drama",7.7,369818,25.44,108,"Alex Garland"],[73,"The Grand Budapest Hotel",2014,"Adventure",8.1,515581,59.07,99,"Wes Anderson"],[74,"Nightcrawler",2014,"Crime",7.9,369516,32.38,117,"Dan Gilroy"],[75,"Birdman",2014,"Comedy",7.8,442530,42.34,119,"Alejandro Iñárritu"],[76,"Edge of Tomorrow",2014,"Action",7.9,407376,100.21,113,"Doug Liman"],[77,"The Imitation Game",2014,"Biography",8.1,525507,91.13,114,"Morten Tyldum"],[78,"Boyhood",2014,"Drama",7.9,279818,25.36,165,"Richard Linklater"],[79,"Room",2015,"Drama",8.2,265573,14.68,118,"Lenny Abrahamson"],[80,"Spotlight",2015,"Biography",8.1,311151,45.06,128,"Tom McCarthy"],[81,"Inside Out",2015,"Animation",8.2,432470,356.45,94,"Pete Docter"],[82,"The Hateful Eight",2015,"Crime",7.8,343776,54.12,167,"Quentin Tarantino"],[83,"Sicario",2015,"Action",7.6,253445,46.89,121,"Denis Villeneuve"],[84,"Brooklyn",2015,"Drama",7.5,102429,38.32,111,"John Crowley"],[85,"Star Wars: The Force Awakens",2015,"Action",8.1,712062,936.63,138,"J.J. Abrams"],[86,"The Big Short",2015,"Biography",7.8,241309,70.26,130,"Adam McKay"],[87,"Straight Outta Compton",2015,"Biography",7.9,136462,161.2,147,"F. Gary Gray"],[88,"Creed",2015,"Drama",7.6,147002,109.77,133,"Ryan Coogler"],[89,"Arrival",2016,"Drama",8,391727,100.55,116,"Denis Villeneuve"],[90,"Hell or High Water",2016,"Crime",7.7,101413,26.86,102,"David Mackenzie"],[91,"Manchester by the Sea",2016,"Drama",7.9,145915,47.7,137,"Kenneth Lonergan"],[92,"Moonlight",2016,"Drama",7.5,138639,27.85,111,"Barry Jenkins"],[93,"Zootopia",2016,"Animation",8.1,316880,341.26,108,"Byron Howard"],[94,"Finding Dory",2016,"Animation",7.4,182931,486.29,97,"Andrew Stanton"],[95,"10 Cloverfield Lane",2016,"Drama",7.2,187603,72.08,103,"Dan Trachtenberg"],[96,"The Jungle Book",2016,"Adventure",7.5,228194,364,106,"Jon Favreau"],[97,"Kubo and the Two Strings",2016,"Animation",7.9,54966,48.02,101,"Travis Knight"],[98,"Central Intelligence",2016,"Action",6.3,121926,127.44,107,"Rawson M. Thurber"],[99,"The Nice Guys",2016,"Action",7.4,144091,36.26,116,"Shane Black"],[100,"The Conjuring 2",2016,"Horror",7.4,150149,102.47,134,"James Wan"]]}},sampleQueries:["SELECT * FROM movies ORDER BY rating DESC LIMIT 10","SELECT genre, COUNT(*) as count, AVG(rating) as avg_rating FROM movies GROUP BY genre ORDER BY count DESC","SELECT title, year, revenue_millions FROM movies WHERE revenue_millions > 200 ORDER BY revenue_millions DESC","SELECT director, COUNT(*) as films, AVG(rating) as avg_rating FROM movies GROUP BY director HAVING COUNT(*) >= 2 ORDER BY avg_rating DESC"]},employees:{name:"Company Employees",icon:"Users",description:"50 employees with departments, salaries, and performance data",source:"Sample HR Data",tables:{employees:{columns:["emp_id","name","department","position","salary","hire_date","manager_id","performance_rating"],data:[[1,"Alice Johnson","Engineering","Senior Developer",95e3,"2019-03-15",5,4.5],[2,"Bob Smith","Engineering","Developer",75e3,"2020-06-01",1,3.8],[3,"Carol Williams","Marketing","Marketing Manager",85e3,"2018-09-20",null,4.2],[4,"David Brown","Sales","Sales Rep",55e3,"2021-01-10",7,3.5],[5,"Eva Martinez","Engineering","Tech Lead",11e4,"2017-04-25",null,4.8],[6,"Frank Davis","HR","HR Specialist",6e4,"2020-11-15",10,3.9],[7,"Grace Lee","Sales","Sales Manager",9e4,"2018-02-28",null,4.4],[8,"Henry Wilson","Engineering","Developer",72e3,"2021-07-01",1,3.6],[9,"Iris Taylor","Marketing","Marketing Specialist",58e3,"2022-01-15",3,4],[10,"Jack Anderson","HR","HR Manager",8e4,"2016-08-10",null,4.3],[11,"Karen Thomas","Engineering","Senior Developer",92e3,"2019-05-20",5,4.1],[12,"Leo Jackson","Sales","Sales Rep",52e3,"2022-03-01",7,3.2],[13,"Maria White","Finance","Accountant",65e3,"2020-04-15",16,3.7],[14,"Nathan Harris","Engineering","Developer",7e4,"2021-09-01",1,3.4],[15,"Olivia Martin","Marketing","Content Creator",48e3,"2022-06-01",3,4.2],[16,"Paul Thompson","Finance","Finance Manager",95e3,"2017-11-01",null,4.6],[17,"Quinn Garcia","Engineering","QA Engineer",68e3,"2020-08-15",5,3.9],[18,"Rachel Robinson","Sales","Sales Rep",54e3,"2021-12-01",7,3.8],[19,"Sam Clark","HR","Recruiter",55e3,"2021-03-15",10,4],[20,"Tina Lewis","Engineering","DevOps Engineer",88e3,"2019-10-01",5,4.4],[21,"Uma Walker","Marketing","SEO Specialist",52e3,"2022-02-15",3,3.5],[22,"Victor Hall","Finance","Financial Analyst",72e3,"2020-01-20",16,4.1],[23,"Wendy Allen","Engineering","Developer",74e3,"2020-05-01",1,3.7],[24,"Xavier Young","Sales","Account Executive",65e3,"2019-08-15",7,4.3],[25,"Yolanda King","HR","Training Coordinator",58e3,"2021-06-01",10,3.8],[26,"Zach Wright","Engineering","Security Engineer",9e4,"2018-12-01",5,4.5],[27,"Amy Scott","Marketing","Brand Manager",75e3,"2019-02-15",3,4],[28,"Brian Green","Finance","Tax Specialist",7e4,"2020-09-01",16,3.6],[29,"Cynthia Adams","Engineering","Data Scientist",98e3,"2019-07-15",5,4.7],[30,"Derek Baker","Sales","Sales Rep",51e3,"2022-04-01",7,3.3],[31,"Emily Nelson","HR","Benefits Administrator",52e3,"2021-10-15",10,3.9],[32,"Felix Hill","Engineering","Frontend Developer",76e3,"2020-12-01",1,4],[33,"Gina Rivera","Marketing","Social Media Manager",55e3,"2021-04-15",3,4.1],[34,"Howard Campbell","Finance","Auditor",68e3,"2019-11-01",16,3.8],[35,"Irene Mitchell","Engineering","Backend Developer",78e3,"2020-03-15",1,3.9],[36,"Jason Roberts","Sales","Regional Manager",1e5,"2017-06-01",null,4.6],[37,"Kelly Turner","HR","Compensation Analyst",62e3,"2020-07-15",10,4.2],[38,"Lucas Phillips","Engineering","Mobile Developer",82e3,"2019-09-01",5,4.3],[39,"Monica Evans","Marketing","PR Specialist",57e3,"2021-08-01",3,3.7],[40,"Neil Edwards","Finance","Budget Analyst",66e3,"2020-11-15",16,3.5],[41,"Ophelia Collins","Engineering","ML Engineer",105e3,"2018-10-01",5,4.8],[42,"Peter Stewart","Sales","Sales Rep",53e3,"2022-01-15",7,3.4],[43,"Quincy Sanchez","HR","Employee Relations",58e3,"2021-05-01",10,4],[44,"Rita Morris","Engineering","Database Admin",85e3,"2019-01-15",5,4.1],[45,"Steve Rogers","Marketing","Marketing Analyst",6e4,"2020-10-01",3,3.8],[46,"Teresa Murphy","Finance","Controller",98e3,"2017-03-15",16,4.4],[47,"Ulysses Cook","Engineering","Cloud Architect",115e3,"2018-05-01",null,4.9],[48,"Violet Bailey","Sales","Inside Sales",48e3,"2022-05-01",7,3.1],[49,"Walter Rivera","HR","Payroll Specialist",54e3,"2021-02-15",10,3.7],[50,"Xena Cooper","Engineering","Senior Developer",94e3,"2019-06-01",5,4.2]]}},sampleQueries:["SELECT * FROM employees ORDER BY salary DESC LIMIT 10","SELECT department, COUNT(*) as count, AVG(salary) as avg_salary FROM employees GROUP BY department","SELECT position, COUNT(*) as count FROM employees GROUP BY position ORDER BY count DESC","SELECT * FROM employees WHERE performance_rating >= 4.0 ORDER BY performance_rating DESC"]},ecommerce:{name:"E-Commerce Orders",icon:"ShoppingCart",description:"100 orders with customer data for JOIN practice",source:"Sample Store Data",tables:{orders:{columns:["order_id","customer_id","product","category","quantity","price","total","order_date","country","status"],data:[[1,1,"Laptop Pro","Electronics",1,1299.99,1299.99,"2024-01-15","USA","completed"],[2,2,"Wireless Mouse","Electronics",2,49.99,99.98,"2024-01-16","Canada","completed"],[3,3,"Office Chair","Furniture",1,349.99,349.99,"2024-01-17","USA","completed"],[4,1,"USB-C Hub","Electronics",1,79.99,79.99,"2024-01-18","USA","completed"],[5,4,"Standing Desk","Furniture",1,599.99,599.99,"2024-01-19","UK","completed"],[6,5,"Mechanical Keyboard","Electronics",1,159.99,159.99,"2024-01-20","Germany","completed"],[7,2,"Monitor 27inch","Electronics",1,399.99,399.99,"2024-01-21","Canada","completed"],[8,6,"Desk Lamp","Furniture",2,45.99,91.98,"2024-01-22","France","completed"],[9,3,"Webcam HD","Electronics",1,89.99,89.99,"2024-01-23","USA","completed"],[10,7,"Filing Cabinet","Furniture",1,199.99,199.99,"2024-01-24","USA","completed"],[11,1,"Headphones","Electronics",1,249.99,249.99,"2024-01-25","USA","completed"],[12,8,"Bookshelf","Furniture",1,179.99,179.99,"2024-01-26","Canada","completed"],[13,4,"Tablet Stand","Electronics",1,39.99,39.99,"2024-01-27","UK","completed"],[14,9,"Ergonomic Mouse","Electronics",1,69.99,69.99,"2024-01-28","Australia","completed"],[15,5,"Coffee Table","Furniture",1,299.99,299.99,"2024-01-29","Germany","completed"],[16,10,"SSD 1TB","Electronics",2,129.99,259.98,"2024-01-30","Japan","completed"],[17,2,"Printer","Electronics",1,199.99,199.99,"2024-02-01","Canada","completed"],[18,6,"Desk Organizer","Furniture",3,24.99,74.97,"2024-02-02","France","completed"],[19,3,"Microphone","Electronics",1,149.99,149.99,"2024-02-03","USA","completed"],[20,1,"RAM 16GB","Electronics",2,89.99,179.98,"2024-02-04","USA","completed"],[21,7,"Bean Bag","Furniture",1,89.99,89.99,"2024-02-05","USA","completed"],[22,4,"External HDD","Electronics",1,79.99,79.99,"2024-02-06","UK","pending"],[23,8,"Wall Clock","Furniture",1,34.99,34.99,"2024-02-07","Canada","completed"],[24,5,"Graphics Card","Electronics",1,549.99,549.99,"2024-02-08","Germany","completed"],[25,9,"Side Table","Furniture",2,99.99,199.98,"2024-02-09","Australia","completed"],[26,10,"Keyboard Wrist Rest","Electronics",1,29.99,29.99,"2024-02-10","Japan","completed"],[27,1,"Power Strip","Electronics",2,24.99,49.98,"2024-02-11","USA","completed"],[28,2,"TV Stand","Furniture",1,249.99,249.99,"2024-02-12","Canada","completed"],[29,6,"USB Drive 64GB","Electronics",5,14.99,74.95,"2024-02-13","France","pending"],[30,3,"Monitor Stand","Furniture",1,59.99,59.99,"2024-02-14","USA","completed"],[31,1,"Webcam 4K","Electronics",1,179.99,179.99,"2024-02-15","USA","completed"],[32,4,"Desk Mat","Furniture",1,49.99,49.99,"2024-02-16","UK","completed"],[33,5,"Router Pro","Electronics",1,199.99,199.99,"2024-02-17","Germany","completed"],[34,2,"Floor Lamp","Furniture",1,129.99,129.99,"2024-02-18","Canada","completed"],[35,3,"Bluetooth Speaker","Electronics",2,79.99,159.98,"2024-02-19","USA","completed"],[36,7,"Office Desk","Furniture",1,449.99,449.99,"2024-02-20","USA","completed"],[37,8,"Tablet Case","Electronics",1,29.99,29.99,"2024-02-21","Canada","cancelled"],[38,9,"Throw Pillow","Furniture",3,19.99,59.97,"2024-02-22","Australia","completed"],[39,10,"Smart Watch","Electronics",1,349.99,349.99,"2024-02-23","Japan","completed"],[40,6,"Bookends","Furniture",2,24.99,49.98,"2024-02-24","France","completed"]]},customers:{columns:["customer_id","name","email","signup_date","membership","total_orders"],data:[[1,"John Smith","john.smith@email.com","2023-01-15","Gold",15],[2,"Emma Wilson","emma.wilson@email.com","2023-03-20","Silver",8],[3,"Michael Brown","michael.brown@email.com","2023-02-10","Gold",12],[4,"Sarah Davis","sarah.davis@email.com","2023-06-05","Bronze",5],[5,"James Johnson","james.johnson@email.com","2023-04-18","Platinum",22],[6,"Emily Taylor","emily.taylor@email.com","2023-07-22","Bronze",3],[7,"Daniel Martinez","daniel.martinez@email.com","2023-05-30","Silver",7],[8,"Olivia Anderson","olivia.anderson@email.com","2023-08-14","Bronze",4],[9,"William Thomas","william.thomas@email.com","2023-09-01","Silver",6],[10,"Sophia Lee","sophia.lee@email.com","2023-10-10","Gold",10],[11,"Amy Taylor","amy.taylor@email.com","2023-11-01","Bronze",0],[12,"Mark Johnson","mark.johnson@email.com","2023-12-15","Platinum",0],[13,"Nina Patel","nina.patel@email.com","2024-01-01","Gold",0]]}},sampleQueries:["SELECT * FROM orders LIMIT 10","SELECT * FROM customers","SELECT orders.product, customers.name FROM orders JOIN customers ON orders.customer_id = customers.customer_id","SELECT customers.name, COUNT(orders.order_id) as order_count, SUM(orders.total) as total_spent FROM customers LEFT JOIN orders ON customers.customer_id = orders.customer_id GROUP BY customers.name","SELECT category, COUNT(*) as count, SUM(total) as revenue FROM orders GROUP BY category ORDER BY revenue DESC"]}},window.challengesData=[{id:1,title:"Surviving Passengers",difficulty:"Easy",category:"SELECT",skills:["SELECT","WHERE"],xpReward:20,description:"Write a SQL query to find all passengers who **survived** the Titanic disaster.",tables:["passengers"],example:{input:"passengers table contains passenger data with a 'survived' column (1 = survived, 0 = died)",output:"All rows where survived = 1"},hint:"Use WHERE to filter rows where survived equals 1",solution:"SELECT * FROM passengers WHERE survived = 1",dataset:"titanic"},{id:2,title:"Top 5 Highest Rated Movies",difficulty:"Easy",category:"ORDER BY",skills:["SELECT","ORDER BY","LIMIT"],xpReward:20,description:"Write a SQL query to find the **top 5 movies** with the highest rating. Return title and rating, sorted by rating descending.",tables:["movies"],example:{input:"movies table with title and rating columns",output:"5 rows with highest ratings"},hint:"Use ORDER BY rating DESC and LIMIT 5",solution:"SELECT title, rating FROM movies ORDER BY rating DESC LIMIT 5",dataset:"movies"},{id:3,title:"Female Passengers",difficulty:"Easy",category:"WHERE",skills:["SELECT","WHERE"],xpReward:20,description:"Write a SQL query to find all **female passengers**. Return their name and age.",tables:["passengers"],example:{input:"passengers table with sex column ('male' or 'female')",output:"All female passengers with name and age"},hint:"Filter WHERE sex = 'female'",solution:"SELECT name, age FROM passengers WHERE sex = 'female'",dataset:"titanic"},{id:4,title:"Expensive Products",difficulty:"Easy",category:"WHERE",skills:["SELECT","WHERE"],xpReward:25,description:"Write a SQL query to find all orders where the **price is greater than $50**. Return product, price, and country.",tables:["orders"],example:{input:"orders table with price column",output:"Orders with price > 50"},hint:"Use WHERE price > 50",solution:"SELECT product, price, country FROM orders WHERE price > 50",dataset:"ecommerce"},{id:5,title:"Unique Movie Genres",difficulty:"Easy",category:"DISTINCT",skills:["SELECT","DISTINCT","ORDER BY"],xpReward:25,description:"Write a SQL query to find all **unique genres** in the movies table.",tables:["movies"],example:{input:"movies table with genre column",output:"List of unique genre names"},hint:"Use SELECT DISTINCT",solution:"SELECT DISTINCT genre FROM movies ORDER BY genre",dataset:"movies"},{id:6,title:"Survival Rate by Class",difficulty:"Medium",category:"GROUP BY",skills:["SELECT","WHERE","GROUP BY","Aggregation"],xpReward:40,description:"Write a SQL query to find the **number of survivors per passenger class** (pclass). Return pclass and the count of survivors.",tables:["passengers"],example:{input:"passengers table with pclass and survived columns",output:"3 rows showing survival count per class"},hint:"Use GROUP BY pclass and filter WHERE survived = 1",solution:"SELECT pclass, COUNT(*) as survivors FROM passengers WHERE survived = 1 GROUP BY pclass",dataset:"titanic"},{id:7,title:"Average Movie Rating by Genre",difficulty:"Medium",category:"GROUP BY",skills:["SELECT","GROUP BY","Aggregation","ORDER BY"],xpReward:40,description:"Write a SQL query to find the **average rating for each genre**. Return genre and average rating (as avg_rating), sorted by average rating descending.",tables:["movies"],example:{input:"movies table with genre and rating columns",output:"Genres with their average ratings, highest first"},hint:"Use GROUP BY genre with AVG(rating), then ORDER BY",solution:"SELECT genre, AVG(rating) as avg_rating FROM movies GROUP BY genre ORDER BY avg_rating DESC",dataset:"movies"},{id:8,title:"High Earning Departments",difficulty:"Medium",category:"HAVING",skills:["SELECT","GROUP BY","HAVING","Aggregation"],xpReward:50,description:"Write a SQL query to find departments where the **average salary exceeds $80,000**. Return department and average salary.",tables:["employees"],example:{input:"employees table with department and salary",output:"Departments with avg salary > 80000"},hint:"Use GROUP BY with HAVING AVG(salary) > 80000",solution:"SELECT department, AVG(salary) as avg_salary FROM employees GROUP BY department HAVING AVG(salary) > 80000",dataset:"employees"},{id:9,title:"Revenue by Country",difficulty:"Medium",category:"GROUP BY",skills:["SELECT","GROUP BY","Aggregation","ORDER BY"],xpReward:45,description:"Write a SQL query to calculate **total revenue by country**. Revenue = quantity × price. Return country and total_revenue, sorted by revenue descending.",tables:["orders"],example:{input:"orders table with country, quantity, price",output:"Countries with their total revenue"},hint:"Use SUM(quantity * price) and GROUP BY country",solution:"SELECT country, SUM(quantity * price) as total_revenue FROM orders GROUP BY country ORDER BY total_revenue DESC",dataset:"ecommerce"},{id:10,title:"Prolific Directors",difficulty:"Medium",category:"HAVING",skills:["SELECT","GROUP BY","HAVING","Aggregation","ORDER BY"],xpReward:50,description:"Write a SQL query to find directors who have directed **3 or more movies**. Return director and number of films, sorted by film count descending.",tables:["movies"],example:{input:"movies table with director column",output:"Directors with 3+ movies"},hint:"GROUP BY director, HAVING COUNT(*) >= 3",solution:"SELECT director, COUNT(*) as films FROM movies GROUP BY director HAVING COUNT(*) >= 3 ORDER BY films DESC",dataset:"movies"},{id:11,title:"Average Salary by Department",difficulty:"Medium",category:"GROUP BY",skills:["SELECT","GROUP BY","Aggregation","ORDER BY"],xpReward:45,description:"Write a SQL query to find the **average salary for each department**. Round to 2 decimal places and sort by average salary descending.",tables:["employees"],example:{input:"employees table with department, salary",output:"Departments with their rounded average salaries"},hint:"Use AVG() with ROUND() and GROUP BY department, then ORDER BY",solution:"SELECT department, ROUND(AVG(salary), 2) FROM employees GROUP BY department ORDER BY ROUND(AVG(salary), 2) DESC",dataset:"employees"},{id:12,title:"Customer Orders",difficulty:"Medium",category:"JOIN",skills:["SELECT","JOIN"],xpReward:55,description:"Write a SQL query to show each order with **customer details**. Return product, price, customer name, and membership level.",tables:["orders","customers"],example:{input:"orders and customers tables linked by customer_id",output:"Orders with customer name and membership"},hint:"JOIN orders with customers ON customer_id",solution:"SELECT o.product, o.price, c.name, c.membership FROM orders o JOIN customers c ON o.customer_id = c.customer_id",dataset:"ecommerce"},{id:13,title:"Gold Member Spending",difficulty:"Medium",category:"JOIN + GROUP BY",skills:["SELECT","JOIN","WHERE","GROUP BY","Aggregation","ORDER BY"],xpReward:60,description:"Write a SQL query to find the **total spending by Gold members**. Return customer name and their total spent (quantity × price).",tables:["orders","customers"],example:{input:"orders and customers tables",output:"Gold members with their total spending"},hint:"JOIN tables, filter membership = 'Gold', GROUP BY customer",solution:"SELECT c.name, SUM(o.quantity * o.price) as total_spent FROM orders o JOIN customers c ON o.customer_id = c.customer_id WHERE c.membership = 'Gold' GROUP BY c.name",dataset:"ecommerce"},{id:14,title:"Department Salary Range",difficulty:"Medium",category:"Aggregation",skills:["SELECT","GROUP BY","Aggregation"],xpReward:55,description:"Write a SQL query to find the **salary range for each department**. Return department, minimum salary, maximum salary, and the difference (as salary_range).",tables:["employees"],example:{input:"employees table with department and salary",output:"Departments with min, max, and range"},hint:"Use MIN(), MAX() and subtraction in GROUP BY",solution:"SELECT department, MIN(salary) as min_salary, MAX(salary) as max_salary, MAX(salary) - MIN(salary) as salary_range FROM employees GROUP BY department",dataset:"employees"},{id:15,title:"Blockbuster Genres",difficulty:"Medium",category:"HAVING",skills:["SELECT","GROUP BY","HAVING","Aggregation","ORDER BY"],xpReward:55,description:"Write a SQL query to find genres where **total box office revenue exceeds $1 billion**. Return genre, number of movies, and total revenue. Sort by revenue descending.",tables:["movies"],example:{input:"movies table with genre and revenue_millions",output:"High-grossing genres (>$1B total)"},hint:"GROUP BY genre, HAVING SUM(revenue_millions) > 1000",solution:"SELECT genre, COUNT(*) as movie_count, SUM(revenue_millions) as total_revenue FROM movies GROUP BY genre HAVING SUM(revenue_millions) > 1000 ORDER BY total_revenue DESC",dataset:"movies"},{id:16,title:"Second Highest Salary",difficulty:"Hard",category:"Subquery",skills:["SELECT","Subquery","Aggregation"],xpReward:80,description:"Write a SQL query to find the **second highest salary** from the employees table. If there is no second highest salary, return NULL.",tables:["employees"],example:{input:"employees table with various salaries",output:"Single value: the second highest salary"},hint:"Use a subquery with MAX to exclude the highest salary, then find MAX of remaining",solution:"SELECT MAX(salary) as second_highest FROM employees WHERE salary < (SELECT MAX(salary) FROM employees)",dataset:"employees"},{id:17,title:"Employees Earning More Than Manager",difficulty:"Hard",category:"Self-Join",skills:["SELECT","JOIN","WHERE"],xpReward:90,description:"Write a SQL query to find employees who earn **more than their manager**. Return employee name, employee salary, manager name, and manager salary.",tables:["employees"],example:{input:"employees table with manager_id referencing emp_id",output:"Employees whose salary > their manager's salary"},hint:"Self-join employees table: JOIN employees m ON e.manager_id = m.emp_id, then compare salaries",solution:"SELECT e.name as employee, e.salary as emp_salary, m.name as manager, m.salary as mgr_salary FROM employees e JOIN employees m ON e.manager_id = m.emp_id WHERE e.salary > m.salary",dataset:"employees"},{id:18,title:"Department with Highest Average Salary",difficulty:"Hard",category:"Subquery",skills:["SELECT","GROUP BY","Aggregation","ORDER BY","LIMIT"],xpReward:85,description:"Write a SQL query to find the **department with the highest average salary**. Return only the department name and its average salary.",tables:["employees"],example:{input:"employees table with department and salary",output:"Single row: department with highest avg salary"},hint:"Use GROUP BY to get averages, then use ORDER BY DESC LIMIT 1, or a subquery with MAX",solution:"SELECT department, AVG(salary) as avg_salary FROM employees GROUP BY department ORDER BY avg_salary DESC LIMIT 1",dataset:"employees"},{id:19,title:"Customers Who Never Ordered",difficulty:"Hard",category:"LEFT JOIN / NOT IN",skills:["SELECT","LEFT JOIN","WHERE","NULL Handling"],xpReward:85,description:"Write a SQL query to find all **customers who have never placed an order**. Return customer name only.",tables:["customers","orders"],example:{input:"customers and orders tables",output:"Customer names with no matching orders"},hint:"Use LEFT JOIN and check for NULL, or use NOT IN with a subquery",solution:"SELECT c.name FROM customers c LEFT JOIN orders o ON c.customer_id = o.customer_id WHERE o.order_id IS NULL",dataset:"ecommerce"},{id:20,title:"Top Spender Per Country",difficulty:"Hard",category:"Subquery / Ranking",skills:["SELECT","Subquery","GROUP BY","HAVING","Aggregation"],xpReward:95,description:"Write a SQL query to find the **customer who spent the most in each country**. Return country, customer_id, and their total spending.",tables:["orders","customers"],example:{input:"orders with country and customer_id",output:"One row per country with top spender"},hint:"First calculate total per customer per country, then use a subquery to find the max per country",solution:"SELECT o.country, o.customer_id, SUM(o.quantity * o.price) as total_spent FROM orders o GROUP BY o.country, o.customer_id HAVING total_spent = (SELECT MAX(sub_total) FROM (SELECT country as c, customer_id, SUM(quantity * price) as sub_total FROM orders GROUP BY country, customer_id) sub WHERE sub.c = o.country)",dataset:"ecommerce"},{id:21,title:"Survival Rate Analysis",difficulty:"Hard",category:"Complex Analysis",skills:["SELECT","GROUP BY","HAVING","Aggregation","CASE"],xpReward:90,description:"Write a SQL query to find passenger classes where **survival rate exceeds 50%**. Return pclass, total passengers, survivors, and survival_rate (as percentage).",tables:["passengers"],example:{input:"passengers table",output:"Classes with >50% survival rate"},hint:"Calculate COUNT(*) for total, SUM(survived) for survivors, then compute percentage and filter with HAVING",solution:"SELECT pclass, COUNT(*) as total, SUM(survived) as survivors, ROUND(100.0 * SUM(survived) / COUNT(*), 1) as survival_rate FROM passengers GROUP BY pclass HAVING survival_rate > 50",dataset:"titanic"},{id:22,title:"Billion Dollar Directors",difficulty:"Hard",category:"Multiple HAVING",skills:["SELECT","GROUP BY","HAVING","Aggregation","ORDER BY"],xpReward:90,description:"Write a SQL query to find directors whose **total box office revenue exceeds $1 billion** AND have directed **at least 2 movies** in the database. Return director, movie count, total revenue, and average rating.",tables:["movies"],example:{input:"movies table",output:"Elite directors with massive box office"},hint:"GROUP BY director, use HAVING with multiple conditions: SUM(revenue) > 1000 AND COUNT(*) >= 2",solution:"SELECT director, COUNT(*) as movies, SUM(revenue_millions) as total_revenue, ROUND(AVG(rating), 2) as avg_rating FROM movies GROUP BY director HAVING COUNT(*) >= 2 AND SUM(revenue_millions) > 1000 ORDER BY total_revenue DESC",dataset:"movies"},{id:23,title:"Salary Rank Within Department",difficulty:"Hard",category:"Window Function",skills:["SELECT","Window Functions","ORDER BY"],xpReward:100,description:"Write a SQL query to **rank employees by salary within each department**. Return name, department, salary, and rank (1 = highest paid in dept). Use dense ranking (no gaps).",tables:["employees"],example:{input:"employees table",output:"All employees with their salary rank in their department"},hint:"Use window function: DENSE_RANK() OVER (PARTITION BY department ORDER BY salary DESC)",solution:"SELECT name, department, salary, DENSE_RANK() OVER (PARTITION BY department ORDER BY salary DESC) as dept_rank FROM employees",dataset:"employees"},{id:24,title:"Running Total Revenue",difficulty:"Hard",category:"Window Function",skills:["SELECT","Subquery","Window Functions","GROUP BY","Aggregation","ORDER BY"],xpReward:100,description:"Write a SQL query to calculate the **running total of revenue by order date**. Return order_date, daily revenue, and cumulative revenue up to that date.",tables:["orders"],example:{input:"orders table with dates and prices",output:"Daily revenue with running cumulative total"},hint:"Use a subquery to get daily totals first, then apply SUM() OVER (ORDER BY order_date) for the running total",solution:"SELECT order_date, daily_revenue, SUM(daily_revenue) OVER (ORDER BY order_date) as cumulative_revenue FROM (SELECT order_date, SUM(quantity * price) as daily_revenue FROM orders GROUP BY order_date) ORDER BY order_date",dataset:"ecommerce"},{id:25,title:"Handle Missing Fares",difficulty:"Medium",category:"NULL Handling",skills:["SELECT","NULL Handling","CASE"],xpReward:55,description:"Write a SQL query to display passengers with their fares. For passengers with **NULL fares, show 0 instead**. Return name, original fare, and cleaned_fare. Use COALESCE or CASE.",tables:["passengers"],example:{input:"fare=NULL",output:"cleaned_fare=0"},hint:"Use COALESCE(fare, 0) or CASE WHEN fare IS NULL THEN 0 ELSE fare END",solution:"SELECT name, fare, COALESCE(fare, 0) as cleaned_fare FROM passengers ORDER BY cleaned_fare DESC LIMIT 20",dataset:"titanic"},{id:26,title:"Revenue by Decade",difficulty:"Hard",category:"Expression Grouping",skills:["SELECT","GROUP BY","Aggregation","ORDER BY"],xpReward:95,description:"Write a SQL query to compare **movie revenue by decade**. Return decade (e.g., 1990, 2000, 2010), number of movies, total revenue, and average revenue per film.",tables:["movies"],example:{input:"movies table with year and revenue",output:"Revenue stats grouped by decade"},hint:"Use (year / 10) * 10 to calculate decade, then GROUP BY decade",solution:"SELECT (year / 10) * 10 as decade, COUNT(*) as movie_count, ROUND(SUM(revenue_millions), 0) as total_revenue, ROUND(AVG(revenue_millions), 1) as avg_revenue FROM movies GROUP BY decade ORDER BY decade",dataset:"movies"},{id:27,title:"Combine High and Low Earners",difficulty:"Medium",category:"UNION",skills:["SELECT","UNION","WHERE","ORDER BY"],xpReward:60,description:"Write a SQL query using **UNION** to combine two result sets: employees earning more than $80,000 (labeled 'High Earner') and employees earning less than $50,000 (labeled 'Low Earner'). Return name, salary, and earner_type.",tables:["employees"],example:{input:"employees with various salaries",output:"Combined list of high and low earners with labels"},hint:"Use UNION to combine two SELECT statements, each with its own WHERE clause and a literal string for earner_type",solution:"SELECT name, salary, 'High Earner' as earner_type FROM employees WHERE salary > 80000 UNION SELECT name, salary, 'Low Earner' as earner_type FROM employees WHERE salary < 50000 ORDER BY salary DESC",dataset:"employees"},{id:28,title:"Highest Fare Per Port",difficulty:"Hard",category:"Correlated Subquery",skills:["SELECT","Subquery","WHERE","Aggregation","ORDER BY"],xpReward:85,description:"Write a SQL query to find the **passenger who paid the highest fare at each embarkation port**. Return embarked, passenger name, and fare.",tables:["passengers"],example:{input:"passengers table with embarked (S, C, Q) and fare",output:"Top paying passenger per port"},hint:"Use a correlated subquery to find max fare per port, then match passengers",solution:"SELECT p.embarked, p.name, p.fare FROM passengers p WHERE p.fare = (SELECT MAX(fare) FROM passengers p2 WHERE p2.embarked = p.embarked) AND p.embarked IS NOT NULL ORDER BY p.fare DESC",dataset:"titanic"},{id:29,title:"Nth Highest Salary per Department",difficulty:"Hard",category:"Window Function",skills:["SELECT","Subquery","Window Functions","WHERE"],xpReward:110,description:"Write a SQL query to find the **top 3 earners in each department**. Return department, name, salary, and their rank within the department.",tables:["employees"],example:{input:"employees table",output:"Top 3 paid employees per department"},hint:"Use DENSE_RANK() OVER (PARTITION BY department ORDER BY salary DESC) and filter rank <= 3",solution:"SELECT department, name, salary, dept_rank FROM (SELECT department, name, salary, DENSE_RANK() OVER (PARTITION BY department ORDER BY salary DESC) as dept_rank FROM employees) ranked WHERE dept_rank <= 3",dataset:"employees"},{id:30,title:"Year-over-Year Growth",difficulty:"Hard",category:"Window Function / LAG",skills:["SELECT","Subquery","Window Functions","GROUP BY","Aggregation","ORDER BY"],xpReward:110,description:"Write a SQL query to calculate **year-over-year movie count growth**. For each year, show the year, movie count, previous year's count, and the difference.",tables:["movies"],example:{input:"movies table with year",output:"Each year with its movie count and change from previous year"},hint:"Use GROUP BY year, then LAG() OVER (ORDER BY year) to get previous year's count",solution:"SELECT year, movie_count, LAG(movie_count) OVER (ORDER BY year) as prev_year, movie_count - LAG(movie_count) OVER (ORDER BY year) as growth FROM (SELECT year, COUNT(*) as movie_count FROM movies GROUP BY year) yearly ORDER BY year",dataset:"movies"},{id:31,title:"Fix Passenger Names",difficulty:"Easy",category:"String Functions",skills:["SELECT","String Functions"],xpReward:30,description:"Write a SQL query to display passenger names in **UPPERCASE**. Return passenger_id and the uppercase name.",tables:["passengers"],example:{input:"'Braund, Mr. Owen Harris'",output:"'BRAUND, MR. OWEN HARRIS'"},hint:"Use the UPPER() function",solution:"SELECT passenger_id, UPPER(name) as name_upper FROM passengers LIMIT 20",dataset:"titanic"},{id:32,title:"Extract Title from Name",difficulty:"Medium",category:"String Functions",skills:["SELECT","String Functions"],xpReward:50,description:"Write a SQL query to extract the **title** (Mr., Mrs., Miss., Master.) from passenger names. Return name and extracted title. Titles appear after the comma and before the period.",tables:["passengers"],example:{input:"'Braund, Mr. Owen Harris'",output:"name: 'Braund, Mr. Owen Harris', title: 'Mr'"},hint:"Use SUBSTR() with INSTR() to find the position of ', ' and '. ' to extract between them",solution:"SELECT name, TRIM(SUBSTR(name, INSTR(name, ', ') + 2, INSTR(name, '.') - INSTR(name, ', ') - 2)) as title FROM passengers LIMIT 20",dataset:"titanic"},{id:33,title:"Product Name Length",difficulty:"Easy",category:"String Functions",skills:["SELECT","String Functions","WHERE","ORDER BY"],xpReward:30,description:"Write a SQL query to find all products where the **product name is longer than 10 characters**. Return product and its length.",tables:["orders"],example:{input:"orders table",output:"Products with LENGTH(product) > 10"},hint:"Use the LENGTH() function in WHERE clause",solution:"SELECT DISTINCT product, LENGTH(product) as name_length FROM orders WHERE LENGTH(product) > 10 ORDER BY name_length DESC",dataset:"ecommerce"},{id:34,title:"Combine First and Last Port",difficulty:"Easy",category:"String Functions",skills:["SELECT","String Functions","WHERE"],xpReward:35,description:"Write a SQL query to create a **combined string** showing 'Name boarded at [port]' for each passenger. Return passenger_id and the combined string as boarding_info.",tables:["passengers"],example:{input:"name='John', embarked='S'",output:"'John boarded at S'"},hint:"Use || operator for string concatenation in SQLite",solution:"SELECT passenger_id, name || ' boarded at ' || embarked as boarding_info FROM passengers WHERE embarked IS NOT NULL LIMIT 20",dataset:"titanic"},{id:35,title:"Find Passengers by Pattern",difficulty:"Medium",category:"String Functions",skills:["SELECT","String Functions","WHERE"],xpReward:45,description:"Write a SQL query to find all passengers whose **name starts with 'A' and contains 'Mrs'**. Return name and survived status.",tables:["passengers"],example:{input:"passengers table",output:"Names starting with A that contain Mrs"},hint:"Use LIKE with wildcards: % for any characters, combine with AND",solution:"SELECT name, survived FROM passengers WHERE name LIKE 'A%' AND name LIKE '%Mrs%'",dataset:"titanic"},{id:36,title:"Genres Without Blockbusters",difficulty:"Medium",category:"NOT IN / Subquery",skills:["SELECT","Subquery","NOT IN","DISTINCT"],xpReward:55,description:"Write a SQL query to find **genres that have no movies with revenue over 500 million**. Return the distinct genre names. Use NOT IN with a subquery.",tables:["movies"],example:{input:"genres like Action, Drama, Romance",output:"Genres without any blockbuster (>500M) movies"},hint:"First find genres WITH blockbusters using a subquery, then use NOT IN to exclude them",solution:"SELECT DISTINCT genre FROM movies WHERE genre NOT IN (SELECT DISTINCT genre FROM movies WHERE revenue_millions > 500) ORDER BY genre",dataset:"movies"},{id:37,title:"Replace Category Names",difficulty:"Medium",category:"String Functions",skills:["SELECT","String Functions","WHERE"],xpReward:45,description:"Write a SQL query to **replace 'Electronics' with 'Tech'** in the category column. Return product, original category, and new_category.",tables:["orders"],example:{input:"category='Electronics'",output:"new_category='Tech'"},hint:"Use the REPLACE() function",solution:"SELECT product, category, REPLACE(category, 'Electronics', 'Tech') as new_category FROM orders WHERE category = 'Electronics' OR category LIKE '%Electronics%'",dataset:"ecommerce"},{id:38,title:"Parse Last Name",difficulty:"Hard",category:"String Functions",skills:["SELECT","String Functions"],xpReward:75,description:"Write a SQL query to extract the **last name** from passenger names. Names are formatted as 'LastName, Title. FirstName'. Return passenger_id, full name, and last_name.",tables:["passengers"],example:{input:"'Braund, Mr. Owen Harris'",output:"last_name: 'Braund'"},hint:"Last name is everything before the first comma. Use SUBSTR() and INSTR()",solution:"SELECT passenger_id, name, SUBSTR(name, 1, INSTR(name, ',') - 1) as last_name FROM passengers LIMIT 20",dataset:"titanic"},{id:39,title:"Email Domain Extraction",difficulty:"Hard",category:"String Functions",skills:["SELECT","String Functions"],xpReward:80,description:"Write a SQL query to extract the **domain** from customer email addresses. Return customer name, email, and the domain (part after @).",tables:["customers"],example:{input:"email='john@gmail.com'",output:"domain='gmail.com'"},hint:"Use SUBSTR() starting from position of '@' + 1 to the end",solution:"SELECT name, email, SUBSTR(email, INSTR(email, '@') + 1) as domain FROM customers",dataset:"ecommerce"},{id:40,title:"Rank Movies by Rating",difficulty:"Hard",category:"Window Functions",skills:["SELECT","Window Functions","ORDER BY"],xpReward:85,description:"Write a SQL query to **rank movies by rating within each genre** using RANK(). Return title, genre, rating, and rank_in_genre. Movies with same rating should have same rank.",tables:["movies"],example:{input:"Action movies with ratings 8.5, 8.5, 8.0",output:"Ranks: 1, 1, 3 (ties get same rank)"},hint:"Use RANK() OVER (PARTITION BY genre ORDER BY rating DESC) to rank within each genre",solution:"SELECT title, genre, rating, RANK() OVER (PARTITION BY genre ORDER BY rating DESC) as rank_in_genre FROM movies WHERE rating IS NOT NULL ORDER BY genre, rank_in_genre LIMIT 30",dataset:"movies"},{id:41,title:"Employees Earning More Than Managers",difficulty:"Medium",category:"Self-Join",skills:["SELECT","JOIN","WHERE"],xpReward:65,description:"Write a SQL query to find employees who earn **more than their manager**. Return the employee name and their salary. This is a classic self-join problem!",tables:["employees"],example:{input:"Employee earns $95k, Manager earns $80k",output:"Employee name appears in result"},hint:"Join employees table to itself: e for employee, m for manager. Match e.manager_id = m.emp_id, then compare salaries",solution:"SELECT e.name as employee, e.salary as employee_salary, m.name as manager, m.salary as manager_salary FROM employees e JOIN employees m ON e.manager_id = m.emp_id WHERE e.salary > m.salary",dataset:"employees"},{id:42,title:"Find Employees Without Managers",difficulty:"Easy",category:"NULL Handling",skills:["SELECT","WHERE","NULL Handling"],xpReward:30,description:"Write a SQL query to find all employees who **do not have a manager** (manager_id is NULL). These are typically top-level executives. Return name, position, and salary.",tables:["employees"],example:{input:"CEO has manager_id = NULL",output:"CEO appears in result"},hint:"Use WHERE manager_id IS NULL",solution:"SELECT name, position, salary FROM employees WHERE manager_id IS NULL ORDER BY salary DESC",dataset:"employees"},{id:43,title:"Count Direct Reports",difficulty:"Medium",category:"Self-Join + GROUP BY",skills:["SELECT","JOIN","GROUP BY","Aggregation"],xpReward:60,description:"Write a SQL query to find **how many direct reports each manager has**. Return manager name and report_count. Only include employees who manage at least 1 person.",tables:["employees"],example:{input:"Alice manages Bob, Carol, David",output:"Alice: 3 direct reports"},hint:"Join employees to itself, GROUP BY manager, COUNT the employees",solution:"SELECT m.name as manager, COUNT(e.emp_id) as report_count FROM employees e JOIN employees m ON e.manager_id = m.emp_id GROUP BY m.emp_id, m.name HAVING COUNT(e.emp_id) >= 1 ORDER BY report_count DESC",dataset:"employees"},{id:44,title:"Employee Tenure in Years",difficulty:"Medium",category:"Date Functions",skills:["SELECT","Date Functions","ORDER BY"],xpReward:50,description:"Write a SQL query to calculate **how many years each employee has worked** at the company. Return name, hire_date, and tenure_years (rounded down). Assume current date is 2024-06-01.",tables:["employees"],example:{input:"hire_date = '2019-03-15'",output:"tenure_years = 5"},hint:"Use (julianday('2024-06-01') - julianday(hire_date)) / 365 to calculate years",solution:"SELECT name, hire_date, CAST((julianday('2024-06-01') - julianday(hire_date)) / 365 AS INTEGER) as tenure_years FROM employees ORDER BY tenure_years DESC",dataset:"employees"},{id:45,title:"Employees Hired in 2020",difficulty:"Easy",category:"Date Functions",skills:["SELECT","Date Functions","WHERE"],xpReward:25,description:"Write a SQL query to find all employees **hired in the year 2020**. Return name, department, and hire_date. Order by hire_date.",tables:["employees"],example:{input:"hire_date = '2020-06-01'",output:"Employee appears in result"},hint:"Use strftime('%Y', hire_date) = '2020' or hire_date BETWEEN '2020-01-01' AND '2020-12-31'",solution:"SELECT name, department, hire_date FROM employees WHERE strftime('%Y', hire_date) = '2020' ORDER BY hire_date",dataset:"employees"},{id:46,title:"Hires Per Month",difficulty:"Medium",category:"Date Functions + GROUP BY",skills:["SELECT","Date Functions","GROUP BY","Aggregation"],xpReward:55,description:"Write a SQL query to count **how many employees were hired each month** (regardless of year). Return month number and hire_count. Order by month.",tables:["employees"],example:{input:"3 people hired in January across all years",output:"month: 01, hire_count: 3"},hint:"Use strftime('%m', hire_date) to extract month, then GROUP BY",solution:"SELECT strftime('%m', hire_date) as month, COUNT(*) as hire_count FROM employees GROUP BY strftime('%m', hire_date) ORDER BY month",dataset:"employees"},{id:47,title:"Second Highest Salary",difficulty:"Medium",category:"Window Functions",skills:["SELECT","Window Functions","Subquery"],xpReward:65,description:"Write a SQL query to find the **second highest salary** in the company. If there is no second highest salary, return NULL. This is a classic LeetCode problem!",tables:["employees"],example:{input:"Salaries: 100k, 95k, 90k",output:"Second highest: 95k"},hint:"Use DENSE_RANK() to rank salaries, then select where rank = 2. Or use LIMIT 1 OFFSET 1",solution:"SELECT DISTINCT salary as second_highest_salary FROM (SELECT salary, DENSE_RANK() OVER (ORDER BY salary DESC) as rank FROM employees) ranked WHERE rank = 2",dataset:"employees"},{id:48,title:"Top Earner Per Department",difficulty:"Hard",category:"Window Functions",skills:["SELECT","Window Functions","Subquery"],xpReward:80,description:"Write a SQL query to find the **highest paid employee in each department**. Return department, employee name, and salary. Use ROW_NUMBER() window function.",tables:["employees"],example:{input:"Engineering: Alice $95k, Bob $75k",output:"Engineering: Alice, $95k"},hint:"Use ROW_NUMBER() OVER (PARTITION BY department ORDER BY salary DESC), then filter for row_num = 1",solution:"SELECT department, name, salary FROM (SELECT department, name, salary, ROW_NUMBER() OVER (PARTITION BY department ORDER BY salary DESC) as rn FROM employees) ranked WHERE rn = 1 ORDER BY salary DESC",dataset:"employees"},{id:49,title:"Salary Difference from Previous",difficulty:"Hard",category:"Window Functions",skills:["SELECT","Window Functions","LAG"],xpReward:85,description:"Write a SQL query using **LAG()** to show each employee's salary and the **difference from the previous employee's salary** (ordered by salary). Return name, salary, prev_salary, and salary_diff.",tables:["employees"],example:{input:"Salaries ordered: 48k, 51k, 52k",output:"salary_diff: NULL, 3k, 1k"},hint:"Use LAG(salary) OVER (ORDER BY salary) to get previous salary, then subtract",solution:"SELECT name, salary, LAG(salary) OVER (ORDER BY salary) as prev_salary, salary - LAG(salary) OVER (ORDER BY salary) as salary_diff FROM employees ORDER BY salary LIMIT 20",dataset:"employees"},{id:50,title:"Running Total of Revenue",difficulty:"Hard",category:"Window Functions",skills:["SELECT","Window Functions","Aggregation"],xpReward:90,description:"Write a SQL query to calculate a **running total of movie revenue** ordered by year. Return year, title, revenue, and running_total. Use SUM() as a window function.",tables:["movies"],example:{input:"2010: $100M, 2010: $50M, 2011: $80M",output:"running_total: $100M, $150M, $230M"},hint:"Use SUM(revenue_millions) OVER (ORDER BY year, title ROWS UNBOUNDED PRECEDING)",solution:"SELECT year, title, revenue_millions, SUM(revenue_millions) OVER (ORDER BY year, title) as running_total FROM movies WHERE revenue_millions IS NOT NULL ORDER BY year, title LIMIT 25",dataset:"movies"},{id:51,title:"Department Performance Rate",difficulty:"Medium",category:"Rate Calculation",skills:["SELECT","GROUP BY","Aggregation","CASE"],xpReward:60,description:"Write a SQL query to calculate the **percentage of high performers** (rating >= 4.0) in each department. Return department and high_performer_rate (as percentage, rounded to 1 decimal).",tables:["employees"],example:{input:"Dept has 10 employees, 7 with rating >= 4.0",output:"high_performer_rate: 70.0%"},hint:"Use SUM(CASE WHEN rating >= 4.0 THEN 1 ELSE 0 END) / COUNT(*) * 100",solution:"SELECT department, ROUND(SUM(CASE WHEN performance_rating >= 4.0 THEN 1 ELSE 0 END) * 100.0 / COUNT(*), 1) as high_performer_rate FROM employees GROUP BY department ORDER BY high_performer_rate DESC",dataset:"employees"},{id:52,title:"Order Completion Rate by Country",difficulty:"Medium",category:"Rate Calculation",skills:["SELECT","GROUP BY","Aggregation","CASE"],xpReward:55,description:"Write a SQL query to calculate the **order completion rate** for each country. Return country, total_orders, completed_orders, and completion_rate (as percentage).",tables:["orders"],example:{input:"USA: 10 orders, 8 completed",output:"completion_rate: 80%"},hint:"Use CASE WHEN status = 'completed' THEN 1 ELSE 0 END to count completed orders",solution:"SELECT country, COUNT(*) as total_orders, SUM(CASE WHEN status = 'completed' THEN 1 ELSE 0 END) as completed_orders, ROUND(SUM(CASE WHEN status = 'completed' THEN 1 ELSE 0 END) * 100.0 / COUNT(*), 1) as completion_rate FROM orders GROUP BY country ORDER BY completion_rate DESC",dataset:"ecommerce"},{id:53,title:"Departments With High Earners",difficulty:"Medium",category:"EXISTS Subquery",skills:["SELECT","EXISTS","Subquery","DISTINCT"],xpReward:65,description:"Write a SQL query using **EXISTS** to find departments that have **at least one employee earning over $90,000**. Return distinct department names.",tables:["employees"],example:{input:"Engineering has someone earning $95k",output:"Engineering appears in result"},hint:"Use WHERE EXISTS (SELECT 1 FROM employees e2 WHERE e2.department = e.department AND e2.salary > 90000)",solution:"SELECT DISTINCT e.department FROM employees e WHERE EXISTS (SELECT 1 FROM employees e2 WHERE e2.department = e.department AND e2.salary > 90000) ORDER BY department",dataset:"employees"},{id:54,title:"Consecutive IDs",difficulty:"Hard",category:"Self-Join",skills:["SELECT","JOIN","WHERE"],xpReward:75,description:"Write a SQL query to find pairs of employees with **consecutive emp_id values** who are in the **same department**. Return both employee names and their department.",tables:["employees"],example:{input:"emp_id 1 and 2 both in Engineering",output:"Pair: Alice, Bob, Engineering"},hint:"Self-join where e2.emp_id = e1.emp_id + 1 AND same department",solution:"SELECT e1.name as employee1, e2.name as employee2, e1.department FROM employees e1 JOIN employees e2 ON e2.emp_id = e1.emp_id + 1 AND e1.department = e2.department ORDER BY e1.emp_id",dataset:"employees"},{id:55,title:"Movies Above Average Runtime",difficulty:"Easy",category:"Subquery",skills:["SELECT","Subquery","WHERE"],xpReward:35,description:"Write a SQL query to find all movies with a **runtime longer than the average runtime**. Return title, runtime, and the average runtime. Order by runtime descending.",tables:["movies"],example:{input:"Average runtime is 120 min",output:"Movies with runtime > 120 min"},hint:"Use a subquery to calculate AVG(runtime), then compare in WHERE clause",solution:"SELECT title, runtime, (SELECT ROUND(AVG(runtime), 1) FROM movies) as avg_runtime FROM movies WHERE runtime > (SELECT AVG(runtime) FROM movies) ORDER BY runtime DESC",dataset:"movies"}],window.aiLessonsData=[{id:1,title:"Introduction to SQL",topic:"What is SQL and why it matters",concepts:["databases","tables","rows","columns","queries"],practiceTable:"passengers",exercises:[{question:"Show all columns from the passengers table (limit to 5 rows)",sql:"SELECT * FROM passengers LIMIT 5",difficulty:"easy"},{question:"Display just the name and age columns from passengers (limit 10)",sql:"SELECT name, age FROM passengers LIMIT 10",difficulty:"medium"},{question:"Show passenger names, their class, and fare paid (limit 8)",sql:"SELECT name, pclass, fare FROM passengers LIMIT 8",difficulty:"medium"},{question:"Display name, age, sex, and survival status for 10 passengers",sql:"SELECT name, age, sex, survived FROM passengers LIMIT 10",difficulty:"hard"},{question:"Show all passenger details including passenger_id, name, pclass, sex, age, and fare (limit 5)",sql:"SELECT passenger_id, name, pclass, sex, age, fare FROM passengers LIMIT 5",difficulty:"hard"}]},{id:2,title:"SELECT Statement",topic:"Retrieving data from tables",concepts:["SELECT","FROM","* (all columns)","specific columns","LIMIT"],practiceTable:"passengers",exercises:[{question:"Select the name column from passengers (limit 5)",sql:"SELECT name FROM passengers LIMIT 5",difficulty:"easy"},{question:"Show passenger names and their ages (limit 10)",sql:"SELECT name, age FROM passengers LIMIT 10",difficulty:"medium"},{question:"Display name, sex, and pclass for 7 passengers",sql:"SELECT name, sex, pclass FROM passengers LIMIT 7",difficulty:"medium"},{question:"Select passenger_id, name, survived, pclass, and fare columns (limit 6)",sql:"SELECT passenger_id, name, survived, pclass, fare FROM passengers LIMIT 6",difficulty:"hard"},{question:"Show name, age, sex, fare, and embarked location for 5 passengers",sql:"SELECT name, age, sex, fare, embarked FROM passengers LIMIT 5",difficulty:"hard"}]},{id:3,title:"Filtering with WHERE",topic:"Using conditions to filter data",concepts:["WHERE","comparison operators","=",">","<",">=","<=","<>"],practiceTable:"passengers",exercises:[{question:"Find all passengers who survived (survived = 1)",sql:"SELECT * FROM passengers WHERE survived = 1",difficulty:"easy"},{question:"Show all female passengers",sql:"SELECT * FROM passengers WHERE sex = 'female'",difficulty:"medium"},{question:"Find passengers who were in first class (pclass = 1)",sql:"SELECT * FROM passengers WHERE pclass = 1",difficulty:"medium"},{question:"Show name, age, and fare for passengers who paid more than 50 for their fare",sql:"SELECT name, age, fare FROM passengers WHERE fare > 50",difficulty:"hard"},{question:"Display name, pclass, and survived for passengers older than 60 years",sql:"SELECT name, pclass, survived FROM passengers WHERE age > 60",difficulty:"hard"}]},{id:4,title:"Combining Conditions",topic:"Using AND, OR to combine filters",concepts:["AND","OR","NOT","combining conditions"],practiceTable:"passengers",exercises:[{question:"Find female passengers who survived",sql:"SELECT * FROM passengers WHERE sex = 'female' AND survived = 1",difficulty:"easy"},{question:"Show passengers in first OR second class",sql:"SELECT * FROM passengers WHERE pclass = 1 OR pclass = 2",difficulty:"medium"},{question:"Find male passengers who did NOT survive",sql:"SELECT * FROM passengers WHERE sex = 'male' AND survived = 0",difficulty:"medium"},{question:"Show name, age, pclass for female survivors in first class",sql:"SELECT name, age, pclass FROM passengers WHERE sex = 'female' AND survived = 1 AND pclass = 1",difficulty:"hard"},{question:"Display name, fare, survived for passengers under 18 OR over 60 who survived",sql:"SELECT name, fare, survived FROM passengers WHERE (age < 18 OR age > 60) AND survived = 1",difficulty:"hard"}]},{id:5,title:"Sorting Results",topic:"Ordering data with ORDER BY",concepts:["ORDER BY","ASC","DESC","sorting by multiple columns"],practiceTable:"movies",exercises:[{question:"Show all movies sorted by rating (highest first)",sql:"SELECT * FROM movies ORDER BY rating DESC",difficulty:"easy"},{question:"List movies sorted by year (oldest first)",sql:"SELECT * FROM movies ORDER BY year ASC",difficulty:"medium"},{question:"Show movies sorted by revenue (highest first), limit to 10",sql:"SELECT * FROM movies ORDER BY revenue_millions DESC LIMIT 10",difficulty:"medium"},{question:"Show title, rating, revenue for Action movies sorted by rating DESC",sql:"SELECT title, rating, revenue_millions FROM movies WHERE genre = 'Action' ORDER BY rating DESC",difficulty:"hard"},{question:"Display title, year, rating for movies after 2010 with rating > 8, sorted by year DESC then rating DESC",sql:"SELECT title, year, rating FROM movies WHERE year > 2010 AND rating > 8 ORDER BY year DESC, rating DESC",difficulty:"hard"}]},{id:6,title:"Aggregate Functions",topic:"Calculating statistics with COUNT, SUM, AVG, MIN, MAX",concepts:["COUNT","SUM","AVG","MIN","MAX","aggregate functions"],practiceTable:"movies",exercises:[{question:"Count the total number of movies",sql:"SELECT COUNT(*) FROM movies",difficulty:"easy"},{question:"Find the average movie rating",sql:"SELECT AVG(rating) FROM movies",difficulty:"medium"},{question:"Find the highest revenue among all movies",sql:"SELECT MAX(revenue_millions) FROM movies",difficulty:"medium"},{question:"Find the count, average rating, and total revenue for Action movies",sql:"SELECT COUNT(*), AVG(rating), SUM(revenue_millions) FROM movies WHERE genre = 'Action'",difficulty:"hard"},{question:"Show the minimum and maximum ratings for movies released after 2010",sql:"SELECT MIN(rating), MAX(rating) FROM movies WHERE year > 2010",difficulty:"hard"}]},{id:7,title:"GROUP BY",topic:"Grouping data for aggregate analysis",concepts:["GROUP BY","grouping","aggregating groups"],practiceTable:"employees",exercises:[{question:"Count employees in each department, sorted by department name",sql:"SELECT department, COUNT(*) FROM employees GROUP BY department ORDER BY department",difficulty:"easy"},{question:"Find the average salary by department, sorted by avg salary DESC",sql:"SELECT department, AVG(salary) FROM employees GROUP BY department ORDER BY AVG(salary) DESC",difficulty:"medium"},{question:"Show total salary paid by each department, sorted by total DESC",sql:"SELECT department, SUM(salary) FROM employees GROUP BY department ORDER BY SUM(salary) DESC",difficulty:"medium"},{question:"Show department, employee count, and avg salary sorted by avg salary DESC",sql:"SELECT department, COUNT(*), AVG(salary) FROM employees GROUP BY department ORDER BY AVG(salary) DESC",difficulty:"hard"},{question:"Display position, count, min salary, max salary for each position, sorted by count DESC",sql:"SELECT position, COUNT(*), MIN(salary), MAX(salary) FROM employees GROUP BY position ORDER BY COUNT(*) DESC",difficulty:"hard"}]},{id:8,title:"HAVING Clause",topic:"Filtering grouped data",concepts:["HAVING","filtering groups","HAVING vs WHERE"],practiceTable:"employees",exercises:[{question:"Show departments with more than 5 employees, sorted by count DESC",sql:"SELECT department, COUNT(*) FROM employees GROUP BY department HAVING COUNT(*) > 5 ORDER BY COUNT(*) DESC",difficulty:"easy"},{question:"Find departments where average salary is above 70000, sorted by avg salary DESC",sql:"SELECT department, AVG(salary) FROM employees GROUP BY department HAVING AVG(salary) > 70000 ORDER BY AVG(salary) DESC",difficulty:"medium"},{question:"Show positions held by more than 3 employees, sorted by position name",sql:"SELECT position, COUNT(*) FROM employees GROUP BY position HAVING COUNT(*) >= 3 ORDER BY position",difficulty:"medium"},{question:"Show departments with avg salary > 65000 and at least 3 employees, sorted by avg salary DESC",sql:"SELECT department, COUNT(*), AVG(salary) FROM employees GROUP BY department HAVING AVG(salary) > 65000 AND COUNT(*) >= 3 ORDER BY AVG(salary) DESC",difficulty:"hard"},{question:"Find positions with min rating > 3 and count > 2, showing position, count, avg salary, sorted by avg salary DESC",sql:"SELECT position, COUNT(*), AVG(salary) FROM employees GROUP BY position HAVING MIN(performance_rating) > 3 AND COUNT(*) > 2 ORDER BY AVG(salary) DESC",difficulty:"hard"}]},{id:9,title:"JOIN Basics",topic:"Combining data from multiple tables",concepts:["INNER JOIN","LEFT JOIN","ON clause","table aliases"],practiceTable:"orders",joinTables:{orders:["order_id","customer_id","product","category","quantity","price","order_date","country"],customers:["customer_id","name","email","join_date","membership","total_orders"]},exercises:[{question:"Join orders with customers to show product and customer name, sorted by product",sql:"SELECT orders.product, customers.name FROM orders JOIN customers ON orders.customer_id = customers.customer_id ORDER BY orders.product",difficulty:"easy"},{question:"Show product, price, and customer name for all orders, sorted by price DESC (limit 10)",sql:"SELECT orders.product, orders.price, customers.name FROM orders JOIN customers ON orders.customer_id = customers.customer_id ORDER BY orders.price DESC LIMIT 10",difficulty:"medium"},{question:"Show customer name and product for Gold members only, sorted by name",sql:"SELECT customers.name, orders.product FROM orders JOIN customers ON orders.customer_id = customers.customer_id WHERE customers.membership = 'Gold' ORDER BY customers.name",difficulty:"medium"},{question:"Show customer name and their total spending (SUM of price), sorted by total DESC",sql:"SELECT customers.name, SUM(orders.price) FROM orders JOIN customers ON orders.customer_id = customers.customer_id GROUP BY customers.name ORDER BY SUM(orders.price) DESC",difficulty:"hard"},{question:"Show category, number of orders, and total revenue per category, sorted by revenue DESC",sql:"SELECT orders.category, COUNT(*), SUM(orders.price) FROM orders GROUP BY orders.category ORDER BY SUM(orders.price) DESC",difficulty:"hard"}]},{id:10,title:"Advanced Queries",topic:"Subqueries and complex analysis",concepts:["subqueries","nested SELECT","correlated subqueries"],practiceTable:"movies",exercises:[{question:"Find movies with rating higher than average rating",sql:"SELECT * FROM movies WHERE rating > (SELECT AVG(rating) FROM movies)",difficulty:"easy"},{question:"Find the movie with the highest rating",sql:"SELECT * FROM movies WHERE rating = (SELECT MAX(rating) FROM movies)",difficulty:"medium"},{question:"Show movies with revenue above average revenue",sql:"SELECT * FROM movies WHERE revenue_millions > (SELECT AVG(revenue_millions) FROM movies)",difficulty:"medium"},{question:"Show title, genre, rating, revenue for movies with above-average rating AND above-average votes, sorted by rating DESC (limit 10)",sql:"SELECT title, genre, rating, revenue_millions FROM movies WHERE rating > (SELECT AVG(rating) FROM movies) AND votes > (SELECT AVG(votes) FROM movies) ORDER BY rating DESC LIMIT 10",difficulty:"hard"},{question:"Find genre, count, and avg rating for genres that have movies with above-average revenue, having count > 3, sorted by avg rating DESC",sql:"SELECT genre, COUNT(*), AVG(rating) FROM movies WHERE revenue_millions > (SELECT AVG(revenue_millions) FROM movies) GROUP BY genre HAVING COUNT(*) > 3 ORDER BY AVG(rating) DESC",difficulty:"hard"}]}],"undefined"!=typeof module&&module.exports&&(module.exports=window.aiLessonsData),window.lessonContentData={1:{intro:"Welcome to SQL Quest! SQL (Structured Query Language) is the language used to communicate with databases. It lets you retrieve, add, update, and delete data. Every tech company uses SQL - from Google to small startups. Ready to begin?",teaching:"Let's start with the basics! A DATABASE stores data in TABLES. Tables have ROWS (records) and COLUMNS (fields). Think of it like a spreadsheet.\n\nThe most basic SQL command is SELECT, which retrieves data:\n\nSELECT * FROM passengers LIMIT 5;\n\nThis says: 'Give me ALL columns (*) FROM the passengers table, but LIMIT to 5 rows.'\n\nReady to practice?",practice:[{question:"Let's try it! Write a query to show all columns from passengers, limited to 3 rows.",expected:"SELECT * FROM passengers LIMIT 3"},{question:"Great! Now show all columns but limit to 10 rows.",expected:"SELECT * FROM passengers LIMIT 10"},{question:"Show all passenger data, limited to just 1 row.",expected:"SELECT * FROM passengers LIMIT 1"}],comprehension:["What does the asterisk (*) symbol mean in a SELECT statement?","What is the purpose of the LIMIT clause?","In a database table, what's the difference between rows and columns?"]},2:{intro:"Now let's learn how to SELECT specific columns instead of everything. This is more efficient and gives you exactly the data you need. Ready?",teaching:"Instead of SELECT * (all columns), you can name specific columns:\n\nSELECT name, age FROM passengers LIMIT 5;\n\nThis returns ONLY the name and age columns. You can select multiple columns by separating them with commas.\n\nReady to practice selecting specific columns?",practice:[{question:"Select only the 'name' column from passengers (limit 5).",expected:"SELECT name FROM passengers LIMIT 5"},{question:"Select 'name' and 'age' columns (limit 10).",expected:"SELECT name, age FROM passengers LIMIT 10"},{question:"Select 'name', 'sex', and 'pclass' columns (limit 5).",expected:"SELECT name, sex, pclass FROM passengers LIMIT 5"}],comprehension:["Why might you SELECT specific columns instead of using * for all columns?","How do you separate multiple column names in a SELECT statement?","What happens if you try to SELECT a column that doesn't exist?"]},3:{intro:"Time to learn FILTERING with WHERE! This lets you find specific rows that match conditions. It's one of the most powerful SQL features. Ready?",teaching:"The WHERE clause filters rows based on conditions:\n\nSELECT * FROM passengers WHERE survived = 1;\n\nThis returns only passengers who survived. You can use:\n= (equals), > (greater), < (less), >= , <= , <> (not equal)\n\nFor text, use quotes: WHERE sex = 'female'\n\nReady to practice filtering?",practice:[{question:"Find all passengers who survived (survived = 1).",expected:"SELECT * FROM passengers WHERE survived = 1"},{question:"Find all female passengers.",expected:"SELECT * FROM passengers WHERE sex = 'female'"},{question:"Find passengers in first class (pclass = 1).",expected:"SELECT * FROM passengers WHERE pclass = 1"}],comprehension:["What is the purpose of the WHERE clause?","When filtering text values, what must you put around the value?","What operator would you use to find passengers NOT in third class?"]},4:{intro:"Let's combine multiple conditions using AND and OR! This makes your filters even more powerful. Ready?",teaching:"AND requires BOTH conditions to be true:\nSELECT * FROM passengers WHERE sex = 'female' AND survived = 1;\n\nOR requires at least ONE condition to be true:\nSELECT * FROM passengers WHERE pclass = 1 OR pclass = 2;\n\nYou can combine multiple conditions for complex filters!\n\nReady to practice?",practice:[{question:"Find female passengers who survived.",expected:"SELECT * FROM passengers WHERE sex = 'female' AND survived = 1"},{question:"Find passengers in first OR second class.",expected:"SELECT * FROM passengers WHERE pclass = 1 OR pclass = 2"},{question:"Find male passengers who survived.",expected:"SELECT * FROM passengers WHERE sex = 'male' AND survived = 1"}],comprehension:["What's the difference between AND and OR in SQL?","If you use AND, do both conditions need to be true or just one?","How would you find passengers who are female AND in first class?"]},5:{intro:"Let's learn to SORT results with ORDER BY! You can arrange data in ascending or descending order. Ready?",teaching:"ORDER BY sorts your results:\n\nSELECT * FROM movies ORDER BY rating DESC;\n\nDESC = descending (highest first)\nASC = ascending (lowest first, this is default)\n\nYou can sort by multiple columns too!\n\nReady to practice sorting?",practice:[{question:"Show all movies sorted by rating (highest first).",expected:"SELECT * FROM movies ORDER BY rating DESC"},{question:"Show movies sorted by year (oldest first).",expected:"SELECT * FROM movies ORDER BY year ASC"},{question:"Show top 5 highest revenue movies.",expected:"SELECT * FROM movies ORDER BY revenue_millions DESC LIMIT 5"}],comprehension:["What does DESC mean in ORDER BY?","If you don't specify ASC or DESC, which is the default?","Can you sort by multiple columns? How?"]},6:{intro:"Time for AGGREGATE FUNCTIONS! These summarize data - COUNT, SUM, AVG, MIN, MAX. Ready?",teaching:"Aggregate functions calculate values across rows:\n\nCOUNT(*) - counts rows\nSUM(column) - adds values\nAVG(column) - average\nMIN/MAX(column) - smallest/largest\n\nExample: SELECT COUNT(*) FROM movies;\n\nThis counts all movies. Ready to practice?",practice:[{question:"Count the total number of movies.",expected:"SELECT COUNT(*) FROM movies"},{question:"Find the average movie rating.",expected:"SELECT AVG(rating) FROM movies"},{question:"Find the highest revenue among all movies.",expected:"SELECT MAX(revenue_millions) FROM movies"}],comprehension:["What does COUNT(*) return?","What's the difference between SUM and AVG?","When would you use MAX vs MIN?"]},7:{intro:"Let's learn GROUP BY! This groups rows together for aggregate calculations. Ready?",teaching:"GROUP BY creates groups for aggregation:\n\nSELECT department, COUNT(*) FROM employees GROUP BY department;\n\nThis counts employees IN EACH department. The column in SELECT must either be in GROUP BY or be an aggregate function.\n\nReady to practice grouping?",practice:[{question:"Count employees in each department, sorted by department.",expected:"SELECT department, COUNT(*) FROM employees GROUP BY department ORDER BY department"},{question:"Find average salary by department, sorted by avg salary DESC.",expected:"SELECT department, AVG(salary) FROM employees GROUP BY department ORDER BY AVG(salary) DESC"},{question:"Count employees by position, sorted by count DESC.",expected:"SELECT position, COUNT(*) FROM employees GROUP BY position ORDER BY COUNT(*) DESC"}],comprehension:["What does GROUP BY do?","Why do you need GROUP BY when using COUNT with another column?","Can you GROUP BY multiple columns?"]},8:{intro:"Now let's filter groups with HAVING! It's like WHERE but for grouped results. Ready?",teaching:"HAVING filters AFTER grouping (WHERE filters BEFORE):\n\nSELECT department, COUNT(*) FROM employees GROUP BY department HAVING COUNT(*) > 5;\n\nThis shows only departments with MORE than 5 employees.\n\nReady to practice?",practice:[{question:"Show departments with more than 5 employees, sorted by count DESC.",expected:"SELECT department, COUNT(*) FROM employees GROUP BY department HAVING COUNT(*) > 5 ORDER BY COUNT(*) DESC"},{question:"Find departments where average salary is above 70000, sorted by avg salary DESC.",expected:"SELECT department, AVG(salary) FROM employees GROUP BY department HAVING AVG(salary) > 70000 ORDER BY AVG(salary) DESC"},{question:"Show positions held by at least 3 people, sorted by position.",expected:"SELECT position, COUNT(*) FROM employees GROUP BY position HAVING COUNT(*) >= 3 ORDER BY position"}],comprehension:["What's the difference between WHERE and HAVING?","When do you use HAVING instead of WHERE?","Can you use HAVING without GROUP BY?"]},9:{intro:"Time for JOINS! This combines data from multiple tables. It's essential for relational databases. Ready?",teaching:"JOIN connects tables using a common column:\n\nSELECT orders.product, customers.name\nFROM orders\nJOIN customers ON orders.customer_id = customers.customer_id;\n\nINNER JOIN: only matching rows\nLEFT JOIN: all from left table + matches\n\nReady to practice?",practice:[{question:"Join orders with customers to show product and customer name, sorted by product.",expected:"SELECT orders.product, customers.name FROM orders JOIN customers ON orders.customer_id = customers.customer_id ORDER BY orders.product"},{question:"Show product, price, and customer name for orders, sorted by price DESC (limit 10).",expected:"SELECT orders.product, orders.price, customers.name FROM orders JOIN customers ON orders.customer_id = customers.customer_id ORDER BY orders.price DESC LIMIT 10"},{question:"Show category and count of orders per category, sorted by count DESC.",expected:"SELECT category, COUNT(*) FROM orders GROUP BY category ORDER BY COUNT(*) DESC"}],comprehension:["What does JOIN do?","What's the difference between INNER JOIN and LEFT JOIN?","What is the ON clause used for in a JOIN?"]},10:{intro:"Advanced topic: SUBQUERIES! These are queries inside queries for complex analysis. Ready?",teaching:"A subquery is a SELECT inside another query:\n\nSELECT * FROM movies WHERE rating > (SELECT AVG(rating) FROM movies);\n\nThe inner query runs FIRST, then the outer query uses its result.\n\nReady to practice subqueries?",practice:[{question:"Find movies with rating higher than average.",expected:"SELECT * FROM movies WHERE rating > (SELECT AVG(rating) FROM movies)"},{question:"Find the movie with the highest rating.",expected:"SELECT * FROM movies WHERE rating = (SELECT MAX(rating) FROM movies)"},{question:"Show movies with revenue above average.",expected:"SELECT * FROM movies WHERE revenue_millions > (SELECT AVG(revenue_millions) FROM movies)"}],comprehension:["What is a subquery?","Which query runs first - the inner or outer query?","Why might you use a subquery instead of a regular WHERE clause?"]}},window.dailyChallengesData=[{id:1,day:"Monday",difficulty:"Easy",topic:"SELECT & WHERE",avgSolveTime:3,solveRate:85,warmup:{type:"mcq",question:"Which SQL clause is used to filter rows BEFORE grouping?",options:["HAVING","WHERE","ORDER BY","GROUP BY"],correct:1,explanation:"WHERE filters rows before any grouping. HAVING filters after GROUP BY."},core:{title:"Find First Class Survivors",description:"Find all **first class passengers** (pclass = 1) who **survived** (survived = 1). Show their name and age.",dataset:"titanic",hint:"Use WHERE with AND to combine conditions",solution:"SELECT name, age FROM passengers WHERE pclass = 1 AND survived = 1",concept:"WHERE with multiple conditions"},insight:{type:"mcq",question:"What would happen if you used OR instead of AND in the query?",options:["Same results","More rows (all pclass=1 OR all survived=1)","No rows returned","Syntax error"],correct:1,explanation:"OR returns rows matching EITHER condition, giving many more results."}},{id:2,day:"Tuesday",difficulty:"Easy-Medium",topic:"JOIN Basics",avgSolveTime:4,solveRate:72,warmup:{type:"truefalse",question:"INNER JOIN returns all rows from both tables, even without matches.",correct:!1,explanation:"INNER JOIN only returns rows with matches in BOTH tables. LEFT JOIN keeps all from the left table."},core:{title:"Customer Order Count",description:"Show each **customer name** and their **total number of orders**. Only include customers with at least 1 order.",dataset:"ecommerce",hint:"JOIN customers with orders, then GROUP BY customer",solution:"SELECT c.name, COUNT(o.order_id) as total_orders FROM customers c JOIN orders o ON c.customer_id = o.customer_id GROUP BY c.customer_id, c.name",concept:"JOIN with aggregation"},insight:{type:"mcq",question:"If a customer has 0 orders, which JOIN would still show them?",options:["INNER JOIN","LEFT JOIN","RIGHT JOIN","CROSS JOIN"],correct:1,explanation:"LEFT JOIN keeps all rows from the left table (customers) even without matching orders."}},{id:3,day:"Wednesday",difficulty:"Medium",topic:"GROUP BY & HAVING",avgSolveTime:5,solveRate:65,warmup:{type:"mcq",question:"Which runs FIRST in SQL execution order?",options:["SELECT","WHERE","GROUP BY","HAVING"],correct:1,explanation:"Order: FROM → WHERE → GROUP BY → HAVING → SELECT → ORDER BY"},core:{title:"Popular Movie Genres",description:"Find genres with **more than 5 movies** that have a rating above 7.0. Show genre and movie count.",dataset:"movies",hint:"WHERE for rating, GROUP BY genre, HAVING for count",solution:"SELECT genre, COUNT(*) as movie_count FROM movies WHERE rating > 7.0 GROUP BY genre HAVING COUNT(*) > 5",concept:"WHERE vs HAVING"},insight:{type:"mcq",question:"Why can't we use WHERE COUNT(*) > 5?",options:["WHERE doesn't support numbers","COUNT() doesn't exist when WHERE runs","Just a syntax preference","WHERE only works with text"],correct:1,explanation:"WHERE runs before GROUP BY, so aggregate functions haven't been calculated yet."}},{id:4,day:"Thursday",difficulty:"Medium-Hard",topic:"Subqueries",avgSolveTime:6,solveRate:55,warmup:{type:"truefalse",question:"A subquery in WHERE must always return exactly one value.",correct:!1,explanation:"With IN, ANY, or ALL, subqueries can return multiple values. Only with = or > do you need one value."},core:{title:"Above Average Salaries",description:"Find employees earning **more than the average salary**. Show name, department, and salary.",dataset:"employees",hint:"Use a subquery: WHERE salary > (SELECT AVG(salary) FROM employees)",solution:"SELECT name, department, salary FROM employees WHERE salary > (SELECT AVG(salary) FROM employees)",concept:"Scalar subquery in WHERE"},insight:{type:"mcq",question:"What type of subquery returns a single value like AVG()?",options:["Table subquery","Scalar subquery","Correlated subquery","Nested subquery"],correct:1,explanation:"A scalar subquery returns exactly one value (one row, one column)."}},{id:5,day:"Friday",difficulty:"Medium",topic:"CASE Expressions",avgSolveTime:5,solveRate:68,warmup:{type:"mcq",question:"What does CASE return if no conditions match and there's no ELSE?",options:["0","Empty string","NULL","Error"],correct:2,explanation:"Without ELSE, unmatched CASE returns NULL."},core:{title:"Categorize Movies",description:'Categorize movies: **"Excellent"** (8+), **"Good"** (6-7.9), **"Average"** (below 6). Show title, rating, category.',dataset:"movies",hint:"Use CASE WHEN with multiple conditions",solution:"SELECT title, rating, CASE WHEN rating >= 8 THEN 'Excellent' WHEN rating >= 6 THEN 'Good' ELSE 'Average' END as category FROM movies",concept:"CASE for categorization"},insight:{type:"mcq",question:"If multiple WHEN conditions are true, which is used?",options:["All matching values","The FIRST match","The LAST match","An error occurs"],correct:1,explanation:"CASE uses the FIRST matching condition. Order matters!"}},{id:6,day:"Saturday",difficulty:"Mixed",topic:"Debug Challenge",avgSolveTime:4,solveRate:60,warmup:{type:"debug",question:"What's wrong with this query?",code:"SELECT department, COUNT(*)\nFROM employees\nWHERE COUNT(*) > 5\nGROUP BY department;",options:["Missing column alias","Can't use COUNT(*) in WHERE","GROUP BY should come before WHERE","Need table alias"],correct:1,explanation:"Use HAVING for aggregate conditions, not WHERE."},core:{title:"Fix and Improve",description:"Find departments with **more than 3 employees** AND **average salary over $70,000**. Show department, count, average salary.",dataset:"employees",hint:"GROUP BY department, use HAVING for both conditions",solution:"SELECT department, COUNT(*) as emp_count, AVG(salary) as avg_salary FROM employees GROUP BY department HAVING COUNT(*) > 3 AND AVG(salary) > 70000",concept:"Multiple HAVING conditions"},insight:{type:"truefalse",question:"You can use column aliases (like emp_count) in the HAVING clause.",correct:!1,explanation:"HAVING runs before SELECT, so aliases aren't available. Repeat the expression."}},{id:7,day:"Sunday",difficulty:"Hard",topic:"Interview Challenge",avgSolveTime:8,solveRate:45,isOptional:!0,warmup:{type:"mcq",question:"In a SQL interview, what should you do FIRST?",options:["Start coding immediately","Ask clarifying questions","Optimize for performance","Write test cases"],correct:1,explanation:"Always clarify requirements, edge cases, and expected output first!"},core:{title:"Second Highest Salary",description:"Find the **second highest salary**. If there's a tie for first, return the next distinct salary.",dataset:"employees",hint:"Use DISTINCT, ORDER BY DESC, LIMIT 1 OFFSET 1",solution:"SELECT DISTINCT salary FROM employees ORDER BY salary DESC LIMIT 1 OFFSET 1",alternativeSolution:"SELECT MAX(salary) FROM employees WHERE salary < (SELECT MAX(salary) FROM employees)",concept:"Classic interview: Nth highest"},insight:{type:"mcq",question:'For "Nth highest" with ties, which approach is best?',options:["LIMIT N","DENSE_RANK()","ROW_NUMBER()","Simple MAX with subquery"],correct:1,explanation:"DENSE_RANK() handles ties without skipping numbers."}},{id:8,day:"Monday",difficulty:"Easy",topic:"ORDER BY & LIMIT",avgSolveTime:3,solveRate:88,warmup:{type:"mcq",question:"What is the default ORDER BY direction?",options:["Descending (Z-A)","Ascending (A-Z)","Random","Insertion order"],correct:1,explanation:"ORDER BY defaults to ASC. Use DESC for descending."},core:{title:"Top 5 Movies",description:"Find the **top 5 highest-rated movies**. Show title, rating, and year, sorted by rating.",dataset:"movies",hint:"ORDER BY rating DESC, LIMIT 5",solution:"SELECT title, rating, year FROM movies ORDER BY rating DESC LIMIT 5",concept:"Sorting and limiting"},insight:{type:"truefalse",question:"LIMIT always comes before ORDER BY.",correct:!1,explanation:"ORDER BY comes first. SQL sorts, then limits. Otherwise you limit random rows!"}},{id:9,day:"Tuesday",difficulty:"Easy-Medium",topic:"DISTINCT & COUNT",avgSolveTime:4,solveRate:75,warmup:{type:"mcq",question:"What does COUNT(DISTINCT column) do?",options:["Counts all rows","Counts non-NULL values","Counts unique non-NULL values","Counts NULL values only"],correct:2,explanation:"COUNT(DISTINCT) counts only unique, non-NULL values."},core:{title:"Unique Customers by Country",description:"Count **unique customers** who ordered in each country. Show country and count, sorted by count descending.",dataset:"ecommerce",hint:"Use COUNT(DISTINCT customer_id) with GROUP BY",solution:"SELECT country, COUNT(DISTINCT customer_id) as unique_customers FROM orders GROUP BY country ORDER BY unique_customers DESC",concept:"COUNT DISTINCT"},insight:{type:"mcq",question:"COUNT(*) vs COUNT(column) - which counts NULLs?",options:["Both count NULLs","Neither counts NULLs","Only COUNT(*) counts NULLs","Only COUNT(column) counts NULLs"],correct:2,explanation:"COUNT(*) counts all rows. COUNT(column) skips NULLs."}},{id:10,day:"Wednesday",difficulty:"Medium",topic:"Date Functions",avgSolveTime:5,solveRate:62,warmup:{type:"mcq",question:"In SQLite, how do you extract the year from a date?",options:["YEAR(date)",'strftime("%Y", date)',"EXTRACT(YEAR FROM date)","date.year"],correct:1,explanation:"SQLite uses strftime(). %Y extracts 4-digit year."},core:{title:"Orders by Month",description:"Count orders **per month in 2024**. Show month number and order count, sorted by month.",dataset:"ecommerce",hint:'strftime("%m", order_date) for month, strftime("%Y", ...) for year filter',solution:"SELECT strftime('%m', order_date) as month, COUNT(*) as order_count FROM orders WHERE strftime('%Y', order_date) = '2024' GROUP BY month ORDER BY month",concept:"Date extraction"},insight:{type:"truefalse",question:"strftime() returns a string, not a number.",correct:!0,explanation:'Yes! Cast if needed: CAST(strftime("%m", date) AS INTEGER)'}},{id:11,day:"Thursday",difficulty:"Medium-Hard",topic:"Self JOIN",avgSolveTime:7,solveRate:50,warmup:{type:"mcq",question:"A self JOIN is when you:",options:["JOIN with a different database","JOIN a table with itself","JOIN without any condition","JOIN using only primary keys"],correct:1,explanation:"Self JOIN joins a table to itself, useful for hierarchies."},core:{title:"Employees and Managers",description:"Show each employee's **name** and their **manager's name**. Only include those with managers.",dataset:"employees",hint:"JOIN employees to itself: e.manager_id = m.emp_id",solution:"SELECT e.name as employee, m.name as manager FROM employees e JOIN employees m ON e.manager_id = m.emp_id",concept:"Self JOIN for hierarchies"},insight:{type:"mcq",question:"Why are aliases required in self JOINs?",options:["Better performance","Just for readability","To distinguish between table instances","SQL requires aliases for all JOINs"],correct:2,explanation:'Aliases distinguish between the two "copies" of the same table.'}},{id:12,day:"Friday",difficulty:"Medium",topic:"NULL Handling",avgSolveTime:5,solveRate:64,warmup:{type:"mcq",question:"What does NULL = NULL return?",options:["TRUE","FALSE","NULL","Error"],correct:2,explanation:"NULL = NULL returns NULL (unknown). Use IS NULL instead."},core:{title:"Handle Missing Ages",description:"Find all passengers with **unknown age (NULL)**. Show name and class.",dataset:"titanic",hint:"Use WHERE age IS NULL",solution:"SELECT name, pclass FROM passengers WHERE age IS NULL",concept:"NULL comparison"},insight:{type:"mcq",question:"COALESCE(a, b, c) returns:",options:["Always the first value","Sum of all values","First non-NULL value","Last value"],correct:2,explanation:"COALESCE returns first non-NULL. COALESCE(NULL, NULL, 5) = 5"}},{id:13,day:"Saturday",difficulty:"Mixed",topic:"Debug Challenge",avgSolveTime:4,solveRate:58,warmup:{type:"debug",question:"What's wrong with this query?",code:"SELECT name, department, salary\nFROM employees\nWHERE salary = MAX(salary);",options:["Can't use = with MAX","Aggregates can't be in WHERE","Missing GROUP BY","Syntax error in SELECT"],correct:1,explanation:"Use subquery: WHERE salary = (SELECT MAX(salary) FROM employees)"},core:{title:"Highest Earner",description:"Find the employee(s) with the **highest salary**. Show name, department, salary.",dataset:"employees",hint:"Subquery for MAX(salary) in WHERE",solution:"SELECT name, department, salary FROM employees WHERE salary = (SELECT MAX(salary) FROM employees)",concept:"Subquery for MAX"},insight:{type:"truefalse",question:"If multiple employees have the highest salary, this query returns all of them.",correct:!0,explanation:"WHERE salary = MAX returns ALL rows matching the maximum."}},{id:14,day:"Sunday",difficulty:"Hard",topic:"Interview Challenge",avgSolveTime:10,solveRate:40,isOptional:!0,warmup:{type:"mcq",question:"Most important consideration when writing SQL in interviews?",options:["Shortest query","Most advanced features","Correct, readable, handles edge cases","Finish fast"],correct:2,explanation:"Correctness and readability beat cleverness."},core:{title:"Find Duplicate Orders",description:"Find customer emails with **more than one order**. Show email and order count.",dataset:"ecommerce",hint:"GROUP BY email (via JOIN), HAVING COUNT(*) > 1",solution:"SELECT c.email, COUNT(*) as order_count FROM orders o JOIN customers c ON o.customer_id = c.customer_id GROUP BY c.email HAVING COUNT(*) > 1",concept:"Finding duplicates"},insight:{type:"mcq",question:"To delete duplicates keeping one, which is safest?",options:["DELETE with GROUP BY","ROW_NUMBER() to identify, then DELETE","DELETE all, re-insert unique","DISTINCT in DELETE"],correct:1,explanation:"ROW_NUMBER() numbers duplicates, then DELETE WHERE row_num > 1"}},{id:15,day:"Monday",difficulty:"Easy",topic:"String Functions",avgSolveTime:3,solveRate:82,warmup:{type:"mcq",question:"Which function combines strings?",options:["CONCAT()","MERGE()","COMBINE()","ADD()"],correct:0,explanation:'CONCAT() or || in SQLite: "Hello" || " World"'},core:{title:"Format Names",description:"Show passengers with **name in UPPERCASE** and **class as text** (First/Second/Third). **Limit to 20 rows.**",dataset:"titanic",hint:"Use UPPER() for name, CASE WHEN for class text",solution:"SELECT UPPER(name) as name_upper, CASE pclass WHEN 1 THEN 'First' WHEN 2 THEN 'Second' ELSE 'Third' END as class_name FROM passengers LIMIT 20",concept:"String functions + CASE"},insight:{type:"truefalse",question:"UPPER() and LOWER() work on numbers too.",correct:!1,explanation:"String functions are for strings only."}},{id:16,day:"Tuesday",difficulty:"Easy-Medium",topic:"IN Operator",avgSolveTime:4,solveRate:78,warmup:{type:"mcq",question:"What does IN (1, 2, 3) check?",options:["Value between 1 and 3","Value equals 1, 2, OR 3","Value equals 1, 2, AND 3","Value greater than 3"],correct:1,explanation:"IN checks if value matches ANY in the list."},core:{title:"Action & Comedy Movies",description:"Find **Action or Comedy** movies with rating above 7. Show title, genre, rating.",dataset:"movies",hint:"Use IN for genres, AND for rating",solution:"SELECT title, genre, rating FROM movies WHERE genre IN ('Action', 'Comedy') AND rating > 7",concept:"IN operator"},insight:{type:"mcq",question:"What happens with NOT IN when the list contains NULL?",options:["Works normally","Returns all rows","Returns no rows","Throws error"],correct:2,explanation:"NOT IN with NULL = empty result. Use NOT EXISTS instead."}},{id:17,day:"Wednesday",difficulty:"Medium",topic:"UNION",avgSolveTime:5,solveRate:65,warmup:{type:"mcq",question:"Difference between UNION and UNION ALL?",options:["UNION is faster","UNION ALL removes duplicates","UNION removes duplicates","They're the same"],correct:2,explanation:"UNION removes duplicates (slower). UNION ALL keeps all rows."},core:{title:"Combined Department List",description:"List employees from **Engineering** and **Marketing** with a dept column. Use UNION.",dataset:"employees",hint:"Two SELECTs with different WHERE, combined with UNION",solution:"SELECT name, 'Engineering' as dept FROM employees WHERE department = 'Engineering' UNION SELECT name, 'Marketing' FROM employees WHERE department = 'Marketing'",concept:"UNION"},insight:{type:"truefalse",question:"UNION requires both SELECTs to have the same number of columns.",correct:!0,explanation:"UNION needs matching column counts and compatible types."}},{id:18,day:"Thursday",difficulty:"Medium-Hard",topic:"Window Functions",avgSolveTime:7,solveRate:48,warmup:{type:"mcq",question:"Which window function calculates a running total?",options:["ROW_NUMBER()","RANK()","SUM() OVER","COUNT(*)"],correct:2,explanation:"SUM() OVER (ORDER BY ...) creates a running total."},core:{title:"Cumulative Revenue",description:"Calculate **running total of revenue** by year for movies with non-null revenue. Show title, year, revenue_millions, cumulative. **Limit to 20 rows.**",dataset:"movies",hint:"Use SUM(revenue_millions) OVER (ORDER BY year, title) and filter with WHERE revenue_millions IS NOT NULL",solution:"SELECT title, year, revenue_millions, SUM(revenue_millions) OVER (ORDER BY year, title) as cumulative FROM movies WHERE revenue_millions IS NOT NULL LIMIT 20",concept:"Running total"},insight:{type:"mcq",question:"In SUM() OVER (ORDER BY year), what does ORDER BY determine?",options:["Final output order","Order of calculation","Which rows to include","Nothing, optional"],correct:1,explanation:"ORDER BY in window function determines calculation order."}},{id:19,day:"Friday",difficulty:"Medium",topic:"BETWEEN",avgSolveTime:4,solveRate:72,warmup:{type:"truefalse",question:"BETWEEN 10 AND 20 includes both 10 and 20.",correct:!0,explanation:"BETWEEN is inclusive: >= 10 AND <= 20"},core:{title:"Mid-Range Salaries",description:"Find employees with salaries **between $60K and $90K**. Show name, department, salary (sorted by salary DESC).",dataset:"employees",hint:"WHERE salary BETWEEN 60000 AND 90000",solution:"SELECT name, department, salary FROM employees WHERE salary BETWEEN 60000 AND 90000 ORDER BY salary DESC",concept:"BETWEEN"},insight:{type:"mcq",question:"For date ranges, which is more readable?",options:["date >= X AND date <= Y","date BETWEEN X AND Y","Both equally readable","Neither"],correct:1,explanation:"BETWEEN is clearer and shows inclusive bounds."}},{id:20,day:"Saturday",difficulty:"Mixed",topic:"Debug Challenge",avgSolveTime:5,solveRate:55,warmup:{type:"debug",question:"Find the error:",code:"SELECT genre, title, rating,\n  RANK() OVER (ORDER BY rating DESC)\nFROM movies\nGROUP BY genre;",options:["RANK() syntax wrong","Can't mix window functions and GROUP BY this way","Missing alias for RANK()","ORDER BY should be outside"],correct:1,explanation:"Use PARTITION BY genre in OVER clause, not GROUP BY."},core:{title:"Rank Movies by Genre",description:"Rank movies **within each genre** by rating. Show genre, title, rating, rank.",dataset:"movies",hint:"RANK() OVER (PARTITION BY genre ORDER BY rating DESC)",solution:"SELECT genre, title, rating, RANK() OVER (PARTITION BY genre ORDER BY rating DESC) as genre_rank FROM movies",concept:"PARTITION BY + RANK"},insight:{type:"mcq",question:"RANK() vs DENSE_RANK() with ties?",options:["No difference","RANK() skips numbers after ties","DENSE_RANK() skips numbers","RANK() can't handle ties"],correct:1,explanation:'RANK: 1,1,3. DENSE_RANK: 1,1,2. Use DENSE_RANK for "top N".'}},{id:21,day:"Sunday",difficulty:"Hard",topic:"Interview Challenge",avgSolveTime:10,solveRate:38,isOptional:!0,warmup:{type:"mcq",question:'For "find duplicates", what should you clarify?',options:["Nothing, just write it","Which columns define duplicate, show all or just values","Which database","How many duplicates expected"],correct:1,explanation:"Clarify: which columns, show all rows or just duplicate values?"},core:{title:"Year-over-Year",description:"Compare each year's **total revenue** with **previous year** (exclude null revenues). Show year, revenue, prev_year revenue.",dataset:"movies",hint:"Use LAG() window function and filter WHERE revenue_millions IS NOT NULL",solution:"SELECT year, SUM(revenue_millions) as revenue, LAG(SUM(revenue_millions)) OVER (ORDER BY year) as prev_year FROM movies WHERE revenue_millions IS NOT NULL GROUP BY year ORDER BY year",concept:"LAG for comparisons"},insight:{type:"mcq",question:"What does LAG(value, 2) return?",options:["Value 2 rows ahead","Value 2 rows behind","Value × 2","2nd highest value"],correct:1,explanation:"LAG(v, N) = N rows BEFORE. LEAD = N rows AFTER."}},{id:22,day:"Monday",difficulty:"Easy",topic:"Aggregation Review",avgSolveTime:3,solveRate:85,warmup:{type:"mcq",question:"Which finds the middle value?",options:["AVG()","MEDIAN()","MID()","SQLite has no built-in MEDIAN"],correct:3,explanation:"Most databases don't have MEDIAN. Use subqueries or window functions."},core:{title:"Movie Statistics",description:"Show **average, max, min rating** and **total movie count**.",dataset:"movies",hint:"AVG(), MAX(), MIN(), COUNT(*) in one SELECT",solution:"SELECT AVG(rating) as avg_rating, MAX(rating) as max_rating, MIN(rating) as min_rating, COUNT(*) as total FROM movies",concept:"Multiple aggregations"},insight:{type:"truefalse",question:"AVG() ignores NULL values.",correct:!0,explanation:"AVG() only considers non-NULLs. [10, NULL, 20] → AVG = 15"}},{id:23,day:"Tuesday",difficulty:"Easy-Medium",topic:"LEFT JOIN",avgSolveTime:5,solveRate:70,warmup:{type:"mcq",question:"In LEFT JOIN, which table's rows are always included?",options:["Right","Left","Both","Neither completely"],correct:1,explanation:"LEFT JOIN keeps ALL from left table, matching or not."},core:{title:"All Customers + Orders",description:"Show **all customers** and order count. Include those with **0 orders** (show 0).",dataset:"ecommerce",hint:"LEFT JOIN, COUNT(order_id) handles NULLs correctly",solution:"SELECT c.name, COUNT(o.order_id) as order_count FROM customers c LEFT JOIN orders o ON c.customer_id = o.customer_id GROUP BY c.customer_id, c.name",concept:"LEFT JOIN + COUNT"},insight:{type:"mcq",question:"Why COUNT(o.order_id) = 0 for no orders, but COUNT(*) = 1?",options:["Bug","COUNT(col) ignores NULLs, COUNT(*) counts rows","They're the same","LEFT JOIN changes COUNT"],correct:1,explanation:"COUNT(*) counts the row. COUNT(col) counts non-NULLs (order_id is NULL)."}},{id:24,day:"Wednesday",difficulty:"Medium",topic:"Multiple Conditions",avgSolveTime:5,solveRate:62,warmup:{type:"truefalse",question:"You can use both WHERE and HAVING in the same query.",correct:!0,explanation:"WHERE filters rows, HAVING filters groups. Use both!"},core:{title:"High-Performing Depts",description:"Find depts with **avg salary > $75K** AND **2+ employees**. Show dept, count, avg salary.",dataset:"employees",hint:"GROUP BY with two HAVING conditions",solution:"SELECT department, COUNT(*) as emp_count, AVG(salary) as avg_salary FROM employees GROUP BY department HAVING AVG(salary) > 75000 AND COUNT(*) >= 2",concept:"Multiple HAVING"},insight:{type:"mcq",question:"To filter Engineering dept with avg > 75K, where does each filter go?",options:["Both in HAVING","Dept in WHERE, avg in HAVING","Both in WHERE","Doesn't matter"],correct:1,explanation:"Row filters (dept) in WHERE. Group filters (avg) in HAVING."}},{id:25,day:"Thursday",difficulty:"Medium-Hard",topic:"EXISTS",avgSolveTime:6,solveRate:52,warmup:{type:"mcq",question:"What does EXISTS return?",options:["A count","Matching rows","TRUE or FALSE","NULL"],correct:2,explanation:"EXISTS returns TRUE if subquery has any rows, FALSE otherwise."},core:{title:"Customers with Electronics",description:"Find customers with **at least one Electronics order**. Show name and email.",dataset:"ecommerce",hint:"EXISTS (SELECT 1 FROM orders WHERE customer_id matches AND category)",solution:"SELECT c.name, c.email FROM customers c WHERE EXISTS (SELECT 1 FROM orders o WHERE o.customer_id = c.customer_id AND o.category = 'Electronics')",concept:"EXISTS"},insight:{type:"mcq",question:"When is EXISTS faster than IN?",options:["Subquery returns few rows","Subquery returns many rows","Always same speed","EXISTS is always slower"],correct:1,explanation:"EXISTS stops at first match. IN must process all. EXISTS wins with many rows."}},{id:26,day:"Friday",difficulty:"Medium",topic:"LIKE Patterns",avgSolveTime:4,solveRate:70,warmup:{type:"mcq",question:"In LIKE, what does % match?",options:["One character","Zero or more characters","Only letters","Only numbers"],correct:1,explanation:"% = any characters. _ = exactly one character."},core:{title:"Find Directors",description:'Find movies by directors starting with **"Christopher"**. Show title, director, year.',dataset:"movies",hint:"WHERE director LIKE 'Christopher%'",solution:"SELECT title, director, year FROM movies WHERE director LIKE 'Christopher%'",concept:"LIKE patterns"},insight:{type:"truefalse",question:"LIKE is case-sensitive in SQLite by default.",correct:!1,explanation:'SQLite LIKE is case-INSENSITIVE for ASCII. "abc" LIKE "ABC" = TRUE'}},{id:27,day:"Saturday",difficulty:"Mixed",topic:"Debug Challenge",avgSolveTime:5,solveRate:58,warmup:{type:"debug",question:"Why might this fail?",code:"SELECT customer_id, name\nFROM customers\nWHERE customer_id NOT IN (\n  SELECT customer_id FROM orders\n  WHERE customer_id IS NULL\n);",options:["NOT IN with potential NULLs","Syntax error","Missing JOIN","Wrong column names"],correct:0,explanation:"NOT IN with any NULL = no results. Use NOT EXISTS."},core:{title:"Safe NOT IN",description:"Find customers who **never ordered Electronics**. Use NOT EXISTS.",dataset:"ecommerce",hint:"NOT EXISTS (SELECT 1 FROM orders WHERE matches AND category)",solution:"SELECT name, email FROM customers c WHERE NOT EXISTS (SELECT 1 FROM orders o WHERE o.customer_id = c.customer_id AND o.category = 'Electronics')",concept:"NOT EXISTS (safer)"},insight:{type:"mcq",question:'Safest "not in list" when NULLs might exist?',options:["NOT IN","NOT EXISTS","<> ALL","All the same"],correct:1,explanation:"NOT EXISTS handles NULLs correctly."}},{id:28,day:"Sunday",difficulty:"Hard",topic:"Interview Challenge",avgSolveTime:12,solveRate:35,isOptional:!0,warmup:{type:"mcq",question:'For "consecutive days" problems, which approach?',options:["Multiple self-joins","ROW_NUMBER() and date arithmetic","Recursive CTE","CASE statements"],correct:1,explanation:"ROW_NUMBER minus date groups consecutive dates."},core:{title:"Top per Country",description:"Find the **highest spending customer per country**. Show country, name, total spent.",dataset:"ecommerce",hint:"Calculate totals first, then find max per country",solution:"WITH totals AS (SELECT o.country, c.name, SUM(o.quantity * o.price) as spent FROM orders o JOIN customers c ON o.customer_id = c.customer_id GROUP BY o.country, c.customer_id) SELECT country, name, spent FROM totals t WHERE spent = (SELECT MAX(spent) FROM totals WHERE country = t.country)",concept:"Top per group"},insight:{type:"mcq",question:'For "top N per group", most efficient approach?',options:["Correlated subquery","Multiple JOINs","ROW_NUMBER() OVER PARTITION","UNION ALL"],correct:2,explanation:"ROW_NUMBER with PARTITION BY scans data once."}},{id:29,day:"Monday",difficulty:"Easy",topic:"Complete Query",avgSolveTime:3,solveRate:88,warmup:{type:"mcq",question:"Correct clause order?",options:["SELECT, WHERE, FROM, GROUP BY","SELECT, FROM, WHERE, GROUP BY, ORDER BY","FROM, SELECT, WHERE, ORDER BY","SELECT, FROM, GROUP BY, WHERE"],correct:1,explanation:"SELECT → FROM → WHERE → GROUP BY → HAVING → ORDER BY → LIMIT"},core:{title:"Full Query",description:"Show **dept**, **avg salary** for depts with avg > $60K, sorted descending, **top 3 only**.",dataset:"employees",hint:"Use all clauses: GROUP BY, HAVING, ORDER BY, LIMIT",solution:"SELECT department, AVG(salary) as avg_sal FROM employees GROUP BY department HAVING AVG(salary) > 60000 ORDER BY avg_sal DESC LIMIT 3",concept:"All clauses together"},insight:{type:"truefalse",question:"You can use avg_sal alias in HAVING.",correct:!1,explanation:"HAVING runs before SELECT. Repeat AVG(salary)."}},{id:30,day:"Tuesday",difficulty:"Medium",topic:"Final Challenge",avgSolveTime:8,solveRate:55,warmup:{type:"mcq",question:"Best way to keep improving SQL?",options:["Memorize syntax","Daily practice + learn from mistakes","Read documentation","Watch tutorials"],correct:1,explanation:"Consistent practice with real problems is the fastest path!"},core:{title:"Genre Summary",description:"For genres with **5+ movies**: show genre, count, avg rating (1 decimal), total revenue. **Sort by avg rating DESC**.",dataset:"movies",hint:"GROUP BY genre, HAVING COUNT >= 5, ROUND for decimal, ORDER BY avg_rating",solution:"SELECT genre, COUNT(*) as movies, ROUND(AVG(rating), 1) as avg_rating, SUM(revenue_millions) as total_revenue FROM movies GROUP BY genre HAVING COUNT(*) >= 5 ORDER BY avg_rating DESC",concept:"Comprehensive analysis"},insight:{type:"mcq",question:"You completed 30 days! What's next?",options:["Done learning SQL","Harder challenges + real datasets + interviews","Start over from day 1","Move to NoSQL"],correct:1,explanation:"Keep practicing! Try LeetCode SQL, Kaggle datasets, interview prep!"}}],window.getDailyChallenge=()=>{const e=window.dailyChallengesData;if(!e||0===e.length)return null;const s=new Date,n=new Date(s.getTime()+108e5);n.getUTCHours()<8&&n.setUTCDate(n.getUTCDate()-1);const a=new Date(n.getFullYear(),0,0),t=n-a;return e[Math.floor(t/864e5)%e.length]},window.getTimeUntilNextChallenge=()=>{const e=new Date,s=new Date(e.getTime()+108e5);let n=new Date(s);n.setUTCHours(8,0,0,0),s.getUTCHours()>=8&&n.setUTCDate(n.getUTCDate()+1);const a=n-s;return{hours:Math.floor(a/36e5),minutes:Math.floor(a%36e5/6e4)}},window.mockInterviewsData=[{id:"sql-fundamentals-free",title:"SQL Fundamentals Assessment",company:"General",role:"Entry-Level Data Analyst",difficulty:"Easy-Medium",totalTime:1500,questionsCount:4,isFree:!0,description:"Test your core SQL skills with fundamental queries. Perfect for beginners preparing for entry-level positions.",skills:["SELECT","WHERE","ORDER BY","JOINs","Aggregation"],questions:[{id:"free-q1",order:1,title:"Filter and Sort",description:"Write a query to find all **employees** with a salary greater than **$70,000**. Show their **name**, **department**, and **salary**, sorted by salary in descending order.",timeLimit:300,difficulty:"Easy",points:20,dataset:"employees",solution:"SELECT name, department, salary FROM employees WHERE salary > 70000 ORDER BY salary DESC",hints:["Use WHERE to filter by salary","Use ORDER BY column DESC for descending order"],concepts:["SELECT","WHERE","ORDER BY"]},{id:"free-q2",order:2,title:"Aggregation Basics",description:"Calculate the **average salary** for each **department**. Show the department name and average salary, rounded to 2 decimal places.",timeLimit:360,difficulty:"Easy",points:25,dataset:"employees",solution:"SELECT department, ROUND(AVG(salary), 2) as avg_salary FROM employees GROUP BY department",hints:["Use GROUP BY to group by department","AVG() calculates average, ROUND() rounds the result"],concepts:["GROUP BY","AVG","ROUND"]},{id:"free-q3",order:3,title:"JOIN Tables",description:"List all **orders** with their **customer names**. Show the order_id, customer name, and order total. Include only orders over **$100**.",timeLimit:420,difficulty:"Medium",points:30,dataset:"ecommerce",solution:"SELECT o.order_id, c.name, o.total FROM orders o JOIN customers c ON o.customer_id = c.customer_id WHERE o.total > 100",hints:["JOIN orders with customers on customer_id","Use table aliases (o, c) for cleaner code"],concepts:["JOIN","WHERE","Table Aliases"]},{id:"free-q4",order:4,title:"Grouping with Conditions",description:"Find departments that have **more than 3 employees** with a salary above **$60,000**. Show the department and the count.",timeLimit:420,difficulty:"Medium",points:25,dataset:"employees",solution:"SELECT department, COUNT(*) as high_earners FROM employees WHERE salary > 60000 GROUP BY department HAVING COUNT(*) > 3",hints:["First filter with WHERE, then group","Use HAVING to filter after GROUP BY"],concepts:["WHERE","GROUP BY","HAVING","COUNT"]}],passingScore:60},{id:"data-analyst-mid",title:"Data Analyst Interview",company:"Tech Startup",role:"Mid-Level Data Analyst",difficulty:"Medium",totalTime:2100,questionsCount:5,isFree:!1,description:"Real-world data analyst interview focusing on business insights, reporting, and data manipulation.",skills:["JOINs","Subqueries","Date Functions","CASE WHEN","Window Functions"],questions:[{id:"da-q1",order:1,title:"Monthly Revenue Report",description:"Calculate the **total revenue per month** for 2024. Show the month (YYYY-MM format) and total revenue, sorted chronologically.",timeLimit:300,difficulty:"Easy",points:15,dataset:"ecommerce",solution:"SELECT strftime('%Y-%m', order_date) as month, SUM(total) as revenue FROM orders WHERE strftime('%Y', order_date) = '2024' GROUP BY month ORDER BY month",hints:["Use strftime('%Y-%m', date) to format as YYYY-MM","GROUP BY the formatted month"],concepts:["Date Functions","SUM","GROUP BY"]},{id:"da-q2",order:2,title:"Customer Segmentation",description:'Categorize customers by total spending: **"VIP"** (>$500), **"Regular"** ($100-$500), **"Low"** (<$100). Show customer name and category.',timeLimit:420,difficulty:"Medium",points:20,dataset:"ecommerce",solution:"SELECT c.name, CASE WHEN COALESCE(SUM(o.total), 0) > 500 THEN 'VIP' WHEN COALESCE(SUM(o.total), 0) >= 100 THEN 'Regular' ELSE 'Low' END as category FROM customers c LEFT JOIN orders o ON c.customer_id = o.customer_id GROUP BY c.customer_id, c.name",hints:["Use CASE WHEN for categorization","LEFT JOIN includes customers with no orders"],concepts:["CASE WHEN","LEFT JOIN","COALESCE","GROUP BY"]},{id:"da-q3",order:3,title:"Inactive Customers",description:"Find customers who registered but have **never placed an order**. Show their name, email, and signup date.",timeLimit:360,difficulty:"Medium",points:20,dataset:"ecommerce",solution:"SELECT c.name, c.email, c.signup_date FROM customers c LEFT JOIN orders o ON c.customer_id = o.customer_id WHERE o.order_id IS NULL",hints:["LEFT JOIN keeps all customers","NULL check finds those without orders"],concepts:["LEFT JOIN","NULL Check","Filtering"]},{id:"da-q4",order:4,title:"Top Spending Customers",description:"Find the **top 5 customers** by total spending. Show rank, customer name, and total spent.",timeLimit:480,difficulty:"Medium-Hard",points:25,dataset:"ecommerce",solution:"SELECT ROW_NUMBER() OVER (ORDER BY SUM(o.total) DESC) as rank, c.name, SUM(o.total) as total_spent FROM customers c JOIN orders o ON c.customer_id = o.customer_id GROUP BY c.customer_id, c.name ORDER BY total_spent DESC LIMIT 5",hints:["ROW_NUMBER() creates ranking","JOIN and GROUP BY to sum per customer"],concepts:["Window Functions","ROW_NUMBER","GROUP BY","LIMIT"]},{id:"da-q5",order:5,title:"Year-over-Year Comparison",description:"Compare **total revenue between 2023 and 2024**. Show year, revenue, and the difference from previous year.",timeLimit:540,difficulty:"Hard",points:20,dataset:"ecommerce",solution:"SELECT year, revenue, revenue - LAG(revenue) OVER (ORDER BY year) as yoy_diff FROM (SELECT strftime('%Y', order_date) as year, SUM(total) as revenue FROM orders WHERE strftime('%Y', order_date) IN ('2023', '2024') GROUP BY year) ORDER BY year",hints:["LAG() gets previous row value","Subquery first aggregates by year"],concepts:["Window Functions","LAG","Subquery","Date Functions"]}],passingScore:60},{id:"backend-engineer-sql",title:"Backend Engineer SQL Round",company:"SaaS Company",role:"Backend Engineer",difficulty:"Medium-Hard",totalTime:2400,questionsCount:5,isFree:!1,description:"Technical SQL interview for backend roles. Focus on complex queries, data integrity, and performance.",skills:["Complex JOINs","Subqueries","Window Functions","Data Integrity","Self-JOINs"],questions:[{id:"be-q1",order:1,title:"Multi-table Query",description:"Get a complete order summary: **order_id**, **customer name**, **product**, and **order total**. Only include completed orders.",timeLimit:420,difficulty:"Medium",points:20,dataset:"ecommerce",solution:"SELECT o.order_id, c.name as customer_name, o.product, o.total FROM orders o JOIN customers c ON o.customer_id = c.customer_id WHERE o.status = 'completed' ORDER BY o.order_id",hints:["Join two tables: orders and customers","GROUP BY to count items per order"],concepts:["Multiple JOINs","GROUP BY","COUNT"]},{id:"be-q2",order:2,title:"Above Average Query",description:"Find employees who earn **more than the average salary in their department**. Show name, department, salary, and department average.",timeLimit:480,difficulty:"Medium-Hard",points:25,dataset:"employees",solution:"SELECT e.name, e.department, e.salary, dept_avg.avg_sal FROM employees e JOIN (SELECT department, AVG(salary) as avg_sal FROM employees GROUP BY department) dept_avg ON e.department = dept_avg.department WHERE e.salary > dept_avg.avg_sal",hints:["Subquery calculates average per department","JOIN to compare individual vs average"],concepts:["Subquery","JOIN","AVG","Comparison"]},{id:"be-q3",order:3,title:"Ranking Employees",description:"Rank employees by salary **within each department**. Show name, department, salary, and rank (1 = highest).",timeLimit:420,difficulty:"Hard",points:20,dataset:"employees",solution:"SELECT name, department, salary, RANK() OVER (PARTITION BY department ORDER BY salary DESC) as salary_rank FROM employees ORDER BY department, salary_rank",hints:["RANK() creates rankings","PARTITION BY separates by department"],concepts:["Window Functions","RANK","PARTITION BY"]},{id:"be-q4",order:4,title:"Running Total",description:"Calculate the **running total of daily revenue**. Show order_date, daily total, and cumulative total.",timeLimit:540,difficulty:"Hard",points:20,dataset:"ecommerce",solution:"SELECT order_date, SUM(total) as daily_revenue, SUM(SUM(total)) OVER (ORDER BY order_date ROWS UNBOUNDED PRECEDING) as running_total FROM orders GROUP BY order_date ORDER BY order_date",hints:["First GROUP BY date, then apply window function","SUM() OVER (ORDER BY ...) creates running total"],concepts:["Window Functions","Running Total","GROUP BY"]},{id:"be-q5",order:5,title:"Duplicate Detection",description:"Find **duplicate email addresses** in customers table. Show the email, count of occurrences, and customer names.",timeLimit:540,difficulty:"Medium",points:15,dataset:"ecommerce",solution:"SELECT email, COUNT(*) as count, GROUP_CONCAT(name) as customer_names FROM customers GROUP BY email HAVING COUNT(*) > 1",hints:["GROUP BY email to find duplicates","HAVING COUNT(*) > 1 filters duplicates"],concepts:["GROUP BY","HAVING","GROUP_CONCAT","Duplicate Detection"]}],passingScore:55},{id:"faang-sql-interview",title:"FAANG-Style SQL Interview",company:"Big Tech",role:"Software Engineer / Data Engineer",difficulty:"Hard",totalTime:3e3,questionsCount:5,isFree:!1,description:"Challenging interview simulating FAANG-level SQL questions. Tests advanced concepts and edge case handling.",skills:["Advanced Window Functions","CTEs","Complex Subqueries","Self-JOINs","Edge Cases"],questions:[{id:"faang-q1",order:1,title:"Second Highest Salary",description:"Find the **second highest salary** in the employees table. Return just the salary value. Handle the edge case where there might not be one.",timeLimit:420,difficulty:"Medium",points:20,dataset:"employees",solution:"SELECT MAX(salary) as second_highest FROM employees WHERE salary < (SELECT MAX(salary) FROM employees)",hints:["First find the maximum salary","Then find max of salaries less than that"],concepts:["Subquery","MAX","Edge Cases"]},{id:"faang-q2",order:2,title:"Consecutive Orders",description:"Find customers who placed orders on **at least 2 consecutive days**. Show customer name and their consecutive dates.",timeLimit:720,difficulty:"Hard",points:25,dataset:"ecommerce",solution:"SELECT DISTINCT c.name, o1.order_date as day1, o2.order_date as day2 FROM orders o1 JOIN orders o2 ON o1.customer_id = o2.customer_id AND DATE(o2.order_date) = DATE(o1.order_date, '+1 day') JOIN customers c ON o1.customer_id = c.customer_id",hints:["Self-join orders to compare dates","DATE(date, '+1 day') adds one day"],concepts:["Self-JOIN","Date Arithmetic","DISTINCT"]},{id:"faang-q3",order:3,title:"Top N Per Group",description:"Find the **top 2 highest-paid employees in each department**. Show department, name, salary, and rank.",timeLimit:600,difficulty:"Hard",points:20,dataset:"employees",solution:"SELECT department, name, salary, rn as rank FROM (SELECT department, name, salary, ROW_NUMBER() OVER (PARTITION BY department ORDER BY salary DESC) as rn FROM employees) WHERE rn <= 2",hints:["ROW_NUMBER() ranks within each partition","Filter for rank <= 2 in outer query"],concepts:["Window Functions","ROW_NUMBER","PARTITION BY","Subquery"]},{id:"faang-q4",order:4,title:"Gap to Next",description:"For each employee, find the **salary gap** to the next highest earner in their department. Show name, salary, and gap.",timeLimit:600,difficulty:"Hard",points:20,dataset:"employees",solution:"SELECT name, department, salary, LEAD(salary) OVER (PARTITION BY department ORDER BY salary) - salary as gap_to_next FROM employees ORDER BY department, salary",hints:["LEAD() gets next row value","PARTITION BY for within-department"],concepts:["Window Functions","LEAD","PARTITION BY"]},{id:"faang-q5",order:5,title:"Percentile Ranking",description:"Assign each order a **percentile rank** (0-100) based on order total. Show order_id, total, and percentile.",timeLimit:660,difficulty:"Hard",points:15,dataset:"ecommerce",solution:"SELECT order_id, total, ROUND(PERCENT_RANK() OVER (ORDER BY total) * 100, 0) as percentile FROM orders ORDER BY percentile DESC",hints:["PERCENT_RANK() gives 0-1 position","Multiply by 100 for percentile"],concepts:["Window Functions","PERCENT_RANK","Percentiles"]}],passingScore:50},{id:"business-analyst-sql",title:"Business Analyst SQL Test",company:"E-commerce Corp",role:"Business Analyst",difficulty:"Medium",totalTime:1800,questionsCount:5,isFree:!1,description:"Business-focused SQL interview emphasizing KPIs, reporting, and actionable business insights.",skills:["Reporting","KPIs","Aggregation","Percentages","Business Logic"],questions:[{id:"ba-q1",order:1,title:"Daily Active Customers",description:"Count the **unique customers** who placed orders for each day. Show date and customer count, sorted by date.",timeLimit:300,difficulty:"Easy",points:15,dataset:"ecommerce",solution:"SELECT order_date, COUNT(DISTINCT customer_id) as active_customers FROM orders GROUP BY order_date ORDER BY order_date",hints:["COUNT(DISTINCT ...) counts unique values","GROUP BY date"],concepts:["COUNT DISTINCT","GROUP BY","DAU"]},{id:"ba-q2",order:2,title:"Average Order Value",description:"Calculate **Average Order Value (AOV)** by customer country. Show country and AOV (rounded to 2 decimals), sorted by AOV descending.",timeLimit:360,difficulty:"Easy-Medium",points:20,dataset:"ecommerce",solution:"SELECT c.country, ROUND(AVG(o.total), 2) as aov FROM customers c JOIN orders o ON c.customer_id = o.customer_id GROUP BY c.country ORDER BY aov DESC",hints:["JOIN customers and orders","AVG calculates average order value"],concepts:["JOIN","AVG","GROUP BY","Business Metrics"]},{id:"ba-q3",order:3,title:"Repeat Purchase Rate",description:"Calculate the **percentage of customers** who have placed more than one order. Return a single percentage value.",timeLimit:480,difficulty:"Medium",points:25,dataset:"ecommerce",solution:"SELECT ROUND(100.0 * SUM(CASE WHEN order_count > 1 THEN 1 ELSE 0 END) / COUNT(*), 2) as repeat_rate FROM (SELECT customer_id, COUNT(*) as order_count FROM orders GROUP BY customer_id)",hints:["First count orders per customer","Then calculate % with more than 1"],concepts:["Subquery","CASE WHEN","Percentage Calculation"]},{id:"ba-q4",order:4,title:"Order Status Breakdown",description:"Show the **count and percentage** of orders in each status (pending, completed, cancelled).",timeLimit:360,difficulty:"Medium",points:20,dataset:"ecommerce",solution:"SELECT status, COUNT(*) as count, ROUND(100.0 * COUNT(*) / (SELECT COUNT(*) FROM orders), 2) as percentage FROM orders GROUP BY status ORDER BY count DESC",hints:["Subquery gets total count","Calculate percentage for each status"],concepts:["GROUP BY","Subquery","Percentage"]},{id:"ba-q5",order:5,title:"Revenue by Day of Week",description:"Calculate **total revenue by day of week** (Sunday=0 to Saturday=6). Show day number, day name, and revenue.",timeLimit:300,difficulty:"Medium",points:20,dataset:"ecommerce",solution:"SELECT CAST(strftime('%w', order_date) AS INTEGER) as day_num, CASE CAST(strftime('%w', order_date) AS INTEGER) WHEN 0 THEN 'Sunday' WHEN 1 THEN 'Monday' WHEN 2 THEN 'Tuesday' WHEN 3 THEN 'Wednesday' WHEN 4 THEN 'Thursday' WHEN 5 THEN 'Friday' ELSE 'Saturday' END as day_name, SUM(total) as revenue FROM orders GROUP BY day_num ORDER BY day_num",hints:["strftime('%w', date) gives day of week","CASE WHEN maps number to name"],concepts:["Date Functions","CASE WHEN","GROUP BY"]}],passingScore:60},{id:"senior-data-engineer",title:"Senior Data Engineer Interview",company:"Fintech",role:"Senior Data Engineer",difficulty:"Hard",totalTime:3300,questionsCount:5,isFree:!1,description:"Advanced SQL interview for senior positions. Focus on optimization, complex transformations, and analytics.",skills:["Advanced Window Functions","CTEs","Performance","Complex Analytics","Data Quality"],questions:[{id:"sde-q1",order:1,title:"Month-over-Month Growth",description:"Calculate **month-over-month revenue growth rate** as a percentage. Show month, revenue, previous month revenue, and growth rate.",timeLimit:600,difficulty:"Hard",points:20,dataset:"ecommerce",solution:"SELECT month, revenue, prev_revenue, ROUND(100.0 * (revenue - prev_revenue) / prev_revenue, 2) as growth_rate FROM (SELECT strftime('%Y-%m', order_date) as month, SUM(total) as revenue, LAG(SUM(total)) OVER (ORDER BY strftime('%Y-%m', order_date)) as prev_revenue FROM orders GROUP BY month) WHERE prev_revenue IS NOT NULL ORDER BY month",hints:["LAG() gets previous month revenue","Growth = (current - prev) / prev × 100"],concepts:["Window Functions","LAG","Growth Calculation"]},{id:"sde-q2",order:2,title:"Customer Cohort",description:"Group customers by **signup month** and calculate how many orders each cohort placed in their first 30 days. Show signup month and order count.",timeLimit:720,difficulty:"Hard",points:25,dataset:"ecommerce",solution:"SELECT strftime('%Y-%m', c.signup_date) as cohort, COUNT(o.order_id) as orders_in_30_days FROM customers c LEFT JOIN orders o ON c.customer_id = o.customer_id AND julianday(o.order_date) - julianday(c.signup_date) BETWEEN 0 AND 30 GROUP BY cohort ORDER BY cohort",hints:["JOIN with date range condition","julianday() for date math"],concepts:["Cohort Analysis","Date Math","LEFT JOIN"]},{id:"sde-q3",order:3,title:"Percentile Analysis",description:"Find orders in the **top 10% by value**. Show order_id, total, and percentile rank.",timeLimit:600,difficulty:"Hard",points:20,dataset:"ecommerce",solution:"SELECT order_id, total, ROUND(pct_rank * 100, 0) as percentile FROM (SELECT order_id, total, PERCENT_RANK() OVER (ORDER BY total DESC) as pct_rank FROM orders) WHERE pct_rank <= 0.10 ORDER BY total DESC",hints:["PERCENT_RANK() with DESC puts highest at top","Filter for top 10% (rank <= 0.10)"],concepts:["Window Functions","PERCENT_RANK","Percentiles"]},{id:"sde-q4",order:4,title:"Gap Detection",description:"Find **gaps in order IDs** (missing sequence numbers). Show the start and end of each gap.",timeLimit:720,difficulty:"Very Hard",points:20,dataset:"ecommerce",solution:"SELECT order_id + 1 as gap_start, next_id - 1 as gap_end FROM (SELECT order_id, LEAD(order_id) OVER (ORDER BY order_id) as next_id FROM orders) WHERE next_id - order_id > 1",hints:["LEAD() gets the next order_id","Gap exists when difference > 1"],concepts:["Window Functions","LEAD","Gap Analysis"]},{id:"sde-q5",order:5,title:"Cumulative Distinct",description:"Calculate the **cumulative count of unique customers** over time. Show date and running unique customer count.",timeLimit:660,difficulty:"Very Hard",points:15,dataset:"ecommerce",solution:"SELECT order_date, (SELECT COUNT(DISTINCT o2.customer_id) FROM orders o2 WHERE o2.order_date <= o1.order_date) as cumulative_customers FROM (SELECT DISTINCT order_date FROM orders) o1 ORDER BY order_date",hints:["Correlated subquery counts up to each date","Cannot use simple window function for distinct"],concepts:["Correlated Subquery","Cumulative Distinct","Advanced Analytics"]}],passingScore:50}],window.interviewCategories=[{id:"all",label:"All Interviews",icon:"📋"},{id:"free",label:"Free",icon:"🆓"},{id:"data-analyst",label:"Data Analyst",icon:"📊"},{id:"backend",label:"Backend Engineer",icon:"⚙️"},{id:"faang",label:"FAANG-Style",icon:"🏢"},{id:"senior",label:"Senior Level",icon:"👨‍💼"}],window.getInterviewCategory=e=>e.isFree?"free":e.id.includes("analyst")||e.id.includes("business")?"data-analyst":e.id.includes("backend")?"backend":e.id.includes("faang")?"faang":e.id.includes("senior")?"senior":"all",window.thirtyDayChallenge={title:"Master SQL 30-Day Challenge",description:"Transform from SQL beginner to expert in 30 days with our structured curriculum",weeks:[{id:1,title:"SQL for Data Analysis",subtitle:"Days 1-7: Fundamentals",color:"from-blue-500 to-cyan-500",icon:"📊"},{id:2,title:"Intermediate SQL",subtitle:"Days 8-14: Level Up",color:"from-green-500 to-emerald-500",icon:"📈"},{id:3,title:"Advanced SQL",subtitle:"Days 15-21: Pro Skills",color:"from-purple-500 to-pink-500",icon:"🚀"},{id:4,title:"SQL for Data Analysis",subtitle:"Days 22-28: Analytics",color:"from-orange-500 to-red-500",icon:"🔬"},{id:5,title:"Best Practices",subtitle:"Days 29-30: Mastery",color:"from-yellow-500 to-amber-500",icon:"🏆"}],days:[{day:1,week:1,title:"Introduction to SQL",description:"Learn what SQL is, why it matters, and write your first query",concepts:["SQL basics","Databases","Tables"],lesson:{content:"# Welcome to SQL! 🎉\n\n**SQL (Structured Query Language)** is the standard language for working with databases. It's used by data analysts, scientists, engineers, and developers worldwide.\n\n## What You'll Learn Today\n- What SQL is and why it's important\n- How databases organize data\n- Your first SELECT query\n\n## Key Concepts\n\n### Databases & Tables\nA **database** is like a filing cabinet that stores organized data. Inside, **tables** hold the actual data in rows and columns - just like a spreadsheet!\n\n### The SELECT Statement\nThe most fundamental SQL command retrieves data from a table:\n\n```sql\nSELECT * FROM employees;\n```\n\nThis gets ALL columns (*) from the employees table.\n\n### Selecting Specific Columns\n```sql\nSELECT name, salary FROM employees;\n```\n\nThis gets only the name and salary columns.",tips:["SQL keywords like SELECT and FROM are not case-sensitive, but UPPERCASE is conventional","Always end statements with a semicolon (;)","The * symbol means 'all columns'"]},challenge:{title:"Your First Query",description:"Write a query to select all columns from the **passengers** table in the Titanic dataset.",dataset:"titanic",solution:"SELECT * FROM passengers;",alternativeSolutions:["SELECT * FROM passengers","select * from passengers;"],hints:["Use SELECT * to get all columns","The table name is 'passengers'","Don't forget the semicolon!"],expectedRows:891,points:10},bonusChallenge:{title:"Specific Columns",description:"Select only the **Name** and **Age** columns from the passengers table.",solution:"SELECT Name, Age FROM passengers;",points:5}},{day:2,week:1,title:"Understanding Databases and Tables",description:"Explore database structure, data types, and table schemas",concepts:["Schema","Data types","Table structure"],lesson:{content:"# Databases & Tables Deep Dive 🗄️\n\n## Database Structure\n\nThink of a database as a container that holds multiple related tables:\n\n```\nDatabase: company_db\n├── employees (table)\n├── departments (table)\n├── salaries (table)\n└── projects (table)\n```\n\n## Data Types\n\nEach column has a specific data type:\n\n| Type | Description | Example |\n|------|-------------|---------|\n| INTEGER | Whole numbers | 42, -7, 0 |\n| REAL/FLOAT | Decimal numbers | 3.14, -0.5 |\n| TEXT | Strings/words | 'Hello', 'John' |\n| DATE | Dates | '2024-01-15' |\n| BOOLEAN | True/False | 1, 0 |\n\n## Viewing Table Structure\n\nTo see what columns a table has:\n```sql\nPRAGMA table_info(passengers);\n```\n\n## NULL Values\nNULL represents missing or unknown data - it's different from 0 or empty string!",tips:["NULL is not the same as 0 or an empty string","Data types help ensure data integrity","Understanding schema is crucial for writing correct queries"]},challenge:{title:"Explore the Schema",description:"Select the **PassengerId**, **Name**, **Sex**, and **Age** columns from the passengers table.",dataset:"titanic",solution:"SELECT PassengerId, Name, Sex, Age FROM passengers;",hints:["List column names separated by commas","Column names are case-sensitive"],points:10}},{day:3,week:1,title:"SELECT Statement Mastery",description:"Master column selection, aliases, and expressions",concepts:["SELECT","Aliases","Expressions"],lesson:{content:"# SELECT Statement Mastery 🎯\n\n## Column Aliases\nGive columns friendlier names using AS:\n\n```sql\nSELECT Name AS passenger_name, \n       Age AS passenger_age \nFROM passengers;\n```\n\n## Expressions in SELECT\nPerform calculations directly in your query:\n\n```sql\nSELECT Name, \n       Age,\n       Age * 12 AS age_in_months\nFROM passengers;\n```\n\n## String Concatenation\nCombine text values:\n\n```sql\nSELECT Name || ' - ' || Sex AS passenger_info\nFROM passengers;\n```\n\n## DISTINCT - Remove Duplicates\nGet unique values only:\n\n```sql\nSELECT DISTINCT Pclass FROM passengers;\n```\n\nThis returns only the unique passenger classes (1, 2, 3).",tips:["AS keyword is optional but improves readability","Use || for string concatenation in SQLite","DISTINCT is great for exploring unique values in a column"]},challenge:{title:"Calculated Columns",description:"Select passenger **Name**, **Fare**, and create a column called **fare_in_cents** that multiplies Fare by 100.",dataset:"titanic",solution:"SELECT Name, Fare, Fare * 100 AS fare_in_cents FROM passengers;",hints:["Use AS to create an alias","Multiply Fare by 100","Column alias should be fare_in_cents"],points:15}},{day:4,week:1,title:"WHERE Clause and Logical Operators",description:"Filter data using conditions and combine them with AND/OR",concepts:["WHERE","AND","OR","Comparison operators"],lesson:{content:"# Filtering with WHERE 🔍\n\n## Basic WHERE Clause\nFilter rows that match a condition:\n\n```sql\nSELECT * FROM passengers\nWHERE Age > 30;\n```\n\n## Comparison Operators\n\n| Operator | Meaning |\n|----------|---------|\n| = | Equal to |\n| != or <> | Not equal to |\n| > | Greater than |\n| < | Less than |\n| >= | Greater than or equal |\n| <= | Less than or equal |\n\n## Combining Conditions\n\n### AND - Both must be true\n```sql\nSELECT * FROM passengers\nWHERE Age > 30 AND Sex = 'female';\n```\n\n### OR - Either can be true\n```sql\nSELECT * FROM passengers\nWHERE Pclass = 1 OR Pclass = 2;\n```\n\n### NOT - Negate a condition\n```sql\nSELECT * FROM passengers\nWHERE NOT Survived = 0;\n```\n\n## Working with NULL\n```sql\nSELECT * FROM passengers WHERE Age IS NULL;\nSELECT * FROM passengers WHERE Age IS NOT NULL;\n```",tips:["Text values need single quotes: 'female'","Use IS NULL, not = NULL for null checks","Parentheses help clarify complex conditions"]},challenge:{title:"Filter Survivors",description:"Find all **female passengers** who **survived** (Survived = 1).",dataset:"titanic",solution:"SELECT * FROM passengers WHERE Sex = 'female' AND Survived = 1;",hints:["Use AND to combine conditions","Sex should equal 'female' (with quotes)","Survived should equal 1"],points:15}},{day:5,week:1,title:"Sorting Data with ORDER BY",description:"Sort results in ascending or descending order",concepts:["ORDER BY","ASC","DESC","Multiple sorting"],lesson:{content:"# Sorting with ORDER BY 📊\n\n## Basic Sorting\nSort results by a column:\n\n```sql\nSELECT * FROM passengers\nORDER BY Age;\n```\n\n## Ascending vs Descending\n\n```sql\n-- Youngest first (default)\nSELECT * FROM passengers ORDER BY Age ASC;\n\n-- Oldest first\nSELECT * FROM passengers ORDER BY Age DESC;\n```\n\n## Multiple Sort Columns\nSort by multiple columns - first by Pclass, then by Age within each class:\n\n```sql\nSELECT * FROM passengers\nORDER BY Pclass ASC, Age DESC;\n```\n\n## Sorting with NULL\nNULL values appear first with ASC, last with DESC (in most databases).\n\n## Combining with WHERE\n```sql\nSELECT Name, Age, Fare FROM passengers\nWHERE Survived = 1\nORDER BY Fare DESC;\n```",tips:["ASC is the default (ascending)","DESC sorts from highest to lowest","ORDER BY always comes after WHERE"]},challenge:{title:"Top Fares",description:"Find the **top 20 passengers** who paid the highest **Fare**. Show Name, Pclass, and Fare, sorted by Fare descending.",dataset:"titanic",solution:"SELECT Name, Pclass, Fare FROM passengers ORDER BY Fare DESC LIMIT 20;",hints:["Use ORDER BY Fare DESC for highest first","Add LIMIT 20 at the end","Select only the requested columns"],points:15}},{day:6,week:1,title:"LIMIT & OFFSET",description:"Control how many rows to return and pagination",concepts:["LIMIT","OFFSET","Pagination"],lesson:{content:'# LIMIT & OFFSET 📄\n\n## LIMIT - Restrict Results\nGet only a specific number of rows:\n\n```sql\nSELECT * FROM passengers LIMIT 10;\n```\n\n## OFFSET - Skip Rows\nSkip the first N rows:\n\n```sql\nSELECT * FROM passengers LIMIT 10 OFFSET 20;\n```\nThis skips 20 rows, then returns the next 10.\n\n## Pagination Example\nFor a "page" system with 10 items per page:\n\n```sql\n-- Page 1 (rows 1-10)\nSELECT * FROM passengers LIMIT 10 OFFSET 0;\n\n-- Page 2 (rows 11-20)\nSELECT * FROM passengers LIMIT 10 OFFSET 10;\n\n-- Page 3 (rows 21-30)\nSELECT * FROM passengers LIMIT 10 OFFSET 20;\n```\n\n## Practical Use Cases\n- Preview large datasets\n- Build paginated APIs\n- Get "Top N" results with ORDER BY',tips:["LIMIT without OFFSET returns from the beginning","OFFSET formula: (page_number - 1) * items_per_page","Always use ORDER BY with LIMIT for consistent results"]},challenge:{title:"Pagination Practice",description:"Get the **second page** of passengers (rows 11-20) sorted by **PassengerId**. Show 10 results.",dataset:"titanic",solution:"SELECT * FROM passengers ORDER BY PassengerId LIMIT 10 OFFSET 10;",hints:["Page 2 needs OFFSET 10 (skip first 10)","LIMIT 10 for 10 results per page","ORDER BY ensures consistent pagination"],points:15}},{day:7,week:1,title:"Aggregate Functions",description:"Calculate totals, averages, counts, and more",concepts:["COUNT","SUM","AVG","MIN","MAX"],lesson:{content:"# Aggregate Functions 📈\n\nAggregate functions perform calculations across multiple rows.\n\n## COUNT - Count Rows\n```sql\n-- Count all rows\nSELECT COUNT(*) FROM passengers;\n\n-- Count non-null values in a column\nSELECT COUNT(Age) FROM passengers;\n```\n\n## SUM - Total Values\n```sql\nSELECT SUM(Fare) AS total_revenue FROM passengers;\n```\n\n## AVG - Average Value\n```sql\nSELECT AVG(Age) AS average_age FROM passengers;\n```\n\n## MIN & MAX\n```sql\nSELECT MIN(Age) AS youngest,\n       MAX(Age) AS oldest\nFROM passengers;\n```\n\n## Combining Aggregates\n```sql\nSELECT \n    COUNT(*) AS total_passengers,\n    SUM(Survived) AS survivors,\n    AVG(Fare) AS avg_fare,\n    MIN(Age) AS youngest,\n    MAX(Age) AS oldest\nFROM passengers;\n```\n\n## With WHERE\n```sql\nSELECT AVG(Age) FROM passengers WHERE Survived = 1;\n```",tips:["COUNT(*) counts all rows, COUNT(column) skips NULLs","AVG ignores NULL values","Use aliases to make results readable"]},challenge:{title:"Survival Statistics",description:"Calculate the **total passengers**, **number who survived** (SUM of Survived), and **survival rate** (AVG of Survived * 100).",dataset:"titanic",solution:"SELECT COUNT(*) AS total_passengers, SUM(Survived) AS survivors, AVG(Survived) * 100 AS survival_rate FROM passengers;",hints:["COUNT(*) for total passengers","SUM(Survived) since Survived is 0 or 1","AVG(Survived) * 100 gives percentage"],points:20}},{day:8,week:2,title:"GROUP BY Clause",description:"Group rows and calculate aggregates per group",concepts:["GROUP BY","Aggregates per group"],lesson:{content:"# GROUP BY - Grouping Data 📊\n\nGROUP BY lets you calculate aggregates for each group separately.\n\n## Basic GROUP BY\n```sql\nSELECT Pclass, COUNT(*) AS passengers\nFROM passengers\nGROUP BY Pclass;\n```\n\nResult:\n| Pclass | passengers |\n|--------|------------|\n| 1 | 216 |\n| 2 | 184 |\n| 3 | 491 |\n\n## Multiple Aggregates per Group\n```sql\nSELECT Pclass,\n       COUNT(*) AS total,\n       SUM(Survived) AS survived,\n       AVG(Fare) AS avg_fare\nFROM passengers\nGROUP BY Pclass;\n```\n\n## GROUP BY Multiple Columns\n```sql\nSELECT Pclass, Sex, COUNT(*) AS count\nFROM passengers\nGROUP BY Pclass, Sex;\n```\n\n## Important Rule\nEvery column in SELECT must either be:\n1. In the GROUP BY clause, OR\n2. Inside an aggregate function",tips:["GROUP BY creates 'buckets' of rows","Each group returns exactly one row in results","Column order in GROUP BY can affect results"]},challenge:{title:"Survival by Class",description:"Calculate the **survival rate** (AVG of Survived * 100) for each **passenger class** (Pclass). Order by class.",dataset:"titanic",solution:"SELECT Pclass, AVG(Survived) * 100 AS survival_rate FROM passengers GROUP BY Pclass ORDER BY Pclass;",hints:["GROUP BY Pclass","AVG(Survived) * 100 for percentage","ORDER BY Pclass at the end"],points:20}},{day:9,week:2,title:"HAVING Clause",description:"Filter groups after aggregation",concepts:["HAVING","WHERE vs HAVING"],lesson:{content:"# HAVING - Filter Groups 🔍\n\nHAVING filters groups AFTER aggregation (WHERE filters rows BEFORE).\n\n## WHERE vs HAVING\n\n```sql\n-- WHERE: Filter rows before grouping\nSELECT Pclass, COUNT(*) \nFROM passengers\nWHERE Age > 30\nGROUP BY Pclass;\n\n-- HAVING: Filter groups after aggregation\nSELECT Pclass, COUNT(*) AS count\nFROM passengers\nGROUP BY Pclass\nHAVING COUNT(*) > 100;\n```\n\n## Using Both Together\n```sql\nSELECT Embarked, COUNT(*) AS passengers\nFROM passengers\nWHERE Survived = 1          -- Filter rows first\nGROUP BY Embarked\nHAVING COUNT(*) > 50;       -- Then filter groups\n```\n\n## HAVING with Aggregates\n```sql\nSELECT Pclass, AVG(Fare) AS avg_fare\nFROM passengers\nGROUP BY Pclass\nHAVING AVG(Fare) > 50;\n```\n\n## Order of Execution\n1. FROM → 2. WHERE → 3. GROUP BY → 4. HAVING → 5. SELECT → 6. ORDER BY",tips:["HAVING requires GROUP BY","Use WHERE for row-level filters","Use HAVING for aggregate-level filters"]},challenge:{title:"Popular Embarkation Points",description:"Find embarkation points (**Embarked**) with more than **200 passengers**. Show the port and count.",dataset:"titanic",solution:"SELECT Embarked, COUNT(*) AS passenger_count FROM passengers GROUP BY Embarked HAVING COUNT(*) > 200;",hints:["GROUP BY Embarked","Use HAVING COUNT(*) > 200","Not WHERE - we're filtering on aggregate"],points:20}},{day:10,week:2,title:"JOINs - INNER, LEFT, RIGHT",description:"Combine data from multiple tables",concepts:["INNER JOIN","LEFT JOIN","RIGHT JOIN"],lesson:{content:"# JOINs - Combining Tables 🔗\n\nJOINs let you combine rows from two or more tables based on related columns.\n\n## INNER JOIN\nReturns only matching rows from both tables:\n\n```sql\nSELECT e.name, d.department_name\nFROM employees e\nINNER JOIN departments d ON e.dept_id = d.id;\n```\n\n## LEFT JOIN\nReturns all rows from left table, with matches from right (NULL if no match):\n\n```sql\nSELECT e.name, d.department_name\nFROM employees e\nLEFT JOIN departments d ON e.dept_id = d.id;\n```\n\n## RIGHT JOIN\nReturns all rows from right table, with matches from left:\n\n```sql\nSELECT e.name, d.department_name\nFROM employees e\nRIGHT JOIN departments d ON e.dept_id = d.id;\n```\n\n## Visual Representation\n```\nINNER: Only intersection\nLEFT:  All left + matching right\nRIGHT: All right + matching left\n```",tips:["Use table aliases (e, d) for cleaner queries","INNER JOIN is the most common type","LEFT JOIN is great for finding 'missing' relationships"]},challenge:{title:"Join Practice",description:"Using the **ecommerce** dataset, join **orders** with **customers** to show customer **name** and their **order_total**. Use INNER JOIN.",dataset:"ecommerce",solution:"SELECT c.name, o.order_total FROM orders o INNER JOIN customers c ON o.customer_id = c.id;",hints:["Join ON orders.customer_id = customers.id","Use table aliases for cleaner code","Select name from customers, order_total from orders"],points:25}},{day:11,week:2,title:"Subqueries",description:"Nest queries inside other queries",concepts:["Subqueries","IN","EXISTS"],lesson:{content:"# Subqueries - Queries within Queries 🎭\n\nA subquery is a query nested inside another query.\n\n## Subquery in WHERE\n```sql\nSELECT * FROM passengers\nWHERE Fare > (SELECT AVG(Fare) FROM passengers);\n```\n\n## Subquery with IN\n```sql\nSELECT * FROM passengers\nWHERE Pclass IN (SELECT Pclass FROM passengers WHERE Survived = 1);\n```\n\n## Subquery in FROM (Derived Table)\n```sql\nSELECT avg_by_class.Pclass, avg_by_class.avg_fare\nFROM (\n    SELECT Pclass, AVG(Fare) AS avg_fare\n    FROM passengers\n    GROUP BY Pclass\n) AS avg_by_class\nWHERE avg_by_class.avg_fare > 30;\n```\n\n## Correlated Subquery\nReferences the outer query:\n```sql\nSELECT p1.Name, p1.Fare\nFROM passengers p1\nWHERE p1.Fare > (\n    SELECT AVG(p2.Fare)\n    FROM passengers p2\n    WHERE p2.Pclass = p1.Pclass\n);\n```",tips:["Subqueries must be enclosed in parentheses","Use aliases for derived tables","Correlated subqueries run once per outer row"]},challenge:{title:"Above Average Fares",description:"Find all passengers who paid **more than the average fare**. Show Name, Fare, and Pclass.",dataset:"titanic",solution:"SELECT Name, Fare, Pclass FROM passengers WHERE Fare > (SELECT AVG(Fare) FROM passengers);",hints:["Use a subquery to calculate AVG(Fare)","Compare each row's Fare to this average","The subquery goes in the WHERE clause"],points:25}},{day:12,week:2,title:"CASE Statements",description:"Add conditional logic to your queries",concepts:["CASE WHEN","Conditional logic"],lesson:{content:"# CASE - Conditional Logic 🔀\n\nCASE adds if-then-else logic to SQL queries.\n\n## Simple CASE\n```sql\nSELECT Name,\n       CASE Pclass\n           WHEN 1 THEN 'First Class'\n           WHEN 2 THEN 'Second Class'\n           WHEN 3 THEN 'Third Class'\n       END AS class_name\nFROM passengers;\n```\n\n## Searched CASE (with conditions)\n```sql\nSELECT Name, Age,\n       CASE\n           WHEN Age < 18 THEN 'Minor'\n           WHEN Age < 65 THEN 'Adult'\n           ELSE 'Senior'\n       END AS age_group\nFROM passengers;\n```\n\n## CASE in Aggregations\n```sql\nSELECT \n    SUM(CASE WHEN Survived = 1 THEN 1 ELSE 0 END) AS survivors,\n    SUM(CASE WHEN Survived = 0 THEN 1 ELSE 0 END) AS casualties\nFROM passengers;\n```\n\n## CASE for Pivoting\n```sql\nSELECT Pclass,\n    SUM(CASE WHEN Sex = 'male' THEN 1 ELSE 0 END) AS males,\n    SUM(CASE WHEN Sex = 'female' THEN 1 ELSE 0 END) AS females\nFROM passengers\nGROUP BY Pclass;\n```",tips:["Always include END to close CASE","ELSE is optional but recommended","CASE can be used in SELECT, WHERE, ORDER BY"]},challenge:{title:"Age Categories",description:"Create age categories: 'Child' (Age < 18), 'Adult' (18-59), 'Senior' (60+). Count passengers in each category.",dataset:"titanic",solution:"SELECT CASE WHEN Age < 18 THEN 'Child' WHEN Age < 60 THEN 'Adult' ELSE 'Senior' END AS age_group, COUNT(*) AS count FROM passengers WHERE Age IS NOT NULL GROUP BY age_group;",hints:["Use CASE WHEN for conditions","GROUP BY the CASE expression","Filter out NULL ages with WHERE"],points:25}},{day:13,week:2,title:"Self-Joins",description:"Join a table to itself",concepts:["Self-Join","Table aliases"],lesson:{content:"# Self-Joins 🔄\n\nA self-join joins a table to itself - useful for hierarchical or comparative data.\n\n## Employee-Manager Example\n```sql\nSELECT e.name AS employee,\n       m.name AS manager\nFROM employees e\nLEFT JOIN employees m ON e.manager_id = m.id;\n```\n\n## Finding Pairs\nFind passengers with the same fare:\n```sql\nSELECT p1.Name AS passenger1,\n       p2.Name AS passenger2,\n       p1.Fare\nFROM passengers p1\nJOIN passengers p2 ON p1.Fare = p2.Fare\nWHERE p1.PassengerId < p2.PassengerId;\n```\n\n## Comparing Rows\nFind passengers older than average of their class:\n```sql\nSELECT p1.Name, p1.Age, p1.Pclass\nFROM passengers p1\nJOIN (\n    SELECT Pclass, AVG(Age) as avg_age\n    FROM passengers\n    GROUP BY Pclass\n) p2 ON p1.Pclass = p2.Pclass\nWHERE p1.Age > p2.avg_age;\n```",tips:["Always use different aliases for each 'copy' of the table","Use inequality (< or >) to avoid duplicate pairs","Self-joins are powerful for hierarchical data"]},challenge:{title:"Fare Twins",description:"Find pairs of passengers with the **exact same Fare**. Show both names and the fare. Avoid duplicates (passenger1 ID < passenger2 ID).",dataset:"titanic",solution:"SELECT p1.Name AS passenger1, p2.Name AS passenger2, p1.Fare FROM passengers p1 JOIN passengers p2 ON p1.Fare = p2.Fare AND p1.PassengerId < p2.PassengerId WHERE p1.Fare > 0;",hints:["Join passengers to itself","Match on Fare equality","Use PassengerId < to avoid duplicates"],points:25}},{day:14,week:2,title:"UNION & UNION ALL",description:"Combine results from multiple queries",concepts:["UNION","UNION ALL","Set operations"],lesson:{content:"# UNION - Combining Results 📋\n\nUNION combines the results of two or more SELECT statements.\n\n## UNION (removes duplicates)\n```sql\nSELECT Name FROM passengers WHERE Pclass = 1\nUNION\nSELECT Name FROM passengers WHERE Survived = 1;\n```\n\n## UNION ALL (keeps duplicates)\n```sql\nSELECT Name FROM passengers WHERE Pclass = 1\nUNION ALL\nSELECT Name FROM passengers WHERE Survived = 1;\n```\n\n## Rules for UNION\n1. Same number of columns in each SELECT\n2. Compatible data types\n3. Column names come from first SELECT\n\n## Practical Example\n```sql\nSELECT 'Survivor' AS status, Name, Age\nFROM passengers WHERE Survived = 1\nUNION ALL\nSELECT 'Casualty' AS status, Name, Age\nFROM passengers WHERE Survived = 0;\n```\n\n## Other Set Operations\n- INTERSECT: Only rows in both results\n- EXCEPT: Rows in first but not second",tips:["UNION is slower than UNION ALL (checks for duplicates)","Use UNION ALL when you know there are no duplicates","ORDER BY applies to the final combined result"]},challenge:{title:"Combined Lists",description:"Create a list showing all passengers from **first class** OR who **paid more than $100**. Use UNION to combine and remove duplicates. Show Name and Fare.",dataset:"titanic",solution:"SELECT Name, Fare FROM passengers WHERE Pclass = 1 UNION SELECT Name, Fare FROM passengers WHERE Fare > 100;",hints:["First SELECT: WHERE Pclass = 1","Second SELECT: WHERE Fare > 100","UNION removes duplicates automatically"],points:20}},{day:15,week:3,title:"Understanding Indexes",description:"Learn how indexes speed up queries",concepts:["Indexes","Performance","CREATE INDEX"],lesson:{content:"# Indexes - Speed Up Your Queries ⚡\n\n## What is an Index?\nAn index is like a book's index - it helps find data without scanning every row.\n\n## Creating an Index\n```sql\nCREATE INDEX idx_passengers_age ON passengers(Age);\n```\n\n## Composite Index (multiple columns)\n```sql\nCREATE INDEX idx_class_survived ON passengers(Pclass, Survived);\n```\n\n## When Indexes Help\n- WHERE clause filters\n- JOIN conditions\n- ORDER BY columns\n- GROUP BY columns\n\n## When Indexes Don't Help\n- Small tables\n- Columns with few unique values\n- Queries returning most rows\n\n## Trade-offs\n✅ Faster reads\n❌ Slower writes (INSERT, UPDATE, DELETE)\n❌ Uses storage space",tips:["Index columns you frequently filter or sort by","Don't over-index - each index has overhead","Composite indexes work left-to-right"]},challenge:{title:"Index Analysis",description:"Which columns would benefit most from an index in a query that filters by **Pclass** and sorts by **Fare**? Write a query using these columns.",dataset:"titanic",solution:"SELECT Name, Pclass, Fare FROM passengers WHERE Pclass = 1 ORDER BY Fare DESC;",hints:["Pclass in WHERE would benefit from index","Fare in ORDER BY would also benefit","A composite index (Pclass, Fare) would be ideal"],points:20}},{day:16,week:3,title:"Working with Views",description:"Create virtual tables for reusable queries",concepts:["CREATE VIEW","Virtual tables","Abstraction"],lesson:{content:"# Views - Reusable Query Shortcuts 👁️\n\nA view is a saved query that acts like a virtual table.\n\n## Creating a View\n```sql\nCREATE VIEW survivors AS\nSELECT * FROM passengers WHERE Survived = 1;\n```\n\n## Using a View\n```sql\nSELECT * FROM survivors WHERE Pclass = 1;\n```\n\n## Complex View Example\n```sql\nCREATE VIEW passenger_summary AS\nSELECT \n    Pclass,\n    Sex,\n    COUNT(*) AS total,\n    SUM(Survived) AS survived,\n    ROUND(AVG(Survived) * 100, 1) AS survival_rate\nFROM passengers\nGROUP BY Pclass, Sex;\n```\n\n## Benefits of Views\n- Simplify complex queries\n- Provide data abstraction\n- Security (hide sensitive columns)\n- Consistent calculations\n\n## Dropping a View\n```sql\nDROP VIEW IF EXISTS survivors;\n```",tips:["Views don't store data - they run the query each time","Views can join multiple tables","Use views to simplify reporting queries"]},challenge:{title:"Create a Summary View",description:"Create a query that could be a view: Show **survival stats by class and gender** (Pclass, Sex, total, survived, survival_rate).",dataset:"titanic",solution:"SELECT Pclass, Sex, COUNT(*) AS total, SUM(Survived) AS survived, ROUND(AVG(Survived) * 100, 1) AS survival_rate FROM passengers GROUP BY Pclass, Sex ORDER BY Pclass, Sex;",hints:["GROUP BY Pclass, Sex","COUNT(*) for total","AVG(Survived) * 100 for percentage"],points:25}},{day:17,week:3,title:"Transaction Management",description:"Ensure data integrity with transactions",concepts:["BEGIN","COMMIT","ROLLBACK","ACID"],lesson:{content:"# Transactions - All or Nothing 🔐\n\nTransactions group multiple operations into a single unit that either completely succeeds or completely fails.\n\n## Basic Transaction\n```sql\nBEGIN TRANSACTION;\n    UPDATE accounts SET balance = balance - 100 WHERE id = 1;\n    UPDATE accounts SET balance = balance + 100 WHERE id = 2;\nCOMMIT;\n```\n\n## Rollback on Error\n```sql\nBEGIN TRANSACTION;\n    UPDATE accounts SET balance = balance - 100 WHERE id = 1;\n    -- If something goes wrong:\nROLLBACK;\n```\n\n## ACID Properties\n- **A**tomicity: All or nothing\n- **C**onsistency: Data stays valid\n- **I**solation: Transactions don't interfere\n- **D**urability: Committed changes persist\n\n## Savepoints\n```sql\nBEGIN TRANSACTION;\n    UPDATE table1 SET col1 = 'value1';\n    SAVEPOINT sp1;\n    UPDATE table2 SET col2 = 'value2';\n    -- Oops, rollback just the second update\n    ROLLBACK TO sp1;\nCOMMIT;\n```",tips:["Always COMMIT or ROLLBACK to end a transaction","Use transactions for multi-step operations","Transactions prevent partial updates"]},challenge:{title:"Transaction Concepts",description:"Write a query that shows the total fare collected by class, simulating a 'report' that might be part of a transaction.",dataset:"titanic",solution:"SELECT Pclass, SUM(Fare) AS total_fare, COUNT(*) AS passengers FROM passengers GROUP BY Pclass ORDER BY Pclass;",hints:["GROUP BY Pclass","SUM(Fare) for total fare","This type of aggregation might be in a reporting transaction"],points:20}},{day:18,week:3,title:"Stored Procedures",description:"Create reusable SQL programs",concepts:["Procedures","Parameters","Reusability"],lesson:{content:"# Stored Procedures 📦\n\nStored procedures are saved SQL code that can be executed repeatedly.\n\n## Creating a Procedure (varies by database)\n```sql\n-- MySQL/PostgreSQL style\nCREATE PROCEDURE GetSurvivorsByClass(IN class_num INT)\nBEGIN\n    SELECT * FROM passengers \n    WHERE Pclass = class_num AND Survived = 1;\nEND;\n```\n\n## Benefits\n- Reusable code\n- Reduced network traffic\n- Better security\n- Encapsulation of business logic\n\n## SQLite Alternative\nSQLite doesn't support stored procedures, but you can:\n1. Use Views for reusable queries\n2. Use application code for complex logic\n3. Use triggers for automated actions\n\n## Simulating with Views\n```sql\n-- Create parameterized-like views\nCREATE VIEW first_class_survivors AS\nSELECT * FROM passengers WHERE Pclass = 1 AND Survived = 1;\n\nCREATE VIEW second_class_survivors AS\nSELECT * FROM passengers WHERE Pclass = 2 AND Survived = 1;\n```",tips:["Stored procedures reduce code duplication","They can accept input parameters","Great for complex, repeated operations"]},challenge:{title:"Reusable Query Design",description:"Design a query that could be a stored procedure: Find survivors from a specific class with their details. Use Pclass = 1 as example.",dataset:"titanic",solution:"SELECT PassengerId, Name, Sex, Age, Fare FROM passengers WHERE Pclass = 1 AND Survived = 1 ORDER BY Fare DESC;",hints:["Filter by Pclass and Survived","Select relevant columns","This pattern could accept Pclass as parameter"],points:20}},{day:19,week:3,title:"Triggers",description:"Automate actions on data changes",concepts:["CREATE TRIGGER","BEFORE/AFTER","Automation"],lesson:{content:"# Triggers - Automatic Actions 🎯\n\nTriggers automatically execute code when data changes.\n\n## Trigger Types\n- BEFORE INSERT/UPDATE/DELETE\n- AFTER INSERT/UPDATE/DELETE\n\n## Example Trigger\n```sql\nCREATE TRIGGER log_fare_changes\nAFTER UPDATE ON passengers\nWHEN OLD.Fare != NEW.Fare\nBEGIN\n    INSERT INTO fare_log (passenger_id, old_fare, new_fare, changed_at)\n    VALUES (NEW.PassengerId, OLD.Fare, NEW.Fare, datetime('now'));\nEND;\n```\n\n## Use Cases\n- Audit logging\n- Automatic calculations\n- Data validation\n- Cascading updates\n\n## Special Values\n- NEW: The new row data\n- OLD: The previous row data\n\n## Caution\n- Triggers add hidden complexity\n- Can impact performance\n- Difficult to debug",tips:["Use triggers sparingly","Document all triggers thoroughly","Test trigger behavior carefully"]},challenge:{title:"Audit Query Design",description:"Write a query that shows what an audit log might track: Compare fare statistics before and after a hypothetical 10% increase.",dataset:"titanic",solution:"SELECT Pclass, AVG(Fare) AS current_avg_fare, AVG(Fare) * 1.1 AS projected_avg_fare, SUM(Fare) AS current_total, SUM(Fare) * 1.1 AS projected_total FROM passengers GROUP BY Pclass;",hints:["Show current and projected values","Multiply by 1.1 for 10% increase","GROUP BY class for comparison"],points:25}},{day:20,week:3,title:"Database Normalization",description:"Design efficient database structures",concepts:["1NF","2NF","3NF","Normalization"],lesson:{content:'# Database Normalization 📐\n\nNormalization organizes data to reduce redundancy and improve integrity.\n\n## First Normal Form (1NF)\n- Each cell contains a single value\n- Each row is unique\n- No repeating groups\n\n❌ Bad: "John, Jane" in one cell\n✅ Good: Separate rows for John and Jane\n\n## Second Normal Form (2NF)\n- Must be in 1NF\n- All non-key columns depend on the entire primary key\n\n❌ Bad: Order table with customer_name\n✅ Good: Separate customers table, link by customer_id\n\n## Third Normal Form (3NF)\n- Must be in 2NF\n- No transitive dependencies\n\n❌ Bad: employee table with dept_name\n✅ Good: departments table linked by dept_id\n\n## Trade-offs\n- Normalized: Less redundancy, more joins\n- Denormalized: Fewer joins, some redundancy',tips:["Normalize for transaction systems (OLTP)","Denormalize for analytics (OLAP)","Balance between joins and redundancy"]},challenge:{title:"Data Structure Analysis",description:"The Titanic data has denormalized passenger info. Count how many passengers paid the same fare (possible group bookings).",dataset:"titanic",solution:"SELECT fare, COUNT(*) AS passengers FROM passengers WHERE fare > 0 GROUP BY fare HAVING COUNT(*) > 1 ORDER BY passengers DESC LIMIT 10;",hints:["GROUP BY fare","Filter out zero fares","HAVING COUNT(*) > 1 for shared fares"],points:25}},{day:21,week:3,title:"ACID Properties",description:"Understand database reliability guarantees",concepts:["Atomicity","Consistency","Isolation","Durability"],lesson:{content:"# ACID Properties 🛡️\n\nACID ensures reliable database transactions.\n\n## Atomicity\nAll operations complete, or none do.\n```sql\n-- Transfer $100: both must succeed or both fail\nBEGIN;\nUPDATE accounts SET balance = balance - 100 WHERE id = 1;\nUPDATE accounts SET balance = balance + 100 WHERE id = 2;\nCOMMIT;\n```\n\n## Consistency\nDatabase moves from one valid state to another.\n- Constraints are enforced\n- Data integrity maintained\n\n## Isolation\nConcurrent transactions don't interfere.\n\nIsolation Levels:\n1. READ UNCOMMITTED (lowest)\n2. READ COMMITTED\n3. REPEATABLE READ\n4. SERIALIZABLE (highest)\n\n## Durability\nCommitted transactions survive system failures.\n- Write-ahead logging\n- Data persistence\n\n## Why ACID Matters\n- Financial transactions\n- Inventory management\n- User account operations",tips:["Higher isolation = less concurrency","Choose isolation level based on needs","ACID is critical for data integrity"]},challenge:{title:"Consistency Check",description:"Write a query to verify data consistency: Check that all Survived values are either 0 or 1 (no other values).",dataset:"titanic",solution:"SELECT Survived, COUNT(*) AS count FROM passengers GROUP BY Survived ORDER BY Survived;",hints:["GROUP BY Survived to see all values","Should only show 0 and 1","This validates data consistency"],points:20}},{day:22,week:4,title:"Date Functions",description:"Work with dates and times in SQL",concepts:["DATE","DATETIME","Date arithmetic"],lesson:{content:"# Date Functions 📅\n\n## Current Date/Time\n```sql\nSELECT date('now');           -- 2024-01-15\nSELECT datetime('now');       -- 2024-01-15 14:30:00\nSELECT time('now');           -- 14:30:00\n```\n\n## Date Arithmetic\n```sql\nSELECT date('now', '+7 days');      -- 7 days from now\nSELECT date('now', '-1 month');     -- 1 month ago\nSELECT date('now', 'start of year'); -- Jan 1 of current year\n```\n\n## Extracting Parts\n```sql\nSELECT strftime('%Y', date_column) AS year,\n       strftime('%m', date_column) AS month,\n       strftime('%d', date_column) AS day\nFROM table_name;\n```\n\n## Date Formatting\n```sql\nSELECT strftime('%Y-%m-%d', datetime_column) AS formatted_date;\nSELECT strftime('%H:%M', datetime_column) AS time_only;\n```\n\n## Date Comparisons\n```sql\nSELECT * FROM orders \nWHERE order_date >= date('now', '-30 days');\n```",tips:["SQLite stores dates as TEXT in ISO format","Use strftime for formatting","Always use consistent date formats"]},challenge:{title:"Date Analysis",description:"Using **ecommerce** dataset, find orders from the last 30 days (use date comparison with order_date).",dataset:"ecommerce",solution:"SELECT * FROM orders WHERE order_date >= date('now', '-30 days') ORDER BY order_date DESC;",hints:["Use date('now', '-30 days')","Compare with order_date","ORDER BY date descending for recent first"],points:25}},{day:23,week:4,title:"String Functions",description:"Manipulate text data effectively",concepts:["UPPER","LOWER","SUBSTR","TRIM","REPLACE"],lesson:{content:"# String Functions 📝\n\n## Case Conversion\n```sql\nSELECT UPPER(Name) AS upper_name,\n       LOWER(Name) AS lower_name\nFROM passengers;\n```\n\n## Substring\n```sql\nSELECT SUBSTR(Name, 1, 10) AS first_10_chars\nFROM passengers;\n```\n\n## Length\n```sql\nSELECT Name, LENGTH(Name) AS name_length\nFROM passengers;\n```\n\n## Trim Whitespace\n```sql\nSELECT TRIM('  hello  ');     -- 'hello'\nSELECT LTRIM('  hello');      -- 'hello'\nSELECT RTRIM('hello  ');      -- 'hello'\n```\n\n## Replace\n```sql\nSELECT REPLACE(Name, 'Mr.', 'Mister')\nFROM passengers;\n```\n\n## Concatenation\n```sql\nSELECT Name || ' - Class ' || Pclass AS passenger_info\nFROM passengers;\n```\n\n## Pattern Matching (LIKE)\n```sql\nSELECT * FROM passengers WHERE Name LIKE '%Smith%';\nSELECT * FROM passengers WHERE Name LIKE 'A%';\n```",tips:["LIKE: % matches any characters, _ matches one character","String functions are case-sensitive","Use || for concatenation in SQLite"]},challenge:{title:"Extract Titles",description:"Extract passenger titles (Mr., Mrs., Miss., Master) from names. Count how many of each title exist.",dataset:"titanic",solution:"SELECT CASE WHEN Name LIKE '%Mr.%' THEN 'Mr.' WHEN Name LIKE '%Mrs.%' THEN 'Mrs.' WHEN Name LIKE '%Miss.%' THEN 'Miss.' WHEN Name LIKE '%Master.%' THEN 'Master' ELSE 'Other' END AS title, COUNT(*) AS count FROM passengers GROUP BY title ORDER BY count DESC;",hints:["Use LIKE for pattern matching","CASE WHEN to categorize","GROUP BY the extracted title"],points:30}},{day:24,week:4,title:"Math Functions",description:"Perform calculations in SQL",concepts:["ROUND","ABS","CEIL","FLOOR","MOD"],lesson:{content:"# Math Functions 🔢\n\n## Rounding\n```sql\nSELECT ROUND(3.14159, 2);     -- 3.14\nSELECT ROUND(Fare, 0) FROM passengers;\n```\n\n## Absolute Value\n```sql\nSELECT ABS(-42);              -- 42\n```\n\n## Min/Max per Row\n```sql\nSELECT MAX(Age, Fare) AS greater_value\nFROM passengers;\n```\n\n## Modulo (Remainder)\n```sql\nSELECT PassengerId, PassengerId % 10 AS last_digit\nFROM passengers;\n```\n\n## Practical Calculations\n```sql\nSELECT \n    Fare,\n    ROUND(Fare * 1.1, 2) AS fare_plus_10_percent,\n    ROUND(Fare / 100, 2) AS fare_in_hundreds\nFROM passengers;\n```\n\n## Statistical Calculations\n```sql\nSELECT \n    AVG(Fare) AS mean_fare,\n    MIN(Fare) AS min_fare,\n    MAX(Fare) AS max_fare,\n    MAX(Fare) - MIN(Fare) AS fare_range\nFROM passengers;\n```",tips:["ROUND(value, decimals) rounds to specified places","Division by integers truncates - use 1.0 for decimals","Combine math with aggregates for statistics"]},challenge:{title:"Fare Statistics",description:"Calculate fare statistics by class: average, min, max, and range (max - min). Round to 2 decimal places.",dataset:"titanic",solution:"SELECT Pclass, ROUND(AVG(Fare), 2) AS avg_fare, ROUND(MIN(Fare), 2) AS min_fare, ROUND(MAX(Fare), 2) AS max_fare, ROUND(MAX(Fare) - MIN(Fare), 2) AS fare_range FROM passengers GROUP BY Pclass ORDER BY Pclass;",hints:["GROUP BY Pclass","Use ROUND(..., 2) for all values","Range = MAX - MIN"],points:25}},{day:25,week:4,title:"Window Functions",description:"Perform calculations across row sets",concepts:["OVER","PARTITION BY","ROW_NUMBER","RANK"],lesson:{content:"# Window Functions 🪟\n\nWindow functions perform calculations across a set of rows related to the current row.\n\n## ROW_NUMBER\n```sql\nSELECT Name, Fare,\n       ROW_NUMBER() OVER (ORDER BY Fare DESC) AS fare_rank\nFROM passengers;\n```\n\n## PARTITION BY\nSeparate windows for each group:\n```sql\nSELECT Name, Pclass, Fare,\n       ROW_NUMBER() OVER (PARTITION BY Pclass ORDER BY Fare DESC) AS rank_in_class\nFROM passengers;\n```\n\n## RANK and DENSE_RANK\n```sql\nSELECT Name, Fare,\n       RANK() OVER (ORDER BY Fare DESC) AS rank,\n       DENSE_RANK() OVER (ORDER BY Fare DESC) AS dense_rank\nFROM passengers;\n```\n\n## Running Totals\n```sql\nSELECT Name, Fare,\n       SUM(Fare) OVER (ORDER BY PassengerId) AS running_total\nFROM passengers;\n```\n\n## Moving Averages\n```sql\nSELECT Name, Fare,\n       AVG(Fare) OVER (ORDER BY PassengerId \n                       ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS moving_avg\nFROM passengers;\n```",tips:["Window functions don't collapse rows like GROUP BY","PARTITION BY creates separate 'windows'","ORDER BY within OVER determines row ordering"]},challenge:{title:"Rank Within Class",description:"Rank passengers by fare within each class. Show Name, Pclass, Fare, and rank_in_class.",dataset:"titanic",solution:"SELECT Name, Pclass, Fare, RANK() OVER (PARTITION BY Pclass ORDER BY Fare DESC) AS rank_in_class FROM passengers WHERE Fare > 0;",hints:["Use RANK() or ROW_NUMBER()","PARTITION BY Pclass","ORDER BY Fare DESC for highest first"],points:30}},{day:26,week:4,title:"Common Table Expressions (CTEs)",description:"Write cleaner, more readable queries",concepts:["WITH clause","CTEs","Recursive CTEs"],lesson:{content:"# CTEs - Common Table Expressions 📋\n\nCTEs create temporary named result sets for cleaner queries.\n\n## Basic CTE\n```sql\nWITH survivors AS (\n    SELECT * FROM passengers WHERE Survived = 1\n)\nSELECT Pclass, COUNT(*) AS survivor_count\nFROM survivors\nGROUP BY Pclass;\n```\n\n## Multiple CTEs\n```sql\nWITH \nsurvivors AS (\n    SELECT * FROM passengers WHERE Survived = 1\n),\nclass_stats AS (\n    SELECT Pclass, AVG(Age) AS avg_age\n    FROM survivors\n    GROUP BY Pclass\n)\nSELECT * FROM class_stats;\n```\n\n## CTE vs Subquery\n```sql\n-- CTE (more readable)\nWITH high_fare AS (\n    SELECT * FROM passengers WHERE Fare > 100\n)\nSELECT * FROM high_fare WHERE Age > 50;\n\n-- Equivalent subquery (harder to read)\nSELECT * FROM (\n    SELECT * FROM passengers WHERE Fare > 100\n) WHERE Age > 50;\n```\n\n## Benefits\n- Improved readability\n- Reusable within the query\n- Self-referencing (recursive)",tips:["CTEs make complex queries more readable","Each CTE can reference previous ones","Great for breaking down complex logic"]},challenge:{title:"CTE Analysis",description:"Use a CTE to find: First, passengers who paid above-average fare, then calculate survival rate for this group.",dataset:"titanic",solution:"WITH high_fare_passengers AS (SELECT * FROM passengers WHERE Fare > (SELECT AVG(Fare) FROM passengers)) SELECT COUNT(*) AS total, SUM(Survived) AS survived, ROUND(AVG(Survived) * 100, 1) AS survival_rate FROM high_fare_passengers;",hints:["First CTE: passengers with Fare > AVG(Fare)","Main query: aggregate stats from the CTE","Calculate survival rate as AVG(Survived) * 100"],points:30}},{day:27,week:4,title:"Analytic Functions",description:"Advanced analytics with SQL",concepts:["LAG","LEAD","FIRST_VALUE","LAST_VALUE"],lesson:{content:"# Analytic Functions 📊\n\nAccess data from other rows without self-joins.\n\n## LAG - Previous Row\n```sql\nSELECT Name, Fare,\n       LAG(Fare) OVER (ORDER BY PassengerId) AS prev_fare,\n       Fare - LAG(Fare) OVER (ORDER BY PassengerId) AS fare_diff\nFROM passengers;\n```\n\n## LEAD - Next Row\n```sql\nSELECT Name, Fare,\n       LEAD(Fare) OVER (ORDER BY PassengerId) AS next_fare\nFROM passengers;\n```\n\n## FIRST_VALUE / LAST_VALUE\n```sql\nSELECT Name, Pclass, Fare,\n       FIRST_VALUE(Name) OVER (PARTITION BY Pclass ORDER BY Fare DESC) AS highest_fare_passenger\nFROM passengers;\n```\n\n## NTH_VALUE\n```sql\nSELECT Name, Fare,\n       NTH_VALUE(Name, 3) OVER (ORDER BY Fare DESC) AS third_highest\nFROM passengers;\n```\n\n## Practical Use Cases\n- Compare to previous period\n- Calculate differences\n- Find first/last in group",tips:["LAG/LEAD accept optional offset and default parameters","FIRST_VALUE is useful for 'best in class' queries","Combine with PARTITION BY for group-level analysis"]},challenge:{title:"Fare Comparison",description:"For each passenger, show their fare and the fare of the next more expensive ticket (using LEAD).",dataset:"titanic",solution:"SELECT Name, Fare, LEAD(Fare) OVER (ORDER BY Fare) AS next_higher_fare, LEAD(Fare) OVER (ORDER BY Fare) - Fare AS fare_gap FROM passengers WHERE Fare > 0 ORDER BY Fare;",hints:["Use LEAD with ORDER BY Fare","Calculate the gap as next - current","Filter out zero fares"],points:30}},{day:28,week:4,title:"Pivot & Unpivot",description:"Transform data between rows and columns",concepts:["PIVOT","UNPIVOT","Cross-tabulation"],lesson:{content:"# Pivot & Unpivot 🔄\n\nTransform between row and column layouts.\n\n## Manual Pivot with CASE\n```sql\nSELECT \n    Pclass,\n    SUM(CASE WHEN Survived = 1 THEN 1 ELSE 0 END) AS survived,\n    SUM(CASE WHEN Survived = 0 THEN 1 ELSE 0 END) AS died\nFROM passengers\nGROUP BY Pclass;\n```\n\n## Gender by Class Pivot\n```sql\nSELECT \n    Pclass,\n    SUM(CASE WHEN Sex = 'male' THEN 1 ELSE 0 END) AS male,\n    SUM(CASE WHEN Sex = 'female' THEN 1 ELSE 0 END) AS female\nFROM passengers\nGROUP BY Pclass;\n```\n\n## Cross-Tabulation\n```sql\nSELECT \n    CASE WHEN Age < 18 THEN 'Child' ELSE 'Adult' END AS age_group,\n    SUM(CASE WHEN Survived = 1 THEN 1 ELSE 0 END) AS survived,\n    SUM(CASE WHEN Survived = 0 THEN 1 ELSE 0 END) AS died\nFROM passengers\nWHERE Age IS NOT NULL\nGROUP BY age_group;\n```\n\n## Why Pivot?\n- Create reports\n- Compare categories side-by-side\n- Prepare data for visualization",tips:["SQLite doesn't have native PIVOT - use CASE","Pivoting is great for creating dashboards","Unpivot normalizes wide tables"]},challenge:{title:"Survival Cross-Tab",description:"Create a pivot table showing survival counts by **Pclass (rows)** and **Sex (columns)**.",dataset:"titanic",solution:"SELECT Pclass, SUM(CASE WHEN Sex = 'male' AND Survived = 1 THEN 1 ELSE 0 END) AS male_survived, SUM(CASE WHEN Sex = 'male' AND Survived = 0 THEN 1 ELSE 0 END) AS male_died, SUM(CASE WHEN Sex = 'female' AND Survived = 1 THEN 1 ELSE 0 END) AS female_survived, SUM(CASE WHEN Sex = 'female' AND Survived = 0 THEN 1 ELSE 0 END) AS female_died FROM passengers GROUP BY Pclass ORDER BY Pclass;",hints:["Use CASE WHEN with AND for combinations","Four columns: male_survived, male_died, female_survived, female_died","GROUP BY Pclass"],points:35}},{day:29,week:5,title:"Index Optimization",description:"Optimize queries with proper indexing",concepts:["Index strategies","Query optimization","EXPLAIN"],lesson:{content:"# Index Optimization ⚡\n\n## Query Execution Plans\nSee how a query runs:\n```sql\nEXPLAIN QUERY PLAN\nSELECT * FROM passengers WHERE Age > 30;\n```\n\n## Index Strategies\n\n### Single-Column Index\n```sql\nCREATE INDEX idx_age ON passengers(Age);\n-- Good for: WHERE Age > 30\n```\n\n### Composite Index\n```sql\nCREATE INDEX idx_class_age ON passengers(Pclass, Age);\n-- Good for: WHERE Pclass = 1 AND Age > 30\n-- Also works for: WHERE Pclass = 1\n-- Doesn't help: WHERE Age > 30 (not leftmost)\n```\n\n### Covering Index\nInclude all columns needed:\n```sql\nCREATE INDEX idx_covering ON passengers(Pclass, Age, Name);\n-- Query can use index without touching table\n```\n\n## What Prevents Index Use\n- Functions on indexed column: WHERE UPPER(Name) = 'JOHN'\n- OR with different columns\n- NOT IN, NOT EXISTS (sometimes)\n- Leading wildcard: LIKE '%Smith'",tips:["EXPLAIN QUERY PLAN shows if indexes are used","Leftmost column in composite index is most important","Too many indexes slow down writes"]},challenge:{title:"Query Analysis",description:"Write an optimized query that would benefit from a composite index on (Pclass, Survived): Find survival rate by class.",dataset:"titanic",solution:"SELECT Pclass, COUNT(*) AS total, SUM(Survived) AS survived, ROUND(AVG(Survived) * 100, 2) AS survival_rate FROM passengers GROUP BY Pclass ORDER BY Pclass;",hints:["GROUP BY Pclass uses the index","Survived in aggregate can use index","This query pattern is index-friendly"],points:30}},{day:30,week:5,title:"Query Performance Tuning",description:"Master techniques for fast, efficient queries",concepts:["Performance tuning","Best practices","Query optimization"],lesson:{content:"# Query Performance Tuning 🏆\n\n## Key Optimization Techniques\n\n### 1. Select Only What You Need\n```sql\n-- Bad\nSELECT * FROM passengers WHERE Pclass = 1;\n\n-- Good\nSELECT Name, Age, Fare FROM passengers WHERE Pclass = 1;\n```\n\n### 2. Use WHERE to Filter Early\n```sql\n-- Bad\nSELECT * FROM passengers HAVING Age > 30;\n\n-- Good\nSELECT * FROM passengers WHERE Age > 30;\n```\n\n### 3. Avoid Functions on Indexed Columns\n```sql\n-- Bad (can't use index)\nSELECT * FROM passengers WHERE UPPER(Name) LIKE 'SMITH%';\n\n-- Good (uses index)\nSELECT * FROM passengers WHERE Name LIKE 'Smith%';\n```\n\n### 4. Use EXISTS Instead of IN (for large sets)\n```sql\n-- Often slower\nSELECT * FROM passengers WHERE Pclass IN (SELECT Pclass FROM ...);\n\n-- Often faster\nSELECT * FROM passengers p WHERE EXISTS (SELECT 1 FROM ... WHERE Pclass = p.Pclass);\n```\n\n### 5. Optimize JOINs\n- Join on indexed columns\n- Start with smaller table\n- Filter before joining when possible\n\n## Performance Checklist\n✅ SELECT only needed columns\n✅ Use appropriate indexes\n✅ Filter early with WHERE\n✅ Avoid SELECT DISTINCT if possible\n✅ Use LIMIT for large results",tips:["Measure before optimizing","The best optimization is not running unnecessary queries","Database design impacts performance more than query tuning"]},challenge:{title:"Final Challenge: Complete Analysis",description:"Write an optimized, comprehensive analysis: Show passenger class, gender, count, survivors, survival rate, avg fare, and avg age - all in one efficient query!",dataset:"titanic",solution:"SELECT Pclass, Sex, COUNT(*) AS total, SUM(Survived) AS survivors, ROUND(AVG(Survived) * 100, 1) AS survival_rate, ROUND(AVG(Fare), 2) AS avg_fare, ROUND(AVG(Age), 1) AS avg_age FROM passengers WHERE Age IS NOT NULL GROUP BY Pclass, Sex ORDER BY Pclass, Sex;",hints:["GROUP BY Pclass, Sex","Multiple aggregates in one query","Filter NULL ages for accurate averages"],points:50}}],rewards:{daily:25,weekComplete:100,perfectDay:10,challengeComplete:500,speedBonus:50}},window.sqlCurriculum={title:"Master SQL 30-Days Challenge",description:"Transform from SQL beginner to expert in 30 days with our structured curriculum",weeks:[{id:1,title:"SQL for Data Analysis",subtitle:"Days 01-07",color:"from-blue-500 to-cyan-500",icon:"📊",days:[{day:1,title:"Introduction to SQL",description:"Learn what SQL is, why it matters, and write your first query",concepts:["SELECT","FROM","Basic Syntax"],lesson:{content:"# Welcome to SQL! 🎉\n\nSQL (Structured Query Language) is the standard language for working with databases. Every tech company uses it!\n\n## Your First Query\n\nThe most basic SQL statement retrieves data from a table:\n\n```sql\nSELECT * FROM employees;\n```\n\nThis returns ALL columns (*) from the employees table.\n\n## Selecting Specific Columns\n\n```sql\nSELECT name, salary FROM employees;\n```\n\nThis returns only the name and salary columns.",keyPoints:["SQL is used to communicate with databases","SELECT retrieves data from tables","* means 'all columns'","Always end statements with semicolon"]},challenge:{title:"Your First SELECT",description:"Write a query to select all columns from the **passengers** table in the Titanic dataset.",dataset:"titanic",solution:"SELECT * FROM passengers;",hints:["Use SELECT * to get all columns","The table name is 'passengers'"],points:10}},{day:2,title:"Understanding Databases and Tables",description:"Learn how data is organized in databases, tables, rows, and columns",concepts:["Tables","Rows","Columns","Data Types"],lesson:{content:"# Database Structure 🗄️\n\n## How Data is Organized\n\n- **Database**: A collection of related tables\n- **Table**: A collection of related data (like a spreadsheet)\n- **Row**: A single record (one passenger, one sale, etc.)\n- **Column**: A specific attribute (name, age, price, etc.)\n\n## Common Data Types\n\n| Type | Example | Use For |\n|------|---------|---------|\n| INTEGER | 42 | Whole numbers |\n| REAL/FLOAT | 3.14 | Decimal numbers |\n| TEXT | 'John' | Words and strings |\n| DATE | '2024-01-15' | Dates |\n\n## Viewing Table Structure\n\n```sql\nPRAGMA table_info(passengers);\n```",keyPoints:["Tables organize data into rows and columns","Each column has a specific data type","Rows represent individual records","Good table design is crucial for efficiency"]},challenge:{title:"Explore the Data",description:"Select only the **Name**, **Age**, and **Fare** columns from the passengers table.",dataset:"titanic",solution:"SELECT Name, Age, Fare FROM passengers;",hints:["List column names separated by commas","Column names are case-sensitive"],points:10}},{day:3,title:"SELECT Statement",description:"Master the SELECT statement with column selection and aliases",concepts:["SELECT","Column Aliases","DISTINCT"],lesson:{content:"# Mastering SELECT 🎯\n\n## Column Aliases\n\nGive columns friendlier names in your output:\n\n```sql\nSELECT Name AS passenger_name, \n       Fare AS ticket_price \nFROM passengers;\n```\n\n## Removing Duplicates\n\nUse DISTINCT to get unique values:\n\n```sql\nSELECT DISTINCT Pclass FROM passengers;\n```\n\nThis shows each class only once (1, 2, 3).\n\n## Combining Techniques\n\n```sql\nSELECT DISTINCT Embarked AS boarding_port \nFROM passengers;\n```",keyPoints:["AS creates column aliases for cleaner output","DISTINCT removes duplicate rows","Aliases don't change the actual data","You can alias multiple columns in one query"]},challenge:{title:"Distinct Values",description:"Find all unique **passenger classes** (Pclass) in the Titanic dataset. Use an alias to name the column 'class'.",dataset:"titanic",solution:"SELECT DISTINCT Pclass AS class FROM passengers;",hints:["Use DISTINCT before the column name","Use AS to create the alias"],points:15}},{day:4,title:"WHERE Clause and Logical Operators",description:"Filter data using conditions with WHERE, AND, OR, and comparison operators",concepts:["WHERE","AND","OR","Comparison Operators"],lesson:{content:"# Filtering with WHERE 🔍\n\n## Basic Filtering\n\n```sql\nSELECT * FROM passengers \nWHERE Age > 30;\n```\n\n## Comparison Operators\n\n| Operator | Meaning |\n|----------|---------|\n| = | Equal to |\n| != or <> | Not equal to |\n| > | Greater than |\n| < | Less than |\n| >= | Greater than or equal |\n| <= | Less than or equal |\n\n## Combining Conditions\n\n**AND** - Both conditions must be true:\n```sql\nSELECT * FROM passengers \nWHERE Age > 30 AND Survived = 1;\n```\n\n**OR** - Either condition can be true:\n```sql\nSELECT * FROM passengers \nWHERE Pclass = 1 OR Pclass = 2;\n```",keyPoints:["WHERE filters rows based on conditions","AND requires ALL conditions to be true","OR requires ANY condition to be true","Use parentheses to group complex conditions"]},challenge:{title:"Filter Survivors",description:"Find all **female passengers** who **survived**. Select their Name, Age, and Fare.",dataset:"titanic",solution:"SELECT Name, Age, Fare FROM passengers WHERE Sex = 'female' AND Survived = 1;",hints:["Sex column contains 'male' or 'female'","Survived = 1 means they survived"],points:15}},{day:5,title:"Sorting Data with ORDER BY",description:"Learn to sort query results in ascending or descending order",concepts:["ORDER BY","ASC","DESC","Multiple Sorts"],lesson:{content:"# Sorting Results 📈\n\n## Basic Sorting\n\n```sql\nSELECT * FROM passengers \nORDER BY Age;\n```\n\nBy default, ORDER BY sorts in **ascending** order (smallest to largest).\n\n## Descending Order\n\n```sql\nSELECT * FROM passengers \nORDER BY Fare DESC;\n```\n\n## Multiple Sort Columns\n\n```sql\nSELECT * FROM passengers \nORDER BY Pclass ASC, Fare DESC;\n```\n\nThis sorts by class first, then by fare within each class.\n\n## Sorting with NULL Values\n\nNULL values typically appear first when sorting ASC, last when DESC.",keyPoints:["ORDER BY sorts results (ASC is default)","DESC sorts from largest to smallest","You can sort by multiple columns","Sorting happens after WHERE filtering"]},challenge:{title:"Top Fares",description:"Find the **10 highest fares** paid. Show Name, Pclass, and Fare, sorted from highest to lowest fare.",dataset:"titanic",solution:"SELECT Name, Pclass, Fare FROM passengers ORDER BY Fare DESC LIMIT 10;",hints:["Use ORDER BY with DESC","Use LIMIT to restrict to 10 rows"],points:15}},{day:6,title:"LIMIT & OFFSET",description:"Control how many rows are returned and implement pagination",concepts:["LIMIT","OFFSET","Pagination"],lesson:{content:"# Limiting Results 📄\n\n## Basic LIMIT\n\n```sql\nSELECT * FROM passengers LIMIT 5;\n```\n\nReturns only the first 5 rows.\n\n## OFFSET for Pagination\n\n```sql\nSELECT * FROM passengers \nLIMIT 10 OFFSET 20;\n```\n\nSkips the first 20 rows, then returns 10.\n\n## Pagination Pattern\n\nPage 1: `LIMIT 10 OFFSET 0`\nPage 2: `LIMIT 10 OFFSET 10`\nPage 3: `LIMIT 10 OFFSET 20`\n\nFormula: OFFSET = (page_number - 1) × page_size\n\n## Combining with ORDER BY\n\n```sql\nSELECT * FROM passengers \nORDER BY Age DESC \nLIMIT 5;\n```\n\nGets the 5 oldest passengers.",keyPoints:["LIMIT restricts the number of rows returned","OFFSET skips a specified number of rows","ORDER BY + LIMIT finds top/bottom N records","Pagination uses LIMIT with calculated OFFSET"]},challenge:{title:"Pagination Practice",description:"Get the **second page** of passengers (rows 11-20) when showing 10 per page, sorted by Name alphabetically.",dataset:"titanic",solution:"SELECT * FROM passengers ORDER BY Name ASC LIMIT 10 OFFSET 10;",hints:["Page 2 means OFFSET 10","LIMIT 10 for 10 items per page"],points:15}},{day:7,title:"Aggregate Functions",description:"Calculate totals, averages, counts, and other aggregates",concepts:["COUNT","SUM","AVG","MIN","MAX"],lesson:{content:"# Aggregate Functions 🔢\n\n## COUNT - Count Rows\n\n```sql\nSELECT COUNT(*) FROM passengers;\n-- Total passengers\n\nSELECT COUNT(Age) FROM passengers;\n-- Passengers with known age (excludes NULL)\n```\n\n## SUM & AVG - Totals and Averages\n\n```sql\nSELECT SUM(Fare) AS total_revenue FROM passengers;\nSELECT AVG(Age) AS average_age FROM passengers;\n```\n\n## MIN & MAX - Extremes\n\n```sql\nSELECT MIN(Age) AS youngest, \n       MAX(Age) AS oldest \nFROM passengers;\n```\n\n## Combining Aggregates\n\n```sql\nSELECT \n  COUNT(*) AS total,\n  AVG(Fare) AS avg_fare,\n  SUM(Survived) AS survivors\nFROM passengers;\n```",keyPoints:["COUNT(*) counts all rows, COUNT(column) excludes NULLs","SUM adds up numeric values","AVG calculates the mean","MIN/MAX find extreme values"]},challenge:{title:"Survival Statistics",description:"Calculate the **total passengers**, **survivors count**, and **average fare** for the entire dataset.",dataset:"titanic",solution:"SELECT COUNT(*) AS total_passengers, SUM(Survived) AS survivors, AVG(Fare) AS average_fare FROM passengers;",hints:["Use COUNT(*) for total","SUM(Survived) counts survivors (1=survived)"],points:20}}]},{id:2,title:"Intermediate SQL",subtitle:"Days 08-14",color:"from-purple-500 to-pink-500",icon:"🚀",days:[{day:8,title:"GROUP BY Clause",description:"Group data and calculate aggregates per group",concepts:["GROUP BY","Aggregates with Groups"],lesson:{content:"# Grouping Data 📊\n\n## Basic GROUP BY\n\n```sql\nSELECT Pclass, COUNT(*) AS passengers\nFROM passengers\nGROUP BY Pclass;\n```\n\nReturns count of passengers in each class.\n\n## Multiple Aggregates per Group\n\n```sql\nSELECT Pclass,\n       COUNT(*) AS total,\n       AVG(Age) AS avg_age,\n       SUM(Survived) AS survivors\nFROM passengers\nGROUP BY Pclass;\n```\n\n## Group by Multiple Columns\n\n```sql\nSELECT Pclass, Sex, AVG(Fare) AS avg_fare\nFROM passengers\nGROUP BY Pclass, Sex;\n```",keyPoints:["GROUP BY creates groups of rows with same values","Aggregate functions calculate per group","Non-aggregated columns must be in GROUP BY","You can group by multiple columns"]},challenge:{title:"Class Statistics",description:"Find the **survival rate** and **average fare** for each passenger **class**.",dataset:"titanic",solution:"SELECT Pclass, AVG(Survived) AS survival_rate, AVG(Fare) AS avg_fare FROM passengers GROUP BY Pclass;",hints:["AVG(Survived) gives survival rate (0-1)","GROUP BY Pclass"],points:20}},{day:9,title:"HAVING Clause",description:"Filter grouped data using HAVING",concepts:["HAVING","WHERE vs HAVING"],lesson:{content:"# Filtering Groups with HAVING 🎯\n\n## WHERE vs HAVING\n\n- **WHERE**: Filters individual rows BEFORE grouping\n- **HAVING**: Filters groups AFTER aggregation\n\n## Example\n\n```sql\nSELECT Embarked, COUNT(*) AS passengers\nFROM passengers\nWHERE Age > 18\nGROUP BY Embarked\nHAVING COUNT(*) > 100;\n```\n\nThis query:\n1. Filters to adults only (WHERE)\n2. Groups by embarkation port\n3. Only shows ports with 100+ adults (HAVING)\n\n## Common Pattern\n\n```sql\nSELECT category, AVG(value) AS avg_val\nFROM data\nGROUP BY category\nHAVING AVG(value) > 50;\n```",keyPoints:["HAVING filters after GROUP BY","WHERE filters before GROUP BY","HAVING can use aggregate functions","WHERE cannot use aggregates"]},challenge:{title:"Popular Ports",description:"Find embarkation ports (**Embarked**) with more than **200 passengers**. Show the port and count.",dataset:"titanic",solution:"SELECT Embarked, COUNT(*) AS passenger_count FROM passengers GROUP BY Embarked HAVING COUNT(*) > 200;",hints:["GROUP BY Embarked","Use HAVING with COUNT(*)"],points:20}},{day:10,title:"JOINs (INNER, LEFT, RIGHT)",description:"Combine data from multiple tables using different join types",concepts:["INNER JOIN","LEFT JOIN","RIGHT JOIN"],lesson:{content:"# Joining Tables 🔗\n\n## INNER JOIN\n\nReturns only matching rows from both tables:\n\n```sql\nSELECT e.name, d.department_name\nFROM employees e\nINNER JOIN departments d ON e.dept_id = d.id;\n```\n\n## LEFT JOIN\n\nReturns ALL rows from left table, matching from right:\n\n```sql\nSELECT e.name, d.department_name\nFROM employees e\nLEFT JOIN departments d ON e.dept_id = d.id;\n```\n\nEmployees without departments will show NULL.\n\n## RIGHT JOIN\n\nReturns ALL rows from right table, matching from left.\n\n## Visual Guide\n\n| Join Type | Left Only | Match | Right Only |\n|-----------|-----------|-------|------------|\n| INNER     | ❌ | ✅ | ❌ |\n| LEFT      | ✅ | ✅ | ❌ |\n| RIGHT     | ❌ | ✅ | ✅ |",keyPoints:["INNER JOIN returns only matching rows","LEFT JOIN includes all left table rows","RIGHT JOIN includes all right table rows","Use table aliases (e, d) for cleaner queries"]},challenge:{title:"Join Practice",description:"Using the **ecommerce** dataset, join **orders** with **customers** to show customer names with their order totals.",dataset:"ecommerce",solution:"SELECT c.name, o.total FROM orders o INNER JOIN customers c ON o.customer_id = c.id;",hints:["Join on customer_id = id","Use table aliases"],points:25}},{day:11,title:"Subqueries",description:"Use queries within queries for complex data retrieval",concepts:["Subqueries","IN","EXISTS"],lesson:{content:"# Subqueries 🎭\n\n## Subquery in WHERE\n\n```sql\nSELECT * FROM passengers\nWHERE Fare > (SELECT AVG(Fare) FROM passengers);\n```\n\nFinds passengers who paid more than average.\n\n## Subquery with IN\n\n```sql\nSELECT * FROM passengers\nWHERE Pclass IN (\n  SELECT Pclass FROM passengers\n  GROUP BY Pclass\n  HAVING AVG(Survived) > 0.5\n);\n```\n\n## Subquery in SELECT\n\n```sql\nSELECT Name, Fare,\n  (SELECT AVG(Fare) FROM passengers) AS avg_fare\nFROM passengers;\n```\n\n## Correlated Subquery\n\n```sql\nSELECT * FROM passengers p1\nWHERE Fare > (\n  SELECT AVG(Fare) FROM passengers p2\n  WHERE p2.Pclass = p1.Pclass\n);\n```",keyPoints:["Subqueries are queries inside queries","Use parentheses around subqueries","IN checks if value is in subquery results","Correlated subqueries reference outer query"]},challenge:{title:"Above Average",description:"Find passengers who paid a fare **higher than the average fare for their class**.",dataset:"titanic",solution:"SELECT * FROM passengers p1 WHERE Fare > (SELECT AVG(Fare) FROM passengers p2 WHERE p2.Pclass = p1.Pclass);",hints:["Use a correlated subquery","Match Pclass in subquery"],points:25}},{day:12,title:"Working with CASE Statements",description:"Add conditional logic to your queries",concepts:["CASE","WHEN","THEN","ELSE"],lesson:{content:"# Conditional Logic with CASE 🔀\n\n## Basic CASE\n\n```sql\nSELECT Name,\n  CASE \n    WHEN Age < 18 THEN 'Child'\n    WHEN Age < 65 THEN 'Adult'\n    ELSE 'Senior'\n  END AS age_group\nFROM passengers;\n```\n\n## CASE in Aggregates\n\n```sql\nSELECT \n  SUM(CASE WHEN Survived = 1 THEN 1 ELSE 0 END) AS survived,\n  SUM(CASE WHEN Survived = 0 THEN 1 ELSE 0 END) AS died\nFROM passengers;\n```\n\n## Simple CASE Form\n\n```sql\nSELECT Name,\n  CASE Pclass\n    WHEN 1 THEN 'First Class'\n    WHEN 2 THEN 'Second Class'\n    WHEN 3 THEN 'Third Class'\n  END AS class_name\nFROM passengers;\n```",keyPoints:["CASE provides if-then-else logic","Each WHEN is checked in order","ELSE handles unmatched cases","CASE can be used anywhere an expression is valid"]},challenge:{title:"Fare Categories",description:"Create a query that categorizes fares as 'Budget' (< 20), 'Standard' (20-100), or 'Premium' (> 100). Show Name and the category.",dataset:"titanic",solution:"SELECT Name, CASE WHEN Fare < 20 THEN 'Budget' WHEN Fare <= 100 THEN 'Standard' ELSE 'Premium' END AS fare_category FROM passengers;",hints:["Use CASE WHEN for each range","Check conditions in order"],points:20}},{day:13,title:"Self-Joins",description:"Join a table to itself for hierarchical or comparative queries",concepts:["Self-Join","Table Aliases"],lesson:{content:"# Self-Joins 🔄\n\nA self-join joins a table to itself, useful for:\n- Hierarchical data (employees → managers)\n- Comparing rows within the same table\n\n## Example: Find Employees and Their Managers\n\n```sql\nSELECT \n  e.name AS employee,\n  m.name AS manager\nFROM employees e\nLEFT JOIN employees m ON e.manager_id = m.id;\n```\n\n## Comparing Rows\n\nFind passengers who paid the same fare:\n\n```sql\nSELECT p1.Name, p2.Name, p1.Fare\nFROM passengers p1\nINNER JOIN passengers p2 \n  ON p1.Fare = p2.Fare \n  AND p1.PassengerId < p2.PassengerId;\n```\n\nThe `<` prevents duplicate pairs.",keyPoints:["Self-joins require different aliases for the same table","Useful for hierarchical relationships","Use inequality to avoid duplicate pairs","LEFT JOIN keeps rows without matches"]},challenge:{title:"Same Cabin",description:"Find pairs of passengers who shared the same **Cabin** (non-empty). Show both names and the cabin.",dataset:"titanic",solution:"SELECT p1.Name AS passenger1, p2.Name AS passenger2, p1.Cabin FROM passengers p1 INNER JOIN passengers p2 ON p1.Cabin = p2.Cabin AND p1.PassengerId < p2.PassengerId WHERE p1.Cabin != '';",hints:["Join passengers to itself","Use < to avoid duplicates","Filter out empty cabins"],points:25}},{day:14,title:"UNION & UNION ALL",description:"Combine results from multiple queries",concepts:["UNION","UNION ALL","Set Operations"],lesson:{content:"# Combining Results 🔗\n\n## UNION\n\nCombines results and removes duplicates:\n\n```sql\nSELECT Name FROM passengers WHERE Pclass = 1\nUNION\nSELECT Name FROM passengers WHERE Survived = 1;\n```\n\n## UNION ALL\n\nCombines results and keeps ALL rows (faster):\n\n```sql\nSELECT 'Class 1' AS source, COUNT(*) AS count \nFROM passengers WHERE Pclass = 1\nUNION ALL\nSELECT 'Survivors', COUNT(*) \nFROM passengers WHERE Survived = 1;\n```\n\n## Rules\n\n- Same number of columns\n- Compatible data types\n- Column names from first query\n\n## Use Cases\n\n- Combining data from multiple sources\n- Creating summary reports\n- Merging historical and current data",keyPoints:["UNION removes duplicates, UNION ALL keeps all","All queries must have same number of columns","Column names come from first SELECT","UNION ALL is faster (no deduplication)"]},challenge:{title:"Combined Report",description:"Create a report showing counts with labels: 'First Class' count, 'Second Class' count, and 'Third Class' count using UNION ALL.",dataset:"titanic",solution:"SELECT 'First Class' AS class, COUNT(*) AS count FROM passengers WHERE Pclass = 1 UNION ALL SELECT 'Second Class', COUNT(*) FROM passengers WHERE Pclass = 2 UNION ALL SELECT 'Third Class', COUNT(*) FROM passengers WHERE Pclass = 3;",hints:["Three SELECT statements with UNION ALL","Add a label column to each"],points:20}}]},{id:3,title:"Advanced SQL",subtitle:"Days 15-21",color:"from-orange-500 to-red-500",icon:"🔥",days:[{day:15,title:"Understanding Indexes",description:"Learn how indexes speed up queries and when to use them",concepts:["Indexes","CREATE INDEX","Query Optimization"],lesson:{content:"# Database Indexes 🏃\n\n## What is an Index?\n\nAn index is like a book's index - it helps find data faster without scanning every row.\n\n## Creating an Index\n\n```sql\nCREATE INDEX idx_passengers_class \nON passengers(Pclass);\n```\n\n## Composite Index\n\n```sql\nCREATE INDEX idx_passengers_class_survived \nON passengers(Pclass, Survived);\n```\n\n## When to Use Indexes\n\n✅ Columns used in WHERE clauses\n✅ Columns used in JOIN conditions\n✅ Columns used in ORDER BY\n\n❌ Small tables\n❌ Columns with few unique values\n❌ Tables with frequent inserts/updates\n\n## Viewing Indexes\n\n```sql\nPRAGMA index_list(passengers);\n```",keyPoints:["Indexes speed up SELECT queries","They slow down INSERT/UPDATE/DELETE","Choose indexed columns wisely","Composite indexes help multi-column queries"]},challenge:{title:"Index Strategy",description:"Create an index on the **Embarked** column, then write a query that would benefit from it.",dataset:"titanic",solution:"CREATE INDEX idx_embarked ON passengers(Embarked); SELECT * FROM passengers WHERE Embarked = 'S';",hints:["CREATE INDEX idx_name ON table(column)","Then query using that column in WHERE"],points:20}},{day:16,title:"Working with Views",description:"Create virtual tables for reusable query logic",concepts:["CREATE VIEW","Virtual Tables","Abstraction"],lesson:{content:"# Database Views 👁️\n\n## What is a View?\n\nA view is a saved query that acts like a virtual table.\n\n## Creating a View\n\n```sql\nCREATE VIEW survivors AS\nSELECT Name, Age, Pclass, Fare\nFROM passengers\nWHERE Survived = 1;\n```\n\n## Using a View\n\n```sql\nSELECT * FROM survivors WHERE Age > 50;\n```\n\n## Benefits\n\n- **Simplicity**: Complex queries become simple\n- **Security**: Hide sensitive columns\n- **Consistency**: Same logic everywhere\n- **Maintenance**: Update once, use everywhere\n\n## Dropping a View\n\n```sql\nDROP VIEW IF EXISTS survivors;\n```",keyPoints:["Views are saved queries, not stored data","They simplify complex queries","Views can be queried like regular tables","Changes to base tables reflect in views"]},challenge:{title:"Create a View",description:"Create a view called **first_class_passengers** that shows Name, Age, and Fare for Pclass = 1. Then query it.",dataset:"titanic",solution:"CREATE VIEW first_class_passengers AS SELECT Name, Age, Fare FROM passengers WHERE Pclass = 1; SELECT * FROM first_class_passengers;",hints:["CREATE VIEW name AS SELECT...","Then SELECT from the view"],points:20}},{day:17,title:"Transaction Management",description:"Ensure data integrity with transactions",concepts:["BEGIN","COMMIT","ROLLBACK","ACID"],lesson:{content:"# Transactions 🔐\n\n## What is a Transaction?\n\nA transaction is a group of operations that either ALL succeed or ALL fail.\n\n## ACID Properties\n\n- **Atomicity**: All or nothing\n- **Consistency**: Valid state before and after\n- **Isolation**: Transactions don't interfere\n- **Durability**: Committed changes persist\n\n## Transaction Syntax\n\n```sql\nBEGIN TRANSACTION;\n\nUPDATE accounts SET balance = balance - 100 \nWHERE id = 1;\n\nUPDATE accounts SET balance = balance + 100 \nWHERE id = 2;\n\nCOMMIT;\n```\n\n## Rollback on Error\n\n```sql\nBEGIN TRANSACTION;\n-- operations...\nROLLBACK; -- Undo all changes\n```",keyPoints:["Transactions group related operations","COMMIT saves all changes","ROLLBACK undoes all changes","Essential for data integrity"]},challenge:{title:"Safe Update",description:"Write a transaction that updates a passenger's fare and class atomically. Use BEGIN and COMMIT.",dataset:"titanic",solution:"BEGIN TRANSACTION; UPDATE passengers SET Fare = 100, Pclass = 1 WHERE PassengerId = 1; COMMIT;",hints:["Start with BEGIN TRANSACTION","End with COMMIT"],points:20}},{day:18,title:"Creating Stored Procedures",description:"Learn about reusable SQL code blocks (conceptual in SQLite)",concepts:["Procedures","Functions","Reusability"],lesson:{content:"# Stored Procedures & Functions 📦\n\n## What are Stored Procedures?\n\nReusable blocks of SQL code stored in the database.\n\nNote: SQLite has limited support, but the concepts apply to all databases.\n\n## SQLite User Functions (Conceptual)\n\nIn production databases like PostgreSQL/MySQL:\n\n```sql\nCREATE PROCEDURE GetSurvivorsByClass(class_id INT)\nBEGIN\n  SELECT * FROM passengers \n  WHERE Pclass = class_id AND Survived = 1;\nEND;\n\nCALL GetSurvivorsByClass(1);\n```\n\n## Benefits\n\n- **Reusability**: Write once, use many times\n- **Security**: Control data access\n- **Performance**: Pre-compiled execution\n- **Maintainability**: Centralized logic\n\n## SQLite Alternative: Views\n\n```sql\nCREATE VIEW class_survivors AS\nSELECT Pclass, COUNT(*) as survivors\nFROM passengers WHERE Survived = 1\nGROUP BY Pclass;\n```",keyPoints:["Stored procedures encapsulate SQL logic","They accept parameters for flexibility","In SQLite, use views for similar functionality","Production databases have full procedure support"]},challenge:{title:"Reusable Query",description:"Create a view that mimics a procedure: show survival statistics (count, avg_age, avg_fare) grouped by Pclass.",dataset:"titanic",solution:"CREATE VIEW class_statistics AS SELECT Pclass, COUNT(*) AS total, SUM(Survived) AS survivors, AVG(Age) AS avg_age, AVG(Fare) AS avg_fare FROM passengers GROUP BY Pclass; SELECT * FROM class_statistics;",hints:["Create a view with GROUP BY","Include multiple aggregates"],points:25}},{day:19,title:"Implementing Triggers",description:"Automate actions when data changes",concepts:["Triggers","AFTER INSERT","BEFORE UPDATE"],lesson:{content:"# Database Triggers ⚡\n\n## What is a Trigger?\n\nAutomatic code that runs when data changes.\n\n## Creating a Trigger\n\n```sql\nCREATE TRIGGER log_fare_update\nAFTER UPDATE ON passengers\nFOR EACH ROW\nWHEN OLD.Fare != NEW.Fare\nBEGIN\n  INSERT INTO fare_log(passenger_id, old_fare, new_fare, changed_at)\n  VALUES (NEW.PassengerId, OLD.Fare, NEW.Fare, datetime('now'));\nEND;\n```\n\n## Trigger Types\n\n- **BEFORE**: Runs before the operation\n- **AFTER**: Runs after the operation\n- **INSTEAD OF**: Replaces the operation (for views)\n\n## OLD and NEW\n\n- **OLD**: The row before change\n- **NEW**: The row after change",keyPoints:["Triggers automate database tasks","They fire on INSERT, UPDATE, or DELETE","OLD/NEW reference row values","Use for auditing, validation, cascading changes"]},challenge:{title:"Audit Trail",description:"Create an audit table and a trigger that logs whenever a passenger's Survived status is updated.",dataset:"titanic",solution:"CREATE TABLE IF NOT EXISTS survival_log (id INTEGER PRIMARY KEY, passenger_id INTEGER, old_status INTEGER, new_status INTEGER, changed_at TEXT); CREATE TRIGGER log_survival AFTER UPDATE ON passengers WHEN OLD.Survived != NEW.Survived BEGIN INSERT INTO survival_log(passenger_id, old_status, new_status, changed_at) VALUES (NEW.PassengerId, OLD.Survived, NEW.Survived, datetime('now')); END;",hints:["First CREATE TABLE for logs","Then CREATE TRIGGER AFTER UPDATE"],points:30}},{day:20,title:"Database Normalization",description:"Design efficient database structures",concepts:["1NF","2NF","3NF","Normalization"],lesson:{content:'# Database Normalization 📐\n\n## Why Normalize?\n\n- Eliminate redundant data\n- Prevent update anomalies\n- Ensure data integrity\n\n## First Normal Form (1NF)\n\n- Each cell contains single value\n- Each row is unique\n- No repeating groups\n\n❌ Bad: `hobbies: "reading, gaming"`\n✅ Good: Separate hobbies table\n\n## Second Normal Form (2NF)\n\n- Meet 1NF\n- All non-key columns depend on the FULL primary key\n\n## Third Normal Form (3NF)\n\n- Meet 2NF\n- No transitive dependencies\n\n❌ Bad: `employee_id, department_id, department_name`\n✅ Good: Separate departments table\n\n## Denormalization\n\nSometimes we intentionally denormalize for performance (read-heavy systems).',keyPoints:["Normalization reduces data redundancy","1NF: Atomic values, unique rows","2NF: Full dependency on primary key","3NF: No transitive dependencies"]},challenge:{title:"Normalize Design",description:"The passengers table has Ticket shared by multiple passengers. Write a query to find all unique tickets with passenger count.",dataset:"titanic",solution:"SELECT Ticket, COUNT(*) AS passengers_on_ticket FROM passengers WHERE Ticket != '' GROUP BY Ticket HAVING COUNT(*) > 1 ORDER BY passengers_on_ticket DESC;",hints:["GROUP BY Ticket","Use HAVING to filter groups"],points:20}},{day:21,title:"Exploring ACID Properties",description:"Deep dive into database reliability guarantees",concepts:["Atomicity","Consistency","Isolation","Durability"],lesson:{content:"# ACID Properties 🛡️\n\n## Atomicity\n\nAll operations in a transaction succeed or all fail.\n\n```sql\nBEGIN;\nUPDATE account SET balance = balance - 100 WHERE id = 1;\nUPDATE account SET balance = balance + 100 WHERE id = 2;\n-- If either fails, both are rolled back\nCOMMIT;\n```\n\n## Consistency\n\nDatabase moves from one valid state to another.\n\n## Isolation\n\nConcurrent transactions don't interfere.\n\n### Isolation Levels:\n1. READ UNCOMMITTED (lowest)\n2. READ COMMITTED\n3. REPEATABLE READ\n4. SERIALIZABLE (highest)\n\n## Durability\n\nOnce committed, data survives crashes.\n\n## Testing Atomicity\n\n```sql\nBEGIN;\nUPDATE passengers SET Fare = -100 WHERE PassengerId = 1;\n-- Check constraint would fail\nROLLBACK;\n```",keyPoints:["ACID ensures reliable transactions","Atomicity: All or nothing","Isolation levels trade performance for safety","Durability means committed = permanent"]},challenge:{title:"Transaction Practice",description:"Write a transaction that swaps fares between two passengers (ID 1 and 2), ensuring atomicity.",dataset:"titanic",solution:"BEGIN; UPDATE passengers SET Fare = (SELECT Fare FROM passengers WHERE PassengerId = 2) WHERE PassengerId = 1; UPDATE passengers SET Fare = (SELECT Fare FROM passengers WHERE PassengerId = 1) WHERE PassengerId = 2; COMMIT;",hints:["Use subqueries to get the other passenger's fare","Wrap in BEGIN/COMMIT"],points:25}}]},{id:4,title:"SQL for Data Analysis",subtitle:"Days 22-28",color:"from-green-500 to-teal-500",icon:"📈",days:[{day:22,title:"Date Functions",description:"Manipulate and extract information from dates",concepts:["date()","strftime()","Date Arithmetic"],lesson:{content:"# Date Functions 📅\n\n## Current Date/Time\n\n```sql\nSELECT date('now');           -- 2024-01-15\nSELECT datetime('now');       -- 2024-01-15 14:30:00\nSELECT time('now');           -- 14:30:00\n```\n\n## Date Formatting (strftime)\n\n```sql\nSELECT strftime('%Y', '2024-01-15');  -- 2024\nSELECT strftime('%m', '2024-01-15');  -- 01\nSELECT strftime('%d', '2024-01-15');  -- 15\nSELECT strftime('%W', '2024-01-15');  -- Week number\n```\n\n## Date Arithmetic\n\n```sql\nSELECT date('now', '+7 days');\nSELECT date('now', '-1 month');\nSELECT date('now', 'start of month');\n```\n\n## Age Calculation\n\n```sql\nSELECT \n  (strftime('%Y', 'now') - strftime('%Y', birth_date)) AS age\nFROM people;\n```",keyPoints:["date(), datetime(), time() get current values","strftime() formats and extracts date parts","Date modifiers allow arithmetic","Dates stored as TEXT in SQLite"]},challenge:{title:"Date Analysis",description:"Using the **ecommerce** dataset, find orders from the current year grouped by month. Show month and order count.",dataset:"ecommerce",solution:"SELECT strftime('%m', order_date) AS month, COUNT(*) AS order_count FROM orders WHERE strftime('%Y', order_date) = strftime('%Y', 'now') GROUP BY month ORDER BY month;",hints:["Use strftime('%Y',...) for year","Group by month"],points:25}},{day:23,title:"String Functions",description:"Manipulate and search text data",concepts:["UPPER","LOWER","SUBSTR","INSTR","REPLACE"],lesson:{content:"# String Functions 📝\n\n## Case Conversion\n\n```sql\nSELECT UPPER(Name) FROM passengers;  -- JOHN SMITH\nSELECT LOWER(Name) FROM passengers;  -- john smith\n```\n\n## Substring\n\n```sql\nSELECT SUBSTR(Name, 1, 5) FROM passengers;  -- First 5 chars\nSELECT SUBSTR(Name, -3) FROM passengers;    -- Last 3 chars\n```\n\n## Finding Text\n\n```sql\nSELECT INSTR(Name, 'Mr.') FROM passengers;  -- Position or 0\nSELECT * FROM passengers WHERE Name LIKE '%Mr.%';\n```\n\n## Replacing Text\n\n```sql\nSELECT REPLACE(Name, 'Mr.', 'Mister') FROM passengers;\n```\n\n## Concatenation\n\n```sql\nSELECT Name || ' - Class ' || Pclass FROM passengers;\n```\n\n## Length and Trimming\n\n```sql\nSELECT LENGTH(Name) FROM passengers;\nSELECT TRIM('  hello  ');  -- 'hello'\n```",keyPoints:["|| concatenates strings in SQLite","SUBSTR extracts parts of strings","LIKE with % for pattern matching","TRIM removes whitespace"]},challenge:{title:"Name Parsing",description:"Extract the **title** (Mr., Mrs., Miss., etc.) from passenger names. Show the title and count of each.",dataset:"titanic",solution:"SELECT SUBSTR(Name, INSTR(Name, ', ') + 2, INSTR(SUBSTR(Name, INSTR(Name, ', ') + 2), '.')) AS title, COUNT(*) AS count FROM passengers GROUP BY title ORDER BY count DESC;",hints:["Titles are between ', ' and '.'","Use SUBSTR and INSTR"],points:30}},{day:24,title:"Math Functions",description:"Perform calculations and rounding in SQL",concepts:["ROUND","ABS","Mathematical Operations"],lesson:{content:"# Math Functions 🔢\n\n## Basic Math\n\n```sql\nSELECT 10 + 5;   -- 15\nSELECT 10 - 5;   -- 5\nSELECT 10 * 5;   -- 50\nSELECT 10 / 3;   -- 3 (integer division)\nSELECT 10.0 / 3; -- 3.333...\nSELECT 10 % 3;   -- 1 (modulo)\n```\n\n## Rounding\n\n```sql\nSELECT ROUND(3.14159, 2);  -- 3.14\nSELECT ROUND(Fare, 0) FROM passengers;\n```\n\n## Absolute Value\n\n```sql\nSELECT ABS(-42);  -- 42\n```\n\n## Calculations in Queries\n\n```sql\nSELECT Name, \n       Fare,\n       ROUND(Fare * 1.1, 2) AS fare_with_tax\nFROM passengers;\n```\n\n## Statistical Calculations\n\n```sql\nSELECT \n  AVG(Fare) AS mean,\n  MIN(Fare) AS minimum,\n  MAX(Fare) AS maximum,\n  MAX(Fare) - MIN(Fare) AS range\nFROM passengers;\n```",keyPoints:["Use 10.0 / 3 for decimal division","ROUND(value, decimals) rounds numbers","ABS returns absolute value","Combine with aggregates for statistics"]},challenge:{title:"Fare Analysis",description:"Calculate the **fare per family member** (SibSp + Parch + 1). Show Name, Fare, family_size, and fare_per_person (rounded to 2 decimals).",dataset:"titanic",solution:"SELECT Name, Fare, (SibSp + Parch + 1) AS family_size, ROUND(Fare / (SibSp + Parch + 1), 2) AS fare_per_person FROM passengers WHERE Fare > 0;",hints:["family_size = SibSp + Parch + 1","Use ROUND for fare_per_person"],points:20}},{day:25,title:"Window Functions",description:"Perform calculations across related rows",concepts:["OVER","PARTITION BY","ROW_NUMBER","RANK"],lesson:{content:"# Window Functions 🪟\n\n## What are Window Functions?\n\nCalculate values across a set of rows related to the current row.\n\n## ROW_NUMBER\n\n```sql\nSELECT Name, Fare,\n  ROW_NUMBER() OVER (ORDER BY Fare DESC) AS rank\nFROM passengers;\n```\n\n## PARTITION BY\n\n```sql\nSELECT Name, Pclass, Fare,\n  ROW_NUMBER() OVER (PARTITION BY Pclass ORDER BY Fare DESC) AS class_rank\nFROM passengers;\n```\n\n## Running Totals\n\n```sql\nSELECT Name, Fare,\n  SUM(Fare) OVER (ORDER BY PassengerId) AS running_total\nFROM passengers;\n```\n\n## RANK vs DENSE_RANK\n\n```sql\nSELECT Fare,\n  RANK() OVER (ORDER BY Fare DESC) AS rank,      -- 1,2,2,4\n  DENSE_RANK() OVER (ORDER BY Fare DESC) AS dense -- 1,2,2,3\nFROM passengers;\n```",keyPoints:["Window functions don't collapse rows like GROUP BY","OVER() defines the window","PARTITION BY creates sub-windows","ROW_NUMBER, RANK, DENSE_RANK for ordering"]},challenge:{title:"Ranking Passengers",description:"Rank passengers by fare **within their class**. Show Name, Pclass, Fare, and their rank (1 = highest fare).",dataset:"titanic",solution:"SELECT Name, Pclass, Fare, RANK() OVER (PARTITION BY Pclass ORDER BY Fare DESC) AS fare_rank FROM passengers;",hints:["PARTITION BY Pclass","ORDER BY Fare DESC in the window"],points:30}},{day:26,title:"Common Table Expressions (CTE)",description:"Write cleaner queries with WITH clause",concepts:["WITH","CTE","Recursive CTE"],lesson:{content:"# Common Table Expressions 📋\n\n## Basic CTE\n\n```sql\nWITH survivors AS (\n  SELECT * FROM passengers WHERE Survived = 1\n)\nSELECT Pclass, COUNT(*) AS count\nFROM survivors\nGROUP BY Pclass;\n```\n\n## Multiple CTEs\n\n```sql\nWITH \n  survivors AS (\n    SELECT * FROM passengers WHERE Survived = 1\n  ),\n  class_stats AS (\n    SELECT Pclass, AVG(Fare) AS avg_fare\n    FROM survivors\n    GROUP BY Pclass\n  )\nSELECT * FROM class_stats;\n```\n\n## CTE vs Subquery\n\nCTEs are:\n- More readable\n- Reusable within the query\n- Self-documenting\n\n## Recursive CTE (Advanced)\n\n```sql\nWITH RECURSIVE countdown(n) AS (\n  SELECT 10\n  UNION ALL\n  SELECT n - 1 FROM countdown WHERE n > 1\n)\nSELECT n FROM countdown;\n```",keyPoints:["CTEs make complex queries readable","WITH clause defines temporary result sets","Multiple CTEs separated by commas","Recursive CTEs handle hierarchical data"]},challenge:{title:"CTE Analysis",description:"Use a CTE to find the **average fare by class**, then find passengers who paid more than their class average.",dataset:"titanic",solution:"WITH class_avg AS (SELECT Pclass, AVG(Fare) AS avg_fare FROM passengers GROUP BY Pclass) SELECT p.Name, p.Pclass, p.Fare, c.avg_fare FROM passengers p JOIN class_avg c ON p.Pclass = c.Pclass WHERE p.Fare > c.avg_fare;",hints:["First CTE calculates class averages","Main query joins and filters"],points:30}},{day:27,title:"Analytic Functions",description:"LAG, LEAD, and other analytic capabilities",concepts:["LAG","LEAD","FIRST_VALUE","LAST_VALUE"],lesson:{content:"# Analytic Functions 📊\n\n## LAG - Previous Row Value\n\n```sql\nSELECT Name, Fare,\n  LAG(Fare) OVER (ORDER BY PassengerId) AS prev_fare\nFROM passengers;\n```\n\n## LEAD - Next Row Value\n\n```sql\nSELECT Name, Fare,\n  LEAD(Fare) OVER (ORDER BY PassengerId) AS next_fare\nFROM passengers;\n```\n\n## Calculating Differences\n\n```sql\nSELECT Name, Fare,\n  Fare - LAG(Fare) OVER (ORDER BY PassengerId) AS fare_diff\nFROM passengers;\n```\n\n## FIRST_VALUE / LAST_VALUE\n\n```sql\nSELECT Name, Pclass, Fare,\n  FIRST_VALUE(Name) OVER (\n    PARTITION BY Pclass \n    ORDER BY Fare DESC\n  ) AS highest_payer\nFROM passengers;\n```",keyPoints:["LAG accesses previous row values","LEAD accesses next row values","Useful for calculating changes/differences","FIRST_VALUE/LAST_VALUE get boundary values"]},challenge:{title:"Fare Comparison",description:"For each passenger, show their fare and the **difference from the previous passenger's fare** (ordered by PassengerId).",dataset:"titanic",solution:"SELECT Name, Fare, LAG(Fare) OVER (ORDER BY PassengerId) AS prev_fare, Fare - LAG(Fare) OVER (ORDER BY PassengerId) AS fare_difference FROM passengers;",hints:["Use LAG(Fare) OVER (ORDER BY PassengerId)","Subtract to get difference"],points:25}},{day:28,title:"Pivot & Unpivot",description:"Transform data between row and column formats",concepts:["CASE Pivot","Cross-Tabulation"],lesson:{content:"# Pivot Tables in SQL 🔄\n\nSQLite doesn't have native PIVOT, but we can use CASE statements.\n\n## Pivot with CASE\n\nTurn rows into columns:\n\n```sql\nSELECT \n  Embarked,\n  SUM(CASE WHEN Pclass = 1 THEN 1 ELSE 0 END) AS first_class,\n  SUM(CASE WHEN Pclass = 2 THEN 1 ELSE 0 END) AS second_class,\n  SUM(CASE WHEN Pclass = 3 THEN 1 ELSE 0 END) AS third_class\nFROM passengers\nGROUP BY Embarked;\n```\n\n## Cross-Tabulation\n\n```sql\nSELECT \n  Sex,\n  SUM(CASE WHEN Survived = 1 THEN 1 ELSE 0 END) AS survived,\n  SUM(CASE WHEN Survived = 0 THEN 1 ELSE 0 END) AS died,\n  ROUND(AVG(Survived) * 100, 1) AS survival_rate\nFROM passengers\nGROUP BY Sex;\n```\n\n## Dynamic Aggregation\n\n```sql\nSELECT \n  Pclass,\n  COUNT(*) AS total,\n  SUM(Survived) AS survivors,\n  ROUND(100.0 * SUM(Survived) / COUNT(*), 1) AS pct\nFROM passengers\nGROUP BY Pclass;\n```",keyPoints:["Use CASE inside aggregates for pivot","GROUP BY determines your rows","CASE WHEN determines your columns","Great for cross-tabulation reports"]},challenge:{title:"Survival Pivot",description:"Create a pivot showing **survival count by Sex and Class**. Rows = Sex, Columns = Class (1, 2, 3).",dataset:"titanic",solution:"SELECT Sex, SUM(CASE WHEN Pclass = 1 AND Survived = 1 THEN 1 ELSE 0 END) AS class1_survived, SUM(CASE WHEN Pclass = 2 AND Survived = 1 THEN 1 ELSE 0 END) AS class2_survived, SUM(CASE WHEN Pclass = 3 AND Survived = 1 THEN 1 ELSE 0 END) AS class3_survived FROM passengers GROUP BY Sex;",hints:["GROUP BY Sex for rows","CASE for each class column"],points:30}}]},{id:5,title:"SQL Best Practices & Optimization",subtitle:"Days 29-30",color:"from-yellow-500 to-amber-500",icon:"⚡",days:[{day:29,title:"Index Optimization",description:"Advanced indexing strategies for query performance",concepts:["Query Plans","Index Selection","Covering Indexes"],lesson:{content:"# Index Optimization ⚡\n\n## Query Execution Plan\n\n```sql\nEXPLAIN QUERY PLAN\nSELECT * FROM passengers WHERE Pclass = 1;\n```\n\nShows how SQLite will execute your query.\n\n## Index Types\n\n1. **Single Column**: One column\n2. **Composite**: Multiple columns (order matters!)\n3. **Covering**: Contains all needed columns\n\n## Composite Index Order\n\n```sql\nCREATE INDEX idx_class_survived \nON passengers(Pclass, Survived);\n\n-- Uses index well:\nWHERE Pclass = 1 AND Survived = 1\nWHERE Pclass = 1\n\n-- May not use index:\nWHERE Survived = 1  -- Second column only!\n```\n\n## When NOT to Index\n\n- Columns with few unique values\n- Frequently updated columns\n- Small tables (< 1000 rows)\n- Columns rarely in WHERE/JOIN",keyPoints:["EXPLAIN QUERY PLAN shows execution","Composite index column order matters","Covering indexes include all SELECT columns","Too many indexes slow writes"]},challenge:{title:"Optimize Query",description:"Use EXPLAIN QUERY PLAN to analyze a query, then create an appropriate index to optimize it.",dataset:"titanic",solution:"EXPLAIN QUERY PLAN SELECT Name, Fare FROM passengers WHERE Pclass = 1 AND Survived = 1 ORDER BY Fare DESC; CREATE INDEX idx_class_surv_fare ON passengers(Pclass, Survived, Fare);",hints:["First EXPLAIN the query","Index columns used in WHERE and ORDER BY"],points:30}},{day:30,title:"Query Performance Tuning",description:"Write efficient queries and avoid common pitfalls",concepts:["Query Optimization","Best Practices","Common Mistakes"],lesson:{content:"# Query Performance Tuning 🎯\n\n## DO: Select Only What You Need\n\n```sql\n-- ❌ Bad\nSELECT * FROM passengers;\n\n-- ✅ Good\nSELECT Name, Age FROM passengers;\n```\n\n## DO: Use WHERE to Limit Data Early\n\n```sql\n-- ❌ Bad (filters after aggregation)\nSELECT * FROM (\n  SELECT Pclass, AVG(Fare) FROM passengers GROUP BY Pclass\n) WHERE Pclass = 1;\n\n-- ✅ Good (filters before aggregation)\nSELECT Pclass, AVG(Fare) FROM passengers \nWHERE Pclass = 1 GROUP BY Pclass;\n```\n\n## DON'T: Use Functions on Indexed Columns\n\n```sql\n-- ❌ Can't use index\nWHERE UPPER(Name) = 'JOHN'\n\n-- ✅ Can use index\nWHERE Name = 'John'\n```\n\n## DO: Use EXISTS Instead of IN for Large Subqueries\n\n```sql\n-- Often faster:\nWHERE EXISTS (SELECT 1 FROM other WHERE other.id = main.id)\n```\n\n## Final Tips\n\n1. Index columns in WHERE, JOIN, ORDER BY\n2. Avoid SELECT *\n3. Use LIMIT for testing\n4. Profile with EXPLAIN QUERY PLAN",keyPoints:["Select only needed columns","Filter early with WHERE","Avoid functions on indexed columns","Use EXPLAIN to find bottlenecks"]},challenge:{title:"Graduation Challenge",description:"Write an optimized query to find the **top 5 highest-paying survivors in each class** with their class rank. Use CTEs and window functions.",dataset:"titanic",solution:"WITH ranked_survivors AS (SELECT Name, Pclass, Fare, RANK() OVER (PARTITION BY Pclass ORDER BY Fare DESC) AS class_rank FROM passengers WHERE Survived = 1) SELECT * FROM ranked_survivors WHERE class_rank <= 5 ORDER BY Pclass, class_rank;",hints:["CTE with window function for ranking","Filter to top 5 per class"],points:50}}]}]},window.weeklyRewards={1:{xp:100,badge:"SQL Foundations",icon:"🏅"},2:{xp:150,badge:"Query Architect",icon:"🥈"},3:{xp:200,badge:"Database Expert",icon:"🥇"},4:{xp:250,badge:"Data Analyst",icon:"🏆"},5:{xp:300,badge:"SQL Master",icon:"👑"}},window.masterReward={xp:1e3,badge:"30-Day SQL Master",icon:"🎓",title:"SQL Master"},window.sqlChallenge30Days={tables:{passengers:{name:"passengers",description:"Titanic passenger manifest - 891 passengers",rowCount:891,schema:[{column:"PassengerId",type:"INTEGER",description:"Unique passenger ID (1-891)",example:"1, 2, 3..."},{column:"Survived",type:"INTEGER",description:"Survival status",example:"0 = Died, 1 = Survived"},{column:"Pclass",type:"INTEGER",description:"Ticket class",example:"1 = First, 2 = Second, 3 = Third"},{column:"Name",type:"TEXT",description:"Full name with title",example:"Braund, Mr. Owen Harris"},{column:"Sex",type:"TEXT",description:"Gender",example:"'male' or 'female'"},{column:"Age",type:"REAL",description:"Age in years (177 NULL)",example:"22, 38, 0.42 (infant)"},{column:"SibSp",type:"INTEGER",description:"# siblings/spouses aboard",example:"0, 1, 2..."},{column:"Parch",type:"INTEGER",description:"# parents/children aboard",example:"0, 1, 2..."},{column:"Ticket",type:"TEXT",description:"Ticket number",example:"A/5 21171"},{column:"Fare",type:"REAL",description:"Passenger fare in £",example:"7.25, 71.28, 512.33"},{column:"Cabin",type:"TEXT",description:"Cabin number (687 NULL)",example:"C85, B28, NULL"},{column:"Embarked",type:"TEXT",description:"Port of embarkation",example:"S=Southampton, C=Cherbourg, Q=Queenstown"}],sampleData:[{PassengerId:1,Survived:0,Pclass:3,Name:"Braund, Mr. Owen Harris",Sex:"male",Age:22,SibSp:1,Parch:0,Ticket:"A/5 21171",Fare:7.25,Cabin:null,Embarked:"S"},{PassengerId:2,Survived:1,Pclass:1,Name:"Cumings, Mrs. John Bradley",Sex:"female",Age:38,SibSp:1,Parch:0,Ticket:"PC 17599",Fare:71.28,Cabin:"C85",Embarked:"C"},{PassengerId:3,Survived:1,Pclass:3,Name:"Heikkinen, Miss. Laina",Sex:"female",Age:26,SibSp:0,Parch:0,Ticket:"STON/O2. 3101282",Fare:7.925,Cabin:null,Embarked:"S"},{PassengerId:4,Survived:1,Pclass:1,Name:"Futrelle, Mrs. Jacques Heath",Sex:"female",Age:35,SibSp:1,Parch:0,Ticket:"113803",Fare:53.1,Cabin:"C123",Embarked:"S"},{PassengerId:5,Survived:0,Pclass:3,Name:"Allen, Mr. William Henry",Sex:"male",Age:35,SibSp:0,Parch:0,Ticket:"373450",Fare:8.05,Cabin:null,Embarked:"S"}],stats:{totalPassengers:891,survived:342,died:549,maleCount:577,femaleCount:314,class1:216,class2:184,class3:491,avgAge:29.7,avgFare:32.2}},customers:{name:"customers",description:"E-commerce customer data",rowCount:30,schema:[{column:"id",type:"INTEGER",description:"Unique customer ID",example:"1, 2, 3..."},{column:"name",type:"TEXT",description:"Customer full name",example:"Alice Johnson"},{column:"email",type:"TEXT",description:"Email address",example:"alice@email.com"},{column:"city",type:"TEXT",description:"City",example:"New York, Boston"},{column:"country",type:"TEXT",description:"Country",example:"USA, UK, Canada"},{column:"join_date",type:"TEXT",description:"Account created date",example:"2024-01-15"}],sampleData:[{id:1,name:"Alice Johnson",email:"alice@email.com",city:"New York",country:"USA",join_date:"2024-01-15"},{id:2,name:"Bob Smith",email:"bob@email.com",city:"Boston",country:"USA",join_date:"2024-01-20"},{id:3,name:"Carol Williams",email:"carol@email.com",city:"London",country:"UK",join_date:"2024-02-01"}]},orders:{name:"orders",description:"Customer orders",rowCount:50,schema:[{column:"id",type:"INTEGER",description:"Unique order ID",example:"1, 2, 3..."},{column:"customer_id",type:"INTEGER",description:"References customers.id",example:"1, 2, 3..."},{column:"order_date",type:"TEXT",description:"Date of order",example:"2024-01-15"},{column:"total",type:"REAL",description:"Order total amount",example:"150.00, 89.99"},{column:"status",type:"TEXT",description:"Order status",example:"pending, shipped, delivered"}],sampleData:[{id:1,customer_id:1,order_date:"2024-01-15",total:150,status:"delivered"},{id:2,customer_id:1,order_date:"2024-02-01",total:89.99,status:"delivered"},{id:3,customer_id:2,order_date:"2024-01-25",total:225.5,status:"shipped"}]}},scoring:{easy:{points:5,hintPenalty:2},"easy-medium":{points:10,hintPenalty:3},medium:{points:15,hintPenalty:5},"medium-hard":{points:20,hintPenalty:6},hard:{points:25,hintPenalty:8}},passRequirement:3,perfectBonus:10,maxDailyXP:85,days:[{day:1,week:1,title:"Introduction to SQL",description:"Learn SELECT basics - retrieving data from tables",concepts:["SELECT","FROM","*","Column selection"],dataset:"titanic",tableUsed:"passengers",tableSchema:[{column:"PassengerId",type:"INTEGER",description:"Unique ID (1-891)"},{column:"Survived",type:"INTEGER",description:"0=Died, 1=Survived"},{column:"Pclass",type:"INTEGER",description:"1=First, 2=Second, 3=Third"},{column:"Name",type:"TEXT",description:"Full name with title"},{column:"Sex",type:"TEXT",description:"'male' or 'female'"},{column:"Age",type:"REAL",description:"Age in years"},{column:"SibSp",type:"INTEGER",description:"Siblings/spouses aboard"},{column:"Parch",type:"INTEGER",description:"Parents/children aboard"},{column:"Ticket",type:"TEXT",description:"Ticket number"},{column:"Fare",type:"REAL",description:"Ticket price (£)"},{column:"Cabin",type:"TEXT",description:"Cabin number"},{column:"Embarked",type:"TEXT",description:"S/C/Q port code"}],lesson:'# Welcome to SQL! 🎉\n\n**SQL** (Structured Query Language) is the standard language for working with databases.\n\n## The SELECT Statement\n\nThe most fundamental SQL query retrieves data from a table:\n\n```sql\nSELECT * FROM passengers;\n```\n\n- **SELECT** - specifies what columns to retrieve\n- **\\*** - wildcard meaning "all columns"  \n- **FROM** - specifies which table\n- **passengers** - the table name\n\n## Selecting Specific Columns\n\nInstead of all columns, you can list the ones you want:\n\n```sql\nSELECT Name, Age FROM passengers;\n```\n\nThis returns only the Name and Age columns.',questions:[{id:"d1q1",difficulty:"easy",points:5,hintPenalty:2,title:"Your First Query",description:"Write a query to select **all columns** from the **passengers** table.",tableUsed:"passengers",columnsNeeded:["*"],hint:"Use SELECT * to get all columns. The syntax is: SELECT * FROM table_name;",solution:"SELECT * FROM passengers;",alternativeSolutions:["SELECT * FROM passengers","select * from passengers;","select * from passengers"],expectedResult:{columns:["passenger_id","survived","pclass","name","sex","age","sibsp","parch","fare","embarked"],rowCount:891,preview:[[1,0,3,"Braund, Mr. Owen Harris","male",22,1,0,"A/5 21171",7.25,null,"S"],[2,1,1,"Cumings, Mrs. John Bradley","female",38,1,0,"PC 17599",71.28,"C85","C"],[3,1,3,"Heikkinen, Miss. Laina","female",26,0,0,"STON/O2. 3101282",7.925,null,"S"],[4,1,1,"Futrelle, Mrs. Jacques Heath","female",35,1,0,"113803",53.1,"C123","S"],[5,0,3,"Allen, Mr. William Henry","male",35,0,0,"373450",8.05,null,"S"]],note:"Shows first 5 of 891 rows"},explanation:"SELECT * FROM table_name retrieves all columns and all rows from a table. The asterisk (*) is a wildcard that means 'everything'. This query returns all 891 passengers with all 12 columns."},{id:"d1q2",difficulty:"easy-medium",points:10,hintPenalty:3,title:"Two Columns",description:"Select only the **Name** and **Age** columns from the passengers table.",tableUsed:"passengers",columnsNeeded:["Name","Age"],hint:"List column names separated by commas: SELECT col1, col2 FROM table;",solution:"SELECT Name, Age FROM passengers;",alternativeSolutions:["SELECT Name, Age FROM passengers","select name, age from passengers;"],expectedResult:{columns:["Name","Age"],rowCount:891,preview:[["Braund, Mr. Owen Harris",22],["Cumings, Mrs. John Bradley",38],["Heikkinen, Miss. Laina",26],["Futrelle, Mrs. Jacques Heath",35],["Allen, Mr. William Henry",35],["Moran, Mr. James",null],["McCarthy, Mr. Timothy J",54],["Palsson, Master. Gosta Leonard",2],["Johnson, Mrs. Oscar W",27],["Nasser, Mrs. Nicholas",14]],note:"Shows first 10 of 891 rows. Note: some Ages are NULL (unknown)"},explanation:"By listing specific column names, you retrieve only those columns. This is more efficient than SELECT * when you don't need all data. The query returns 891 rows but only 2 columns."},{id:"d1q3",difficulty:"medium",points:15,hintPenalty:5,title:"Four Columns",description:"Select **PassengerId**, **Name**, **Sex**, and **Survived** from the passengers table.",tableUsed:"passengers",columnsNeeded:["PassengerId","Name","Sex","Survived"],hint:"List all four column names separated by commas. Watch the spelling - column names are case-sensitive in some databases!",solution:"SELECT PassengerId, Name, Sex, Survived FROM passengers;",alternativeSolutions:["SELECT PassengerId, Name, Sex, Survived FROM passengers"],expectedResult:{columns:["PassengerId","Name","Sex","Survived"],rowCount:891,preview:[[1,"Braund, Mr. Owen Harris","male",0],[2,"Cumings, Mrs. John Bradley","female",1],[3,"Heikkinen, Miss. Laina","female",1],[4,"Futrelle, Mrs. Jacques Heath","female",1],[5,"Allen, Mr. William Henry","male",0],[6,"Moran, Mr. James","male",0],[7,"McCarthy, Mr. Timothy J","male",0],[8,"Palsson, Master. Gosta Leonard","male",0],[9,"Johnson, Mrs. Oscar W","female",1],[10,"Nasser, Mrs. Nicholas","female",1]],note:"Shows first 10 of 891 rows. Survived: 0=Died, 1=Survived"},explanation:"You can select any number of columns by listing them. The order you specify is the order they appear in the results. This query shows passenger ID, name, gender, and survival status."},{id:"d1q4",difficulty:"medium-hard",points:20,hintPenalty:6,title:"Column Order Matters",description:"Select **Survived**, **Pclass**, and **Name** columns (in that exact order) from passengers.",tableUsed:"passengers",columnsNeeded:["Survived","Pclass","Name"],hint:"The order in SELECT determines output order. Put Survived first, then Pclass, then Name.",solution:"SELECT Survived, Pclass, Name FROM passengers;",alternativeSolutions:["SELECT Survived, Pclass, Name FROM passengers"],validateColumnOrder:!0,expectedResult:{columns:["Survived","Pclass","Name"],rowCount:891,preview:[[0,3,"Braund, Mr. Owen Harris"],[1,1,"Cumings, Mrs. John Bradley"],[1,3,"Heikkinen, Miss. Laina"],[1,1,"Futrelle, Mrs. Jacques Heath"],[0,3,"Allen, Mr. William Henry"],[0,3,"Moran, Mr. James"],[0,1,"McCarthy, Mr. Timothy J"],[0,3,"Palsson, Master. Gosta Leonard"],[1,2,"Johnson, Mrs. Oscar W"],[1,2,"Nasser, Mrs. Nicholas"]],note:"Shows first 10 of 891 rows. Notice Survived comes before Pclass."},explanation:"Column order in SELECT = column order in output. This matters when generating reports or exporting data where a specific format is required."},{id:"d1q5",difficulty:"hard",points:25,hintPenalty:8,title:"Passenger Profile",description:"Create a passenger profile by selecting: **Name**, **Age**, **Sex**, **Pclass**, **Fare**, and **Embarked**.",tableUsed:"passengers",columnsNeeded:["Name","Age","Sex","Pclass","Fare","Embarked"],hint:"Six columns total. Double-check spelling: Pclass (not Class), Embarked (not Port or Embarkation).",solution:"SELECT Name, Age, Sex, Pclass, Fare, Embarked FROM passengers;",alternativeSolutions:["SELECT Name, Age, Sex, Pclass, Fare, Embarked FROM passengers"],expectedResult:{columns:["Name","Age","Sex","Pclass","Fare","Embarked"],rowCount:891,preview:[["Braund, Mr. Owen Harris",22,"male",3,7.25,"S"],["Cumings, Mrs. John Bradley",38,"female",1,71.28,"C"],["Heikkinen, Miss. Laina",26,"female",3,7.925,"S"],["Futrelle, Mrs. Jacques Heath",35,"female",1,53.1,"S"],["Allen, Mr. William Henry",35,"male",3,8.05,"S"],["Moran, Mr. James",null,"male",3,8.4583,"Q"],["McCarthy, Mr. Timothy J",54,"male",1,51.8625,"S"],["Palsson, Master. Gosta Leonard",2,"male",3,21.075,"S"],["Johnson, Mrs. Oscar W",27,"female",2,11.1333,"S"],["Nasser, Mrs. Nicholas",14,"female",2,30.0708,"C"]],note:"Shows first 10 of 891 rows. Embarked: S=Southampton, C=Cherbourg, Q=Queenstown"},explanation:"Selecting multiple specific columns creates a focused view of the data. This 'passenger profile' query gives you the most relevant information about each passenger without the technical fields like Ticket or Cabin."}]},{day:2,week:1,title:"Column Aliases & DISTINCT",description:"Rename columns with AS and find unique values with DISTINCT",concepts:["AS","Aliases","DISTINCT","Unique values"],dataset:"titanic",tableUsed:"passengers",tableSchema:[{column:"Name",type:"TEXT",description:"Passenger name"},{column:"Pclass",type:"INTEGER",description:"1, 2, or 3"},{column:"Fare",type:"REAL",description:"Ticket price"},{column:"Embarked",type:"TEXT",description:"S, C, or Q"},{column:"Survived",type:"INTEGER",description:"0 or 1"}],lesson:'# Aliases and Unique Values 🏷️\n\n## Column Aliases with AS\n\nMake column names more readable:\n\n```sql\nSELECT Name AS passenger_name FROM passengers;\n```\n\nThe output column will be labeled "passenger_name" instead of "Name".\n\n## DISTINCT - Remove Duplicates\n\nFind unique values only:\n\n```sql\nSELECT DISTINCT Pclass FROM passengers;\n```\n\nReturns: 1, 2, 3 (each class appears only once)\n\n## Combining Both\n\n```sql\nSELECT DISTINCT Embarked AS port FROM passengers;\n```',questions:[{id:"d2q1",difficulty:"easy",points:5,hintPenalty:2,title:"Simple Alias",description:"Select the **Name** column and display it as **passenger_name** using an alias.",tableUsed:"passengers",columnsNeeded:["Name"],hint:"Use AS to create an alias: SELECT column AS new_name FROM table;",solution:"SELECT Name AS passenger_name FROM passengers;",alternativeSolutions:["SELECT Name AS passenger_name FROM passengers","SELECT Name as passenger_name FROM passengers;","SELECT Name passenger_name FROM passengers;"],expectedResult:{columns:["passenger_name"],rowCount:891,preview:[["Braund, Mr. Owen Harris"],["Cumings, Mrs. John Bradley"],["Heikkinen, Miss. Laina"],["Futrelle, Mrs. Jacques Heath"],["Allen, Mr. William Henry"],["Moran, Mr. James"],["McCarthy, Mr. Timothy J"],["Palsson, Master. Gosta Leonard"],["Johnson, Mrs. Oscar W"],["Nasser, Mrs. Nicholas"]],note:"Column header shows 'passenger_name' instead of 'Name'"},explanation:"AS creates an alias - a temporary display name for a column. The actual data and table structure aren't changed, just how the column appears in your results."},{id:"d2q2",difficulty:"easy-medium",points:10,hintPenalty:3,title:"Multiple Aliases",description:"Select **Name** as **passenger** and **Fare** as **ticket_price**.",tableUsed:"passengers",columnsNeeded:["Name","Fare"],hint:"Apply AS to each column: SELECT col1 AS alias1, col2 AS alias2 FROM table;",solution:"SELECT Name AS passenger, Fare AS ticket_price FROM passengers;",alternativeSolutions:["SELECT Name AS passenger, Fare AS ticket_price FROM passengers"],expectedResult:{columns:["passenger","ticket_price"],rowCount:891,preview:[["Braund, Mr. Owen Harris",7.25],["Cumings, Mrs. John Bradley",71.28],["Heikkinen, Miss. Laina",7.925],["Futrelle, Mrs. Jacques Heath",53.1],["Allen, Mr. William Henry",8.05],["Moran, Mr. James",8.4583],["McCarthy, Mr. Timothy J",51.8625],["Palsson, Master. Gosta Leonard",21.075],["Johnson, Mrs. Oscar W",11.1333],["Nasser, Mrs. Nicholas",30.0708]],note:"Both columns have user-friendly names"},explanation:"You can alias multiple columns in the same query. This makes reports more readable - 'ticket_price' is clearer than 'Fare' for non-technical users."},{id:"d2q3",difficulty:"medium",points:15,hintPenalty:5,title:"Unique Classes",description:"Find all **unique passenger classes** (Pclass). Each class should appear only once.",tableUsed:"passengers",columnsNeeded:["Pclass"],hint:"Use DISTINCT before the column name: SELECT DISTINCT column FROM table;",solution:"SELECT DISTINCT Pclass FROM passengers;",alternativeSolutions:["SELECT DISTINCT Pclass FROM passengers","SELECT DISTINCT(Pclass) FROM passengers;"],expectedResult:{columns:["Pclass"],rowCount:3,preview:[[3],[1],[2]],fullResult:!0,note:"Only 3 rows - one for each unique class"},explanation:"DISTINCT removes duplicate values. The Titanic had 3 passenger classes, so this returns exactly 3 rows regardless of how many passengers were in each class."},{id:"d2q4",difficulty:"medium-hard",points:20,hintPenalty:6,title:"DISTINCT with Alias",description:"Find all **unique embarkation ports** (Embarked) and display the column as **port**.",tableUsed:"passengers",columnsNeeded:["Embarked"],hint:"Combine DISTINCT and AS: SELECT DISTINCT column AS alias FROM table;",solution:"SELECT DISTINCT Embarked AS port FROM passengers;",alternativeSolutions:["SELECT DISTINCT Embarked AS port FROM passengers"],expectedResult:{columns:["port"],rowCount:4,preview:[["S"],["C"],["Q"],[null]],fullResult:!0,note:"S=Southampton, C=Cherbourg, Q=Queenstown, NULL=unknown"},explanation:"Three ports plus NULL (2 passengers with unknown port): Southampton (S), Cherbourg (C), and Queenstown (Q). NULL represents missing data."},{id:"d2q5",difficulty:"hard",points:25,hintPenalty:8,title:"Unique Combinations",description:"Find all **unique combinations** of **Pclass** and **Survived**. Display as **class** and **survived**.",tableUsed:"passengers",columnsNeeded:["Pclass","Survived"],hint:"DISTINCT works on multiple columns: SELECT DISTINCT col1, col2 FROM table. Add AS aliases to both columns.",solution:"SELECT DISTINCT Pclass AS class, Survived AS survived FROM passengers;",alternativeSolutions:["SELECT DISTINCT Pclass AS class, Survived AS survived FROM passengers"],expectedResult:{columns:["class","survived"],rowCount:6,preview:[[3,0],[1,1],[3,1],[1,0],[2,1],[2,0]],fullResult:!0,note:"6 combinations: 3 classes × 2 survival states"},explanation:"DISTINCT on multiple columns finds unique combinations. 3 classes × 2 outcomes (survived/died) = 6 possible combinations, and all 6 exist in the data."}]},{day:3,week:1,title:"Calculations & Expressions",description:"Perform math operations and create calculated columns",concepts:["Arithmetic operators","+","-","*","/","Calculated columns"],dataset:"titanic",tableUsed:"passengers",tableSchema:[{column:"Name",type:"TEXT",description:"Passenger name"},{column:"Age",type:"REAL",description:"Age in years"},{column:"Fare",type:"REAL",description:"Ticket price (£)"},{column:"SibSp",type:"INTEGER",description:"Siblings/spouses aboard"},{column:"Parch",type:"INTEGER",description:"Parents/children aboard"}],lesson:"# Calculations in SQL 🧮\n\n## Arithmetic in SELECT\n\n```sql\nSELECT Name, Fare, Fare * 100 AS fare_cents\nFROM passengers;\n```\n\n## Available Operators\n\n| Operator | Meaning | Example |\n|----------|---------|---------|\n| + | Addition | Age + 10 |\n| - | Subtraction | Fare - 5 |\n| * | Multiplication | Fare * 2 |\n| / | Division | Fare / 2 |\n\n## Family Size Example\n\n```sql\nSELECT Name, SibSp + Parch + 1 AS family_size\nFROM passengers;\n```\n\nThe +1 includes the passenger themselves.",questions:[{id:"d3q1",difficulty:"easy",points:5,hintPenalty:2,title:"Double the Fare",description:"Select **Name**, **Fare**, and calculate **Fare × 2** as **double_fare**.",tableUsed:"passengers",columnsNeeded:["Name","Fare","Fare * 2"],hint:"You can do math in SELECT: SELECT Name, Fare, Fare * 2 AS double_fare FROM passengers;",solution:"SELECT Name, Fare, Fare * 2 AS double_fare FROM passengers;",alternativeSolutions:["SELECT Name, Fare, Fare * 2 AS double_fare FROM passengers"],expectedResult:{columns:["Name","Fare","double_fare"],rowCount:891,preview:[["Braund, Mr. Owen Harris",7.25,14.5],["Cumings, Mrs. John Bradley",71.28,142.56],["Heikkinen, Miss. Laina",7.925,15.85],["Futrelle, Mrs. Jacques Heath",53.1,106.2],["Allen, Mr. William Henry",8.05,16.1]],note:"double_fare is exactly 2× the Fare value"},explanation:"SQL can perform arithmetic operations. The calculation creates a new column in your results without changing the actual table data."},{id:"d3q2",difficulty:"easy-medium",points:10,hintPenalty:3,title:"Convert to Cents",description:"Select **Name** and **Fare**, plus convert fare to cents (multiply by 100) as **fare_cents**.",tableUsed:"passengers",columnsNeeded:["Name","Fare","Fare * 100"],hint:"Multiply Fare by 100 and give it an alias: Fare * 100 AS fare_cents",solution:"SELECT Name, Fare, Fare * 100 AS fare_cents FROM passengers;",alternativeSolutions:["SELECT Name, Fare, Fare * 100 AS fare_cents FROM passengers"],expectedResult:{columns:["Name","Fare","fare_cents"],rowCount:891,preview:[["Braund, Mr. Owen Harris",7.25,725],["Cumings, Mrs. John Bradley",71.28,7128],["Heikkinen, Miss. Laina",7.925,792.5],["Futrelle, Mrs. Jacques Heath",53.1,5310],["Allen, Mr. William Henry",8.05,805]],note:"Fare in pounds × 100 = fare in cents/pence"},explanation:"Calculations in SELECT are useful for unit conversions. Here we convert pounds to pence (cents) without modifying the original data."},{id:"d3q3",difficulty:"medium",points:15,hintPenalty:5,title:"Family Size",description:"Calculate **family_size** by adding **SibSp + Parch + 1** (the +1 is for the passenger). Show Name and family_size.",tableUsed:"passengers",columnsNeeded:["Name","SibSp","Parch"],hint:"Add the columns: SibSp + Parch + 1 AS family_size. Don't forget the +1 for the passenger!",solution:"SELECT Name, SibSp + Parch + 1 AS family_size FROM passengers;",alternativeSolutions:["SELECT Name, SibSp + Parch + 1 AS family_size FROM passengers","SELECT Name, (SibSp + Parch + 1) AS family_size FROM passengers;"],expectedResult:{columns:["Name","family_size"],rowCount:891,preview:[["Braund, Mr. Owen Harris",2],["Cumings, Mrs. John Bradley",2],["Heikkinen, Miss. Laina",1],["Futrelle, Mrs. Jacques Heath",2],["Allen, Mr. William Henry",1],["Moran, Mr. James",1],["McCarthy, Mr. Timothy J",1],["Palsson, Master. Gosta Leonard",5],["Johnson, Mrs. Oscar W",3],["Nasser, Mrs. Nicholas",2]],note:"SibSp + Parch + 1 = total family members including the passenger"},explanation:"SibSp = siblings + spouse count, Parch = parents + children count. Adding 1 includes the passenger themselves in the family count."},{id:"d3q4",difficulty:"medium-hard",points:20,hintPenalty:6,title:"Fare Per Person",description:"Calculate **fare_per_person** by dividing **Fare** by family size (SibSp + Parch + 1). Show Name, Fare, and fare_per_person.",tableUsed:"passengers",columnsNeeded:["Name","Fare","SibSp","Parch"],hint:"Divide Fare by the family size: Fare / (SibSp + Parch + 1). Use parentheses!",solution:"SELECT Name, Fare, Fare / (SibSp + Parch + 1) AS fare_per_person FROM passengers;",alternativeSolutions:["SELECT Name, Fare, Fare / (SibSp + Parch + 1) AS fare_per_person FROM passengers"],expectedResult:{columns:["Name","Fare","fare_per_person"],rowCount:891,preview:[["Braund, Mr. Owen Harris",7.25,3.625],["Cumings, Mrs. John Bradley",71.28,35.64],["Heikkinen, Miss. Laina",7.925,7.925],["Futrelle, Mrs. Jacques Heath",53.1,26.55],["Allen, Mr. William Henry",8.05,8.05],["Moran, Mr. James",8.4583,8.4583],["McCarthy, Mr. Timothy J",51.8625,51.8625],["Palsson, Master. Gosta Leonard",21.075,4.215],["Johnson, Mrs. Oscar W",11.1333,3.71],["Nasser, Mrs. Nicholas",30.0708,15.04]],note:"Families often shared one ticket; this estimates per-person cost"},explanation:"Families typically bought one ticket for everyone. Dividing by family size estimates individual fare. The Palsson family (5 people) paid £21.075 total = £4.215 each."},{id:"d3q5",difficulty:"hard",points:25,hintPenalty:8,title:"Complete Profile",description:"Create a profile: **Name**, **Age**, **Pclass** as **class**, **family_size** (SibSp+Parch+1), and **fare_per_person** (Fare/family_size).",tableUsed:"passengers",columnsNeeded:["Name","Age","Pclass","SibSp","Parch","Fare"],hint:"Five columns with 2 aliases and 2 calculations. You'll need to write the family_size calculation twice or nest it.",solution:"SELECT Name, Age, Pclass AS class, SibSp + Parch + 1 AS family_size, Fare / (SibSp + Parch + 1) AS fare_per_person FROM passengers;",alternativeSolutions:["SELECT Name, Age, Pclass AS class, SibSp + Parch + 1 AS family_size, Fare / (SibSp + Parch + 1) AS fare_per_person FROM passengers"],expectedResult:{columns:["Name","Age","class","family_size","fare_per_person"],rowCount:891,preview:[["Braund, Mr. Owen Harris",22,3,2,3.625],["Cumings, Mrs. John Bradley",38,1,2,35.64],["Heikkinen, Miss. Laina",26,3,1,7.925],["Futrelle, Mrs. Jacques Heath",35,1,2,26.55],["Allen, Mr. William Henry",35,3,1,8.05]],note:"Combines aliases, calculations, and derived values"},explanation:"This query combines multiple techniques: aliases (Pclass AS class), calculations (SibSp + Parch + 1), and complex expressions (Fare / family_size) - all skills used in real-world reporting."}]},{day:4,week:1,title:"Filtering with WHERE",description:"Filter rows using conditions",concepts:["WHERE","=",">","<",">=","<=","!="],dataset:"titanic",tableUsed:"passengers",tableSchema:[{column:"Survived",type:"INTEGER",description:"0=Died, 1=Survived"},{column:"Pclass",type:"INTEGER",description:"1, 2, or 3"},{column:"Name",type:"TEXT",description:"Passenger name"},{column:"Sex",type:"TEXT",description:"'male' or 'female'"},{column:"Age",type:"REAL",description:"Age in years"},{column:"Fare",type:"REAL",description:"Ticket price"}],lesson:"# Filtering with WHERE 🔍\n\n## Basic Filtering\n\n```sql\nSELECT * FROM passengers WHERE Pclass = 1;\n```\n\nReturns only first-class passengers.\n\n## Comparison Operators\n\n| Operator | Meaning | Example |\n|----------|---------|---------|\n| = | Equal to | Pclass = 1 |\n| != or <> | Not equal | Pclass != 3 |\n| > | Greater than | Age > 30 |\n| < | Less than | Age < 18 |\n| >= | Greater or equal | Fare >= 50 |\n| <= | Less or equal | Age <= 10 |\n\n## Text Values Need Quotes\n\n```sql\nSELECT * FROM passengers WHERE Sex = 'female';\n```",questions:[{id:"d4q1",difficulty:"easy",points:5,hintPenalty:2,title:"Survivors Only",description:"Select all columns for passengers who **survived** (Survived = 1).",tableUsed:"passengers",columnsNeeded:["*"],filterCondition:"Survived = 1",hint:"Add WHERE after FROM: SELECT * FROM passengers WHERE Survived = 1;",solution:"SELECT * FROM passengers WHERE Survived = 1;",alternativeSolutions:["SELECT * FROM passengers WHERE Survived = 1"],expectedResult:{columns:["passenger_id","survived","pclass","name","sex","age","sibsp","parch","fare","embarked"],rowCount:342,preview:[[2,1,1,"Cumings, Mrs. John Bradley","female",38,1,0,"PC 17599",71.28,"C85","C"],[3,1,3,"Heikkinen, Miss. Laina","female",26,0,0,"STON/O2. 3101282",7.925,null,"S"],[4,1,1,"Futrelle, Mrs. Jacques Heath","female",35,1,0,"113803",53.1,"C123","S"],[9,1,2,"Johnson, Mrs. Oscar W","female",27,0,2,"347742",11.1333,null,"S"],[10,1,2,"Nasser, Mrs. Nicholas","female",14,1,0,"237736",30.0708,null,"C"]],note:"342 of 891 passengers survived (38.4%)"},explanation:"WHERE filters rows based on a condition. Only rows where Survived equals 1 are returned. 342 passengers survived out of 891 total."},{id:"d4q2",difficulty:"easy-medium",points:10,hintPenalty:3,title:"First Class",description:"Select **Name**, **Pclass**, and **Fare** for **first class** passengers (Pclass = 1).",tableUsed:"passengers",columnsNeeded:["Name","Pclass","Fare"],filterCondition:"Pclass = 1",hint:"Combine column selection with WHERE: SELECT Name, Pclass, Fare FROM passengers WHERE Pclass = 1;",solution:"SELECT Name, Pclass, Fare FROM passengers WHERE Pclass = 1;",alternativeSolutions:["SELECT Name, Pclass, Fare FROM passengers WHERE Pclass = 1"],expectedResult:{columns:["Name","Pclass","Fare"],rowCount:216,preview:[["Cumings, Mrs. John Bradley",1,71.28],["Futrelle, Mrs. Jacques Heath",1,53.1],["McCarthy, Mr. Timothy J",1,51.8625],["Fortune, Mr. Charles Alexander",1,263],["Sloper, Mr. William Thompson",1,35.5]],note:"216 first-class passengers"},explanation:"First class (Pclass = 1) was the most expensive. 216 passengers traveled in first class, with fares ranging from around £26 to over £500."},{id:"d4q3",difficulty:"medium",points:15,hintPenalty:5,title:"Adults Over 50",description:"Find passengers **older than 50**. Show **Name** and **Age**.",tableUsed:"passengers",columnsNeeded:["Name","Age"],filterCondition:"Age > 50",hint:"Use the greater than operator: WHERE Age > 50",solution:"SELECT Name, Age FROM passengers WHERE Age > 50;",alternativeSolutions:["SELECT Name, Age FROM passengers WHERE Age > 50"],expectedResult:{columns:["Name","Age"],rowCount:64,preview:[["McCarthy, Mr. Timothy J",54],["Fortune, Mr. Charles Alexander",64],["Sloper, Mr. William Thompson",56],["Bonnell, Miss. Elizabeth",58],["Warren, Mr. Charles William",68]],note:"64 passengers were over 50 years old"},explanation:"The > operator finds values greater than (not equal to) 50. The oldest passenger was 80 years old."},{id:"d4q4",difficulty:"medium-hard",points:20,hintPenalty:6,title:"Female Passengers",description:"Find all **female** passengers. Show **Name**, **Sex**, and **Age**.",tableUsed:"passengers",columnsNeeded:["Name","Sex","Age"],filterCondition:"Sex = 'female'",hint:"Text values need single quotes: WHERE Sex = 'female' (lowercase, in quotes)",solution:"SELECT Name, Sex, Age FROM passengers WHERE Sex = 'female';",alternativeSolutions:["SELECT Name, Sex, Age FROM passengers WHERE Sex = 'female'"],expectedResult:{columns:["Name","Sex","Age"],rowCount:314,preview:[["Cumings, Mrs. John Bradley","female",38],["Heikkinen, Miss. Laina","female",26],["Futrelle, Mrs. Jacques Heath","female",35],["Johnson, Mrs. Oscar W","female",27],["Nasser, Mrs. Nicholas","female",14]],note:"314 female passengers (35% of total)"},explanation:"Text/string values must be enclosed in single quotes. The value is case-sensitive: 'female' works, 'Female' or 'FEMALE' would not match."},{id:"d4q5",difficulty:"hard",points:25,hintPenalty:8,title:"Expensive Tickets",description:"Find passengers who paid **more than 100** for their ticket. Show **Name**, **Fare**, and **Pclass**.",tableUsed:"passengers",columnsNeeded:["Name","Fare","Pclass"],filterCondition:"Fare > 100",hint:"Numbers don't need quotes: WHERE Fare > 100",solution:"SELECT Name, Fare, Pclass FROM passengers WHERE Fare > 100;",alternativeSolutions:["SELECT Name, Fare, Pclass FROM passengers WHERE Fare > 100"],expectedResult:{columns:["Name","Fare","Pclass"],rowCount:40,preview:[["Fortune, Mr. Charles Alexander",263,1],["Baxter, Mr. Quigg Edmond",247.5208,1],["Astor, Col. John Jacob",227.525,1],["Cardeza, Mr. Thomas Drake Martinez",512.3292,1],["Ward, Miss. Anna",512.3292,1]],note:"40 passengers paid over £100 - all first class"},explanation:"Only 40 passengers paid over £100, and all were in first class. The highest fare was £512.33, paid by 3 passengers sharing a luxury suite."}]},{day:5,week:1,title:"Combining Conditions: AND & OR",description:"Use multiple conditions with logical operators",concepts:["AND","OR","Multiple conditions","Parentheses"],dataset:"titanic",tableUsed:"passengers",tableSchema:[{column:"Survived",type:"INTEGER",description:"0 or 1"},{column:"Pclass",type:"INTEGER",description:"1, 2, or 3"},{column:"Name",type:"TEXT",description:"Passenger name"},{column:"Sex",type:"TEXT",description:"'male' or 'female'"},{column:"Age",type:"REAL",description:"Age in years"},{column:"Fare",type:"REAL",description:"Ticket price"}],lesson:"# Combining Conditions 🔗\n\n## AND - Both must be true\n\n```sql\nSELECT * FROM passengers \nWHERE Sex = 'female' AND Survived = 1;\n```\n\n## OR - At least one must be true\n\n```sql\nSELECT * FROM passengers \nWHERE Pclass = 1 OR Pclass = 2;\n```\n\n## Using Parentheses\n\n```sql\nSELECT * FROM passengers \nWHERE (Pclass = 1 OR Pclass = 2) AND Survived = 1;\n```\n\nParentheses ensure the OR is evaluated first.",questions:[{id:"d5q1",difficulty:"easy",points:5,hintPenalty:2,title:"Female Survivors",description:"Find **female** passengers who **survived**. Show Name, Sex, and Survived.",tableUsed:"passengers",columnsNeeded:["Name","Sex","Survived"],filterCondition:"Sex = 'female' AND Survived = 1",hint:"Combine with AND: WHERE Sex = 'female' AND Survived = 1",solution:"SELECT Name, Sex, Survived FROM passengers WHERE Sex = 'female' AND Survived = 1;",alternativeSolutions:["SELECT Name, Sex, Survived FROM passengers WHERE Sex = 'female' AND Survived = 1"],expectedResult:{columns:["Name","Sex","Survived"],rowCount:233,preview:[["Cumings, Mrs. John Bradley","female",1],["Heikkinen, Miss. Laina","female",1],["Futrelle, Mrs. Jacques Heath","female",1],["Johnson, Mrs. Oscar W","female",1],["Nasser, Mrs. Nicholas","female",1]],note:"233 of 314 female passengers survived (74%)"},explanation:"AND requires both conditions to be true. 233 women survived out of 314 total women (74% survival rate for females)."},{id:"d5q2",difficulty:"easy-medium",points:10,hintPenalty:3,title:"Upper Classes",description:"Find passengers in **first OR second class**. Show Name and Pclass.",tableUsed:"passengers",columnsNeeded:["Name","Pclass"],filterCondition:"Pclass = 1 OR Pclass = 2",hint:"Use OR: WHERE Pclass = 1 OR Pclass = 2",solution:"SELECT Name, Pclass FROM passengers WHERE Pclass = 1 OR Pclass = 2;",alternativeSolutions:["SELECT Name, Pclass FROM passengers WHERE Pclass = 1 OR Pclass = 2","SELECT Name, Pclass FROM passengers WHERE Pclass IN (1, 2);"],expectedResult:{columns:["Name","Pclass"],rowCount:400,preview:[["Cumings, Mrs. John Bradley",1],["Futrelle, Mrs. Jacques Heath",1],["McCarthy, Mr. Timothy J",1],["Johnson, Mrs. Oscar W",2],["Nasser, Mrs. Nicholas",2]],note:"400 passengers: 216 first class + 184 second class"},explanation:"OR matches either condition. 216 first-class + 184 second-class = 400 passengers in upper classes."},{id:"d5q3",difficulty:"medium",points:15,hintPenalty:5,title:"Young Males",description:"Find **male** passengers **under 18**. Show Name, Sex, and Age.",tableUsed:"passengers",columnsNeeded:["Name","Sex","Age"],filterCondition:"Sex = 'male' AND Age < 18",hint:"Two conditions with AND: WHERE Sex = 'male' AND Age < 18",solution:"SELECT Name, Sex, Age FROM passengers WHERE Sex = 'male' AND Age < 18;",alternativeSolutions:["SELECT Name, Sex, Age FROM passengers WHERE Sex = 'male' AND Age < 18"],expectedResult:{columns:["Name","Sex","Age"],rowCount:64,preview:[["Palsson, Master. Gosta Leonard","male",2],["Moor, Master. Meier","male",6],["Rice, Master. Eugene","male",2],["Goodwin, Master. Sidney Leonard","male",1],["Goodwin, Master. William Frederick","male",11]],note:"64 male passengers under 18 (boys)"},explanation:"64 boys under 18 were aboard. Note the title 'Master' was used for young boys at that time."},{id:"d5q4",difficulty:"medium-hard",points:20,hintPenalty:6,title:"Third Class, High Fare",description:"Find **third class** passengers who paid **more than 20**. Show Name, Pclass, and Fare.",tableUsed:"passengers",columnsNeeded:["Name","Pclass","Fare"],filterCondition:"Pclass = 3 AND Fare > 20",hint:"WHERE Pclass = 3 AND Fare > 20",solution:"SELECT Name, Pclass, Fare FROM passengers WHERE Pclass = 3 AND Fare > 20;",alternativeSolutions:["SELECT Name, Pclass, Fare FROM passengers WHERE Pclass = 3 AND Fare > 20"],expectedResult:{columns:["Name","Pclass","Fare"],rowCount:26,preview:[["Palsson, Master. Gosta Leonard",3,21.075],["Andersson, Mr. Anders Johan",3,31.275],["Asplund, Mrs. Carl Oscar",3,31.3875],["Goodwin, Mrs. Frederick",3,46.9],["Rice, Mrs. William",3,29.125]],note:"26 third-class passengers paid over £20 (often large families)"},explanation:"Usually third class was cheap, but 26 passengers paid over £20 - likely because they were traveling as large families and the fare covered everyone."},{id:"d5q5",difficulty:"hard",points:25,hintPenalty:8,title:"Upper Class Survivors",description:"Find passengers who **survived** AND were in **first OR second class**. Show Name, Survived, and Pclass.",tableUsed:"passengers",columnsNeeded:["Name","Survived","Pclass"],filterCondition:"(Pclass = 1 OR Pclass = 2) AND Survived = 1",hint:"Use parentheses: WHERE Survived = 1 AND (Pclass = 1 OR Pclass = 2)",solution:"SELECT Name, Survived, Pclass FROM passengers WHERE Survived = 1 AND (Pclass = 1 OR Pclass = 2);",alternativeSolutions:["SELECT Name, Survived, Pclass FROM passengers WHERE (Pclass = 1 OR Pclass = 2) AND Survived = 1;"],expectedResult:{columns:["Name","Survived","Pclass"],rowCount:223,preview:[["Cumings, Mrs. John Bradley",1,1],["Futrelle, Mrs. Jacques Heath",1,1],["Johnson, Mrs. Oscar W",1,2],["Nasser, Mrs. Nicholas",1,2],["Fortune, Miss. Mabel Helen",1,1]],note:"223 survivors from first and second class"},explanation:"Parentheses ensure the OR is evaluated first. Without them, the query might be misinterpreted. 223 upper-class passengers survived: 136 from first class + 87 from second class."}]},{day:6,week:1,title:"Sorting with ORDER BY",description:"Sort results in ascending or descending order",concepts:["ORDER BY","ASC","DESC","Multiple column sorting"],dataset:"titanic",tableUsed:"passengers",tableSchema:[{column:"Name",type:"TEXT",description:"Passenger name"},{column:"Age",type:"REAL",description:"Age in years"},{column:"Fare",type:"REAL",description:"Ticket price"},{column:"Pclass",type:"INTEGER",description:"1, 2, or 3"}],lesson:"# Sorting Results 📊\n\n## Basic Sorting\n\n```sql\nSELECT * FROM passengers ORDER BY Age;\n```\n\nDefault is ASC (ascending: smallest to largest).\n\n## Descending Order\n\n```sql\nSELECT * FROM passengers ORDER BY Fare DESC;\n```\n\nDESC = largest to smallest.\n\n## Multiple Columns\n\n```sql\nSELECT * FROM passengers \nORDER BY Pclass ASC, Fare DESC;\n```\n\nSort by class first, then by fare within each class.",questions:[{id:"d6q1",difficulty:"easy",points:5,hintPenalty:2,title:"Sort by Age",description:"Select **Name** and **Age**, sorted by **Age** ascending (youngest first).",tableUsed:"passengers",columnsNeeded:["Name","Age"],hint:"Add ORDER BY at the end: SELECT ... FROM ... ORDER BY Age;",solution:"SELECT Name, Age FROM passengers ORDER BY Age;",alternativeSolutions:["SELECT Name, Age FROM passengers ORDER BY Age","SELECT Name, Age FROM passengers ORDER BY Age ASC;"],expectedResult:{columns:["Name","Age"],rowCount:891,preview:[["Thomas, Master. Assad Alexander",.42],["Hamalainen, Master. Viljo",.67],["Aks, Master. Philip Frank",.83],["Baclini, Miss. Marie Catherine",5],["Baclini, Miss. Eugenie",.75]],note:"Youngest: 0.42 years (about 5 months old). NULL ages appear at end."},explanation:"ORDER BY sorts results. Default is ASC (ascending). The youngest passenger was an infant just 5 months old."},{id:"d6q2",difficulty:"easy-medium",points:10,hintPenalty:3,title:"Highest Fares",description:"Select **Name** and **Fare**, sorted by **Fare descending** (highest first).",tableUsed:"passengers",columnsNeeded:["Name","Fare"],hint:"Use DESC: ORDER BY Fare DESC",solution:"SELECT Name, Fare FROM passengers ORDER BY Fare DESC;",alternativeSolutions:["SELECT Name, Fare FROM passengers ORDER BY Fare DESC"],expectedResult:{columns:["Name","Fare"],rowCount:891,preview:[["Ward, Miss. Anna",512.3292],["Cardeza, Mr. Thomas Drake Martinez",512.3292],["Lesurer, Mr. Gustave J",512.3292],["Baxter, Mr. Quigg Edmond",247.5208],["Astor, Col. John Jacob",227.525]],note:"Top 3 shared highest fare of £512.33 (likely shared a suite)"},explanation:"DESC reverses to descending order. Three passengers paid the highest fare of £512.33 - they likely shared a luxury suite."},{id:"d6q3",difficulty:"medium",points:15,hintPenalty:5,title:"Alphabetical Names",description:"Select **Name** and **Pclass**, sorted **alphabetically by Name**.",tableUsed:"passengers",columnsNeeded:["Name","Pclass"],hint:"Text sorts alphabetically: ORDER BY Name",solution:"SELECT Name, Pclass FROM passengers ORDER BY Name;",alternativeSolutions:["SELECT Name, Pclass FROM passengers ORDER BY Name","SELECT Name, Pclass FROM passengers ORDER BY Name ASC;"],expectedResult:{columns:["Name","Pclass"],rowCount:891,preview:[["Abbing, Mr. Anthony",3],["Abbott, Mr. Rossmore Edward",3],["Abbott, Mrs. Stanton",3],["Abelson, Mr. Samuel",2],["Abelson, Mrs. Samuel",2]],note:"Alphabetically by last name (surnames starting with A first)"},explanation:"ORDER BY works on text too, sorting alphabetically. Since names are in 'Last, First' format, they sort by last name."},{id:"d6q4",difficulty:"medium-hard",points:20,hintPenalty:6,title:"Class Then Fare",description:"Sort by **Pclass ascending**, then by **Fare descending** within each class. Show Name, Pclass, Fare.",tableUsed:"passengers",columnsNeeded:["Name","Pclass","Fare"],hint:"Multiple columns: ORDER BY Pclass ASC, Fare DESC",solution:"SELECT Name, Pclass, Fare FROM passengers ORDER BY Pclass ASC, Fare DESC;",alternativeSolutions:["SELECT Name, Pclass, Fare FROM passengers ORDER BY Pclass, Fare DESC;"],expectedResult:{columns:["Name","Pclass","Fare"],rowCount:891,preview:[["Ward, Miss. Anna",1,512.3292],["Cardeza, Mr. Thomas Drake Martinez",1,512.3292],["Lesurer, Mr. Gustave J",1,512.3292],["Baxter, Mr. Quigg Edmond",1,247.5208],["Astor, Col. John Jacob",1,227.525]],note:"First class (1) first with highest fares, then class 2, then class 3"},explanation:"Multiple column sort: first by Pclass (1, 2, 3), then within each class by Fare (highest first). First class passengers with highest fares appear at the top."},{id:"d6q5",difficulty:"hard",points:25,hintPenalty:8,title:"Filtered and Sorted",description:"Find **female survivors**, sorted by **Age descending** (oldest first). Show Name, Age, and Survived.",tableUsed:"passengers",columnsNeeded:["Name","Age","Survived"],filterCondition:"Sex = 'female' AND Survived = 1",hint:"First WHERE to filter, then ORDER BY to sort. The clause order matters!",solution:"SELECT Name, Age, Survived FROM passengers WHERE Sex = 'female' AND Survived = 1 ORDER BY Age DESC;",alternativeSolutions:["SELECT Name, Age, Survived FROM passengers WHERE Sex = 'female' AND Survived = 1 ORDER BY Age DESC"],expectedResult:{columns:["Name","Age","Survived"],rowCount:233,preview:[["Crosby, Mrs. Edward Gifford",64,1],["Warren, Mrs. Frank Manley",60,1],["Stone, Mrs. George Nelson",60,1],["Bonnell, Miss. Elizabeth",58,1],["Brown, Mrs. James Joseph",58,1]],note:"233 female survivors, oldest first (64 years). NULLs at end."},explanation:"WHERE filters first (233 female survivors), then ORDER BY sorts the results. The oldest female survivor was 64 years old."}]},{day:7,week:1,title:"LIMIT and OFFSET",description:"Control how many rows are returned and implement pagination",concepts:["LIMIT","OFFSET","Top N","Pagination"],dataset:"titanic",tableUsed:"passengers",tableSchema:[{column:"passenger_id",type:"INTEGER",description:"Unique ID"},{column:"name",type:"TEXT",description:"Passenger name"},{column:"age",type:"REAL",description:"Age in years"},{column:"fare",type:"REAL",description:"Ticket price"}],lesson:"# Limiting Results 📄\n\n## LIMIT - Restrict row count\n\n```sql\nSELECT * FROM passengers LIMIT 5;\n```\n\nReturns only the first 5 rows.\n\n## Top N with ORDER BY\n\n```sql\nSELECT Name, Fare FROM passengers\nORDER BY Fare DESC\nLIMIT 10;\n```\n\nGets the 10 highest fares.\n\n## OFFSET - Skip rows\n\n```sql\nSELECT * FROM passengers LIMIT 10 OFFSET 5;\n```\n\nSkips first 5 rows, returns next 10. Used for pagination.",questions:[{id:"d7q1",difficulty:"easy",points:5,hintPenalty:2,title:"First Five",description:"Select **all columns** for the **first 5 passengers**.",tableUsed:"passengers",columnsNeeded:["*"],hint:"Add LIMIT 5 at the end of your query.",solution:"SELECT * FROM passengers LIMIT 5;",alternativeSolutions:["SELECT * FROM passengers LIMIT 5"],expectedResult:{columns:["passenger_id","survived","pclass","name","sex","age","sibsp","parch","fare","embarked"],rowCount:5,preview:[[1,0,3,"Braund, Mr. Owen Harris","male",22,1,0,"A/5 21171",7.25,null,"S"],[2,1,1,"Cumings, Mrs. John Bradley","female",38,1,0,"PC 17599",71.28,"C85","C"],[3,1,3,"Heikkinen, Miss. Laina","female",26,0,0,"STON/O2. 3101282",7.925,null,"S"],[4,1,1,"Futrelle, Mrs. Jacques Heath","female",35,1,0,"113803",53.1,"C123","S"],[5,0,3,"Allen, Mr. William Henry","male",35,0,0,"373450",8.05,null,"S"]],fullResult:!0,note:"Exactly 5 rows returned"},explanation:"LIMIT restricts the output to a specific number of rows. Great for previewing large tables or testing queries."},{id:"d7q2",difficulty:"easy-medium",points:10,hintPenalty:3,title:"Top 10 Fares",description:"Find the **10 passengers** who paid the **highest fares**. Show Name and Fare.",tableUsed:"passengers",columnsNeeded:["Name","Fare"],hint:"ORDER BY Fare DESC, then LIMIT 10. Order matters!",solution:"SELECT Name, Fare FROM passengers ORDER BY Fare DESC LIMIT 10;",alternativeSolutions:["SELECT Name, Fare FROM passengers ORDER BY Fare DESC LIMIT 10"],expectedResult:{columns:["Name","Fare"],rowCount:10,preview:[["Ward, Miss. Anna",512.3292],["Cardeza, Mr. Thomas Drake Martinez",512.3292],["Lesurer, Mr. Gustave J",512.3292],["Baxter, Mr. Quigg Edmond",247.5208],["Astor, Col. John Jacob",227.525],["Chaffee, Mr. Herbert Fuller",227.525],["Douglas, Mrs. Frederick Charles",227.525],["Spedden, Mr. Frederic Oakley",134.5],["Fortune, Mrs. Mark",134.5],["Fortune, Miss. Ethel Flora",134.5]],fullResult:!0,note:"Top 10 highest fares - all first class passengers"},explanation:"ORDER BY + LIMIT is the 'Top N' pattern - very common in SQL. Sort first to rank, then limit to get the top records."},{id:"d7q3",difficulty:"medium",points:15,hintPenalty:5,title:"Youngest Five",description:"Find the **5 youngest passengers**. Show Name and Age.",tableUsed:"passengers",columnsNeeded:["Name","Age"],hint:"ORDER BY Age ASC (or just ORDER BY Age since ASC is default), then LIMIT 5",solution:"SELECT Name, Age FROM passengers ORDER BY Age LIMIT 5;",alternativeSolutions:["SELECT Name, Age FROM passengers ORDER BY Age ASC LIMIT 5;","SELECT Name, Age FROM passengers ORDER BY Age LIMIT 5"],expectedResult:{columns:["Name","Age"],rowCount:5,preview:[["Thomas, Master. Assad Alexander",.42],["Hamalainen, Master. Viljo",.67],["Baclini, Miss. Eugenie",.75],["Aks, Master. Philip Frank",.83],["Dean, Miss. Elizabeth Gladys",.92]],fullResult:!0,note:"Youngest were all infants under 1 year old"},explanation:"The 5 youngest passengers were all infants. Ages are in years, so 0.42 = about 5 months old."},{id:"d7q4",difficulty:"medium-hard",points:20,hintPenalty:6,title:"Skip and Take",description:"Get passengers **11-20** (skip first 10, return next 10). Show name and passenger_id.",tableUsed:"passengers",columnsNeeded:["name","passenger_id"],hint:"LIMIT 10 OFFSET 10. OFFSET skips rows, then LIMIT takes rows after.",solution:"SELECT name, passenger_id FROM passengers LIMIT 10 OFFSET 10;",alternativeSolutions:["SELECT name, passenger_id FROM passengers LIMIT 10 OFFSET 10","SELECT Name, Passenger_id FROM passengers LIMIT 10 OFFSET 10","SELECT NAME, PASSENGER_ID FROM passengers LIMIT 10 OFFSET 10"],expectedResult:{columns:["name","passenger_id"],rowCount:10,preview:[["Sandstrom, Miss. Marguerite Rut",11],["Bonnell, Miss. Elizabeth",12],["Saundercock, Mr. William Henry",13],["Andersson, Mr. Anders Johan",14],["Vestrom, Miss. Hulda Amanda Adolfina",15],["Hewlett, Mrs. Mary D Kingcome",16],["Rice, Master. Eugene",17],["Williams, Mr. Charles Eugene",18],["Vander Planke, Mrs. Julius",19],["Masselmani, Mrs. Fatima",20]],fullResult:!0,note:"Rows 11-20 (OFFSET 10 skips 1-10, LIMIT 10 takes next 10)"},explanation:"OFFSET skips the first N rows. OFFSET 10 LIMIT 10 returns rows 11-20. This is the basis for pagination in web applications."},{id:"d7q5",difficulty:"hard",points:25,hintPenalty:8,title:"Complex Pagination",description:"Find the **3rd through 7th highest fares** (skip top 2, get next 5). Show Name and Fare.",tableUsed:"passengers",columnsNeeded:["Name","Fare"],hint:"ORDER BY Fare DESC, then LIMIT 5 OFFSET 2 (skip top 2, take 5)",solution:"SELECT Name, Fare FROM passengers ORDER BY Fare DESC LIMIT 5 OFFSET 2;",alternativeSolutions:["SELECT Name, Fare FROM passengers ORDER BY Fare DESC LIMIT 5 OFFSET 2"],expectedResult:{columns:["Name","Fare"],rowCount:5,preview:[["Lesurer, Mr. Gustave J",512.3292],["Baxter, Mr. Quigg Edmond",247.5208],["Astor, Col. John Jacob",227.525],["Chaffee, Mr. Herbert Fuller",227.525],["Douglas, Mrs. Frederick Charles",227.525]],fullResult:!0,note:"Ranks 3-7 by fare (skipped the top 2)"},explanation:"Combines ORDER BY for ranking, OFFSET to skip the top 2, and LIMIT to take the next 5. Note: 3 passengers tied for highest fare at £512.33."}]},{day:8,week:2,title:"Aggregate Functions: COUNT & SUM",description:"Calculate totals and counts from your data",concepts:["COUNT","SUM","Aggregation"],dataset:"titanic",tableUsed:"passengers",tableSchema:[{column:"PassengerId",type:"INTEGER",description:"Unique ID (891 total)"},{column:"Survived",type:"INTEGER",description:"0=Died, 1=Survived"},{column:"Pclass",type:"INTEGER",description:"1, 2, or 3"},{column:"Age",type:"REAL",description:"Age (177 NULL)"},{column:"Fare",type:"REAL",description:"Ticket price"}],lesson:"# Aggregate Functions 📊\n\n## COUNT - Count rows\n\n```sql\nSELECT COUNT(*) FROM passengers;       -- All rows: 891\nSELECT COUNT(Age) FROM passengers;     -- Non-NULL ages: 714\n```\n\n## SUM - Add values\n\n```sql\nSELECT SUM(Fare) FROM passengers;      -- Total: £28,693.95\nSELECT SUM(Survived) FROM passengers;  -- Survivors: 342\n```\n\n## Always use aliases!\n\n```sql\nSELECT COUNT(*) AS total_passengers FROM passengers;\n```",questions:[{id:"d8q1",difficulty:"easy",points:5,hintPenalty:2,title:"Count All",description:"Count the **total number of passengers** in the dataset.",tableUsed:"passengers",aggregateFunction:"COUNT(*)",hint:"Use COUNT(*) to count all rows: SELECT COUNT(*) FROM passengers;",solution:"SELECT COUNT(*) FROM passengers;",alternativeSolutions:["SELECT COUNT(*) FROM passengers","SELECT COUNT(*) AS count FROM passengers;"],expectedResult:{columns:["COUNT(*)"],rowCount:1,preview:[[891]],fullResult:!0,note:"891 passengers in the Titanic dataset"},explanation:"COUNT(*) counts all rows regardless of NULL values. The Titanic dataset contains 891 passenger records."},{id:"d8q2",difficulty:"easy-medium",points:10,hintPenalty:3,title:"Count with Alias",description:"Count total passengers and display as **total_passengers**.",tableUsed:"passengers",aggregateFunction:"COUNT(*)",hint:"Add AS alias: SELECT COUNT(*) AS total_passengers FROM passengers;",solution:"SELECT COUNT(*) AS total_passengers FROM passengers;",alternativeSolutions:["SELECT COUNT(*) AS total_passengers FROM passengers"],expectedResult:{columns:["total_passengers"],rowCount:1,preview:[[891]],fullResult:!0,note:"Same result, but column named 'total_passengers'"},explanation:"Always use aliases with aggregates to make results more readable. 'total_passengers' is clearer than 'COUNT(*)'."},{id:"d8q3",difficulty:"medium",points:15,hintPenalty:5,title:"Sum of Survivors",description:"Calculate the **number of survivors** using SUM on the Survived column. Display as **survivors**.",tableUsed:"passengers",aggregateFunction:"SUM(Survived)",hint:"Since Survived is 0 or 1, SUM(Survived) counts survivors. Try: SELECT SUM(Survived) AS survivors FROM passengers;",solution:"SELECT SUM(Survived) AS survivors FROM passengers;",alternativeSolutions:["SELECT SUM(Survived) AS survivors FROM passengers"],expectedResult:{columns:["survivors"],rowCount:1,preview:[[342]],fullResult:!0,note:"342 passengers survived (38.4% survival rate)"},explanation:"Since Survived is 0 or 1, SUM counts the survivors (all the 1s add up). 342 out of 891 passengers survived."},{id:"d8q4",difficulty:"medium-hard",points:20,hintPenalty:6,title:"Total Revenue",description:"Calculate the **total of all fares** collected. Display as **total_revenue**.",tableUsed:"passengers",aggregateFunction:"SUM(Fare)",hint:"SUM(Fare) adds up all ticket prices.",solution:"SELECT SUM(Fare) AS total_revenue FROM passengers;",alternativeSolutions:["SELECT SUM(Fare) AS total_revenue FROM passengers"],expectedResult:{columns:["total_revenue"],rowCount:1,preview:[[28693.9493]],fullResult:!0,note:"Total fare revenue: approximately £28,694"},explanation:"SUM adds all values in a column. The Titanic collected about £28,694 in passenger fares."},{id:"d8q5",difficulty:"hard",points:25,hintPenalty:8,title:"Multiple Aggregates",description:"Show **total_passengers** (COUNT), **survivors** (SUM of Survived), and **total_fare** (SUM of Fare) in one query.",tableUsed:"passengers",aggregateFunction:"COUNT(*), SUM(Survived), SUM(Fare)",hint:"Multiple aggregates: SELECT COUNT(*) AS a, SUM(col1) AS b, SUM(col2) AS c FROM table;",solution:"SELECT COUNT(*) AS total_passengers, SUM(Survived) AS survivors, SUM(Fare) AS total_fare FROM passengers;",alternativeSolutions:["SELECT COUNT(*) AS total_passengers, SUM(Survived) AS survivors, SUM(Fare) AS total_fare FROM passengers"],expectedResult:{columns:["total_passengers","survivors","total_fare"],rowCount:1,preview:[[891,342,28693.9493]],fullResult:!0,note:"A summary dashboard in one query!"},explanation:"You can use multiple aggregate functions in one SELECT to create a summary. This is like a mini dashboard showing key metrics."}]},{day:9,week:2,title:"Aggregate Functions: AVG, MIN, MAX",description:"Calculate averages and find extreme values",concepts:["AVG","MIN","MAX","Statistics"],dataset:"titanic",tableUsed:"passengers",tableSchema:[{column:"Age",type:"REAL",description:"Age in years (177 NULL)"},{column:"Fare",type:"REAL",description:"Ticket price"},{column:"Survived",type:"INTEGER",description:"0 or 1"}],lesson:"# More Aggregate Functions 📈\n\n## AVG - Calculate average\n\n```sql\nSELECT AVG(Age) FROM passengers;  -- ~29.7 years\n```\n\nNote: AVG ignores NULL values.\n\n## MIN and MAX\n\n```sql\nSELECT MIN(Age), MAX(Age) FROM passengers;\n-- Returns: 0.42 and 80\n```\n\n## Survival Rate Trick\n\n```sql\nSELECT AVG(Survived) * 100 AS survival_rate\nFROM passengers;\n-- Returns: 38.38 (38.38%)\n```",questions:[{id:"d9q1",difficulty:"easy",points:5,hintPenalty:2,title:"Average Age",description:"Calculate the **average passenger age**. Display as **avg_age**.",tableUsed:"passengers",aggregateFunction:"AVG(Age)",hint:"Use AVG(Age): SELECT AVG(Age) AS avg_age FROM passengers;",solution:"SELECT AVG(Age) AS avg_age FROM passengers;",alternativeSolutions:["SELECT AVG(Age) AS avg_age FROM passengers"],expectedResult:{columns:["avg_age"],rowCount:1,preview:[[29.6991]],fullResult:!0,note:"Average age: ~29.7 years (NULL ages excluded from calculation)"},explanation:"AVG calculates the mean, ignoring NULL values. The average passenger age was about 30 years."},{id:"d9q2",difficulty:"easy-medium",points:10,hintPenalty:3,title:"Age Range",description:"Find the **youngest** (MIN) and **oldest** (MAX) passenger ages. Name them **youngest** and **oldest**.",tableUsed:"passengers",aggregateFunction:"MIN(Age), MAX(Age)",hint:"SELECT MIN(Age) AS youngest, MAX(Age) AS oldest FROM passengers;",solution:"SELECT MIN(Age) AS youngest, MAX(Age) AS oldest FROM passengers;",alternativeSolutions:["SELECT MIN(Age) AS youngest, MAX(Age) AS oldest FROM passengers"],expectedResult:{columns:["youngest","oldest"],rowCount:1,preview:[[.42,80]],fullResult:!0,note:"Youngest: 0.42 years (~5 months), Oldest: 80 years"},explanation:"MIN finds the smallest value, MAX finds the largest. The age range was 0.42 to 80 years."},{id:"d9q3",difficulty:"medium",points:15,hintPenalty:5,title:"Fare Statistics",description:"Calculate **min_fare**, **max_fare**, and **avg_fare**.",tableUsed:"passengers",aggregateFunction:"MIN(Fare), MAX(Fare), AVG(Fare)",hint:"Combine MIN, MAX, AVG in one query with aliases.",solution:"SELECT MIN(Fare) AS min_fare, MAX(Fare) AS max_fare, AVG(Fare) AS avg_fare FROM passengers;",alternativeSolutions:["SELECT MIN(Fare) AS min_fare, MAX(Fare) AS max_fare, AVG(Fare) AS avg_fare FROM passengers"],expectedResult:{columns:["min_fare","max_fare","avg_fare"],rowCount:1,preview:[[0,512.3292,32.2042]],fullResult:!0,note:"Min: £0 (free), Max: £512.33 (luxury suite), Avg: £32.20"},explanation:"Some passengers had free tickets (£0), while luxury suites cost £512.33. Average fare was about £32."},{id:"d9q4",difficulty:"medium-hard",points:20,hintPenalty:6,title:"Survival Rate",description:"Calculate the **survival rate as a percentage**: AVG(Survived) × 100. Display as **survival_rate_pct**.",tableUsed:"passengers",aggregateFunction:"AVG(Survived) * 100",hint:"Since Survived is 0 or 1, AVG gives the proportion. Multiply by 100 for percentage.",solution:"SELECT AVG(Survived) * 100 AS survival_rate_pct FROM passengers;",alternativeSolutions:["SELECT AVG(Survived) * 100 AS survival_rate_pct FROM passengers"],expectedResult:{columns:["survival_rate_pct"],rowCount:1,preview:[[38.3838]],fullResult:!0,note:"38.38% of passengers survived"},explanation:"AVG of a 0/1 column gives the proportion. Multiply by 100 for percentage. About 38.4% of passengers survived."},{id:"d9q5",difficulty:"hard",points:25,hintPenalty:8,title:"Complete Statistics",description:"Create a summary: **total** (COUNT), **survivors** (SUM), **survival_rate** (AVG×100), **avg_age**, and **avg_fare**.",tableUsed:"passengers",aggregateFunction:"COUNT, SUM, AVG",hint:"Five aggregates in one SELECT with appropriate aliases.",solution:"SELECT COUNT(*) AS total, SUM(Survived) AS survivors, AVG(Survived) * 100 AS survival_rate, AVG(Age) AS avg_age, AVG(Fare) AS avg_fare FROM passengers;",alternativeSolutions:["SELECT COUNT(*) AS total, SUM(Survived) AS survivors, AVG(Survived) * 100 AS survival_rate, AVG(Age) AS avg_age, AVG(Fare) AS avg_fare FROM passengers"],expectedResult:{columns:["total","survivors","survival_rate","avg_age","avg_fare"],rowCount:1,preview:[[891,342,38.3838,29.6991,32.2042]],fullResult:!0,note:"Complete Titanic statistics dashboard"},explanation:"This creates a comprehensive statistics dashboard: 891 passengers, 342 survived (38.4%), average age 30, average fare £32."}]},{day:10,week:2,title:"GROUP BY Basics",description:"Group data and calculate aggregates per group",concepts:["GROUP BY","Per-group aggregates"],dataset:"titanic",tableUsed:"passengers",tableSchema:[{column:"Pclass",type:"INTEGER",description:"1, 2, or 3"},{column:"Sex",type:"TEXT",description:"'male' or 'female'"},{column:"Survived",type:"INTEGER",description:"0 or 1"},{column:"Age",type:"REAL",description:"Age in years"},{column:"Fare",type:"REAL",description:"Ticket price"}],lesson:"# GROUP BY - Per-Group Statistics 📊\n\n## Basic GROUP BY\n\n```sql\nSELECT Pclass, COUNT(*) AS count\nFROM passengers\nGROUP BY Pclass;\n```\n\nReturns one row per class with count.\n\n## Rule\n\nEvery column in SELECT must either:\n1. Be in GROUP BY, OR\n2. Be inside an aggregate function\n\n## Example\n\n```sql\nSELECT Sex, AVG(Age) AS avg_age\nFROM passengers\nGROUP BY Sex;\n```",questions:[{id:"d10q1",difficulty:"easy",points:5,hintPenalty:2,title:"Count by Class",description:"Count how many passengers were in **each class**. Show Pclass and count.",tableUsed:"passengers",aggregateFunction:"COUNT(*)",groupBy:"Pclass",hint:"GROUP BY Pclass: SELECT Pclass, COUNT(*) AS count FROM passengers GROUP BY Pclass;",solution:"SELECT Pclass, COUNT(*) AS count FROM passengers GROUP BY Pclass;",alternativeSolutions:["SELECT Pclass, COUNT(*) AS count FROM passengers GROUP BY Pclass"],expectedResult:{columns:["Pclass","count"],rowCount:3,preview:[[1,216],[2,184],[3,491]],fullResult:!0,note:"1st: 216, 2nd: 184, 3rd: 491 passengers"},explanation:"GROUP BY creates separate buckets. Each class gets its own count: 216 in 1st, 184 in 2nd, 491 in 3rd class."},{id:"d10q2",difficulty:"easy-medium",points:10,hintPenalty:3,title:"Count by Gender",description:"Count passengers by **Sex**. Show Sex and count as **total**.",tableUsed:"passengers",aggregateFunction:"COUNT(*)",groupBy:"Sex",hint:"GROUP BY Sex with COUNT(*) AS total",solution:"SELECT Sex, COUNT(*) AS total FROM passengers GROUP BY Sex;",alternativeSolutions:["SELECT Sex, COUNT(*) AS total FROM passengers GROUP BY Sex"],expectedResult:{columns:["Sex","total"],rowCount:2,preview:[["female",314],["male",577]],fullResult:!0,note:"314 female, 577 male passengers"},explanation:"314 women and 577 men were aboard - about 35% female, 65% male."},{id:"d10q3",difficulty:"medium",points:15,hintPenalty:5,title:"Average Fare by Class",description:"Calculate **average fare** for each **Pclass**. Show Pclass and avg_fare.",tableUsed:"passengers",aggregateFunction:"AVG(Fare)",groupBy:"Pclass",hint:"Use AVG(Fare) with GROUP BY Pclass",solution:"SELECT Pclass, AVG(Fare) AS avg_fare FROM passengers GROUP BY Pclass;",alternativeSolutions:["SELECT Pclass, AVG(Fare) AS avg_fare FROM passengers GROUP BY Pclass"],expectedResult:{columns:["Pclass","avg_fare"],rowCount:3,preview:[[1,84.1547],[2,20.6622],[3,13.6756]],fullResult:!0,note:"1st: £84, 2nd: £21, 3rd: £14 average fare"},explanation:"First class averaged £84, second £21, third £14. First class was ~6× more expensive than third!"},{id:"d10q4",difficulty:"medium-hard",points:20,hintPenalty:6,title:"Survival by Gender",description:"Calculate **survival rate** (AVG×100) and **survivor count** for each **Sex**. Show Sex, survival_rate, and survivors.",tableUsed:"passengers",aggregateFunction:"AVG(Survived) * 100, SUM(Survived)",groupBy:"Sex",hint:"GROUP BY Sex with AVG(Survived)*100 and SUM(Survived)",solution:"SELECT Sex, AVG(Survived) * 100 AS survival_rate, SUM(Survived) AS survivors FROM passengers GROUP BY Sex;",alternativeSolutions:["SELECT Sex, AVG(Survived) * 100 AS survival_rate, SUM(Survived) AS survivors FROM passengers GROUP BY Sex"],expectedResult:{columns:["Sex","survival_rate","survivors"],rowCount:2,preview:[["female",74.2038,233],["male",18.8908,109]],fullResult:!0,note:"Women: 74% survived. Men: only 19% survived."},explanation:"Women had 74% survival rate, men only 19%. The 'women and children first' policy is clearly visible in the data."},{id:"d10q5",difficulty:"hard",points:25,hintPenalty:8,title:"Class Statistics",description:"For each **Pclass**, show: **total** passengers, **survivors**, **survival_rate** (%), and **avg_age**.",tableUsed:"passengers",aggregateFunction:"COUNT(*), SUM(Survived), AVG(Survived)*100, AVG(Age)",groupBy:"Pclass",hint:"Four aggregates with GROUP BY Pclass",solution:"SELECT Pclass, COUNT(*) AS total, SUM(Survived) AS survivors, AVG(Survived) * 100 AS survival_rate, AVG(Age) AS avg_age FROM passengers GROUP BY Pclass;",alternativeSolutions:["SELECT Pclass, COUNT(*) AS total, SUM(Survived) AS survivors, AVG(Survived) * 100 AS survival_rate, AVG(Age) AS avg_age FROM passengers GROUP BY Pclass"],expectedResult:{columns:["Pclass","total","survivors","survival_rate","avg_age"],rowCount:3,preview:[[1,216,136,62.963,38.2334],[2,184,87,47.2826,29.8776],[3,491,119,24.2363,25.1406]],fullResult:!0,note:"1st: 63% survival, 2nd: 47%, 3rd: only 24%"},explanation:"Class mattered for survival: 1st class 63%, 2nd class 47%, 3rd class only 24%. First class was also older on average."}]},{day:11,week:2,title:"HAVING Clause",description:"Filter groups after aggregation",concepts:["HAVING","WHERE vs HAVING","Group filtering"],dataset:"titanic",tableUsed:"passengers",tableSchema:[{column:"Pclass",type:"INTEGER",description:"1, 2, or 3"},{column:"Sex",type:"TEXT",description:"'male' or 'female'"},{column:"Embarked",type:"TEXT",description:"S, C, Q, or NULL"},{column:"Survived",type:"INTEGER",description:"0 or 1"},{column:"Fare",type:"REAL",description:"Ticket price"}],lesson:"# HAVING - Filter After Grouping 🔍\n\n## WHERE vs HAVING\n\n- **WHERE**: Filters rows BEFORE grouping\n- **HAVING**: Filters groups AFTER aggregation\n\n```sql\nSELECT Pclass, COUNT(*) AS count\nFROM passengers\nGROUP BY Pclass\nHAVING COUNT(*) > 200;\n```\n\n## Using Both\n\n```sql\nSELECT Embarked, COUNT(*) AS count\nFROM passengers\nWHERE Age > 18\nGROUP BY Embarked\nHAVING COUNT(*) > 100;\n```",questions:[{id:"d11q1",difficulty:"easy",points:5,hintPenalty:2,title:"Large Groups",description:"Find embarkation ports with **more than 100 passengers**. Show Embarked and count.",tableUsed:"passengers",aggregateFunction:"COUNT(*)",groupBy:"Embarked",having:"COUNT(*) > 100",hint:"GROUP BY Embarked, then HAVING COUNT(*) > 100",solution:"SELECT Embarked, COUNT(*) AS count FROM passengers GROUP BY Embarked HAVING COUNT(*) > 100;",alternativeSolutions:["SELECT Embarked, COUNT(*) AS count FROM passengers GROUP BY Embarked HAVING COUNT(*) > 100"],expectedResult:{columns:["Embarked","count"],rowCount:2,preview:[["C",168],["S",644]],fullResult:!0,note:"Cherbourg (168) and Southampton (644) had 100+ passengers"},explanation:"HAVING filters groups after aggregation. Southampton (S) and Cherbourg (C) had over 100 passengers. Queenstown (Q) had only 77."},{id:"d11q2",difficulty:"easy-medium",points:10,hintPenalty:3,title:"High Survival Groups",description:"Find groups by **Sex** where **survival rate > 50%**. Show Sex and survival_rate.",tableUsed:"passengers",aggregateFunction:"AVG(Survived) * 100",groupBy:"Sex",having:"AVG(Survived) > 0.5",hint:"HAVING AVG(Survived) > 0.5 (or > 0.50 for 50%)",solution:"SELECT Sex, AVG(Survived) * 100 AS survival_rate FROM passengers GROUP BY Sex HAVING AVG(Survived) > 0.5;",alternativeSolutions:["SELECT Sex, AVG(Survived) * 100 AS survival_rate FROM passengers GROUP BY Sex HAVING AVG(Survived) > 0.5"],expectedResult:{columns:["Sex","survival_rate"],rowCount:1,preview:[["female",74.2038]],fullResult:!0,note:"Only females had >50% survival rate"},explanation:"Only females had over 50% survival rate (74%). Males had only 19% survival rate."},{id:"d11q3",difficulty:"medium",points:15,hintPenalty:5,title:"Expensive Classes",description:"Find classes where **average fare > 30**. Show Pclass and avg_fare.",tableUsed:"passengers",aggregateFunction:"AVG(Fare)",groupBy:"Pclass",having:"AVG(Fare) > 30",hint:"GROUP BY Pclass, HAVING AVG(Fare) > 30",solution:"SELECT Pclass, AVG(Fare) AS avg_fare FROM passengers GROUP BY Pclass HAVING AVG(Fare) > 30;",alternativeSolutions:["SELECT Pclass, AVG(Fare) AS avg_fare FROM passengers GROUP BY Pclass HAVING AVG(Fare) > 30"],expectedResult:{columns:["Pclass","avg_fare"],rowCount:1,preview:[[1,84.1547]],fullResult:!0,note:"Only first class had average fare over £30"},explanation:"Only first class (avg £84) exceeds £30 average fare. Second class was £21, third was £14."},{id:"d11q4",difficulty:"medium-hard",points:20,hintPenalty:6,title:"WHERE and HAVING",description:"Count **adult** passengers (Age >= 18) per class, but only show classes with **more than 100 adults**.",tableUsed:"passengers",filterCondition:"Age >= 18",aggregateFunction:"COUNT(*)",groupBy:"Pclass",having:"COUNT(*) > 100",hint:"WHERE Age >= 18 (before GROUP BY), HAVING COUNT(*) > 100 (after)",solution:"SELECT Pclass, COUNT(*) AS adult_count FROM passengers WHERE Age >= 18 GROUP BY Pclass HAVING COUNT(*) > 100;",alternativeSolutions:["SELECT Pclass, COUNT(*) AS adult_count FROM passengers WHERE Age >= 18 GROUP BY Pclass HAVING COUNT(*) > 100"],expectedResult:{columns:["Pclass","adult_count"],rowCount:2,preview:[[1,175],[3,276]],fullResult:!0,note:"Classes 1 and 3 had 100+ adults (class 2 had only 97)"},explanation:"WHERE filters rows first (adults only), GROUP BY groups them, HAVING filters groups (100+ adults). Second class had only 97 adults."},{id:"d11q5",difficulty:"hard",points:25,hintPenalty:8,title:"Complex Group Filter",description:"Group by **Embarked**: show port, count, and avg_fare. Only include ports with **count > 50** AND **avg_fare > 20**.",tableUsed:"passengers",aggregateFunction:"COUNT(*), AVG(Fare)",groupBy:"Embarked",having:"COUNT(*) > 50 AND AVG(Fare) > 20",hint:"Two conditions in HAVING: HAVING COUNT(*) > 50 AND AVG(Fare) > 20",solution:"SELECT Embarked, COUNT(*) AS count, AVG(Fare) AS avg_fare FROM passengers GROUP BY Embarked HAVING COUNT(*) > 50 AND AVG(Fare) > 20;",alternativeSolutions:["SELECT Embarked, COUNT(*) AS count, AVG(Fare) AS avg_fare FROM passengers GROUP BY Embarked HAVING COUNT(*) > 50 AND AVG(Fare) > 20"],expectedResult:{columns:["Embarked","count","avg_fare"],rowCount:2,preview:[["C",168,59.9541],["S",644,27.0798]],fullResult:!0,note:"Cherbourg and Southampton meet both criteria"},explanation:"Cherbourg (C) and Southampton (S) both have 50+ passengers and avg fare over £20. Queenstown (Q) had low average fare."}]},{day:12,week:2,title:"LIKE & Pattern Matching",description:"Search for patterns in text data",concepts:["LIKE","%","_","Pattern matching"],dataset:"titanic",tableUsed:"passengers",tableSchema:[{column:"Name",type:"TEXT",description:"Full name with title"},{column:"Ticket",type:"TEXT",description:"Ticket number"},{column:"Cabin",type:"TEXT",description:"Cabin number"}],lesson:"# Pattern Matching with LIKE 🔎\n\n## Wildcards\n\n- **%** matches any sequence (0 or more characters)\n- **_** matches exactly one character\n\n## Examples\n\n```sql\n-- Names starting with 'A'\nSELECT * FROM passengers WHERE Name LIKE 'A%';\n\n-- Names containing 'Mrs.'\nSELECT * FROM passengers WHERE Name LIKE '%Mrs.%';\n\n-- Names ending with 'son'\nSELECT * FROM passengers WHERE Name LIKE '%son';\n```",questions:[{id:"d12q1",difficulty:"easy",points:5,hintPenalty:2,title:"Names Starting With B",description:"Find passengers whose **Name starts with 'B'**. Show Name only.",tableUsed:"passengers",columnsNeeded:["Name"],filterCondition:"Name LIKE 'B%'",hint:"LIKE 'B%' - B followed by anything",solution:"SELECT Name FROM passengers WHERE Name LIKE 'B%';",alternativeSolutions:["SELECT Name FROM passengers WHERE Name LIKE 'B%'"],expectedResult:{columns:["Name"],rowCount:72,preview:[["Braund, Mr. Owen Harris"],["Bonnell, Miss. Elizabeth"],["Backstrom, Mrs. Karl Alfred"],["Baxter, Mr. Quigg Edmond"],["Becker, Mrs. Allen Oliver"]],note:"72 passengers have names starting with B"},explanation:"LIKE 'B%' matches any string starting with B. The % matches everything that comes after."},{id:"d12q2",difficulty:"easy-medium",points:10,hintPenalty:3,title:"Married Women",description:"Find passengers with **'Mrs.'** in their name. Show Name.",tableUsed:"passengers",columnsNeeded:["Name"],filterCondition:"Name LIKE '%Mrs.%'",hint:"Use % on both sides: '%Mrs.%' to find it anywhere in the name",solution:"SELECT Name FROM passengers WHERE Name LIKE '%Mrs.%';",alternativeSolutions:["SELECT Name FROM passengers WHERE Name LIKE '%Mrs.%'"],expectedResult:{columns:["Name"],rowCount:129,preview:[["Cumings, Mrs. John Bradley"],["Futrelle, Mrs. Jacques Heath"],["Johnson, Mrs. Oscar W"],["Nasser, Mrs. Nicholas"],["Hewlett, Mrs. Mary D Kingcome"]],note:"129 married women (Mrs.) aboard"},explanation:"% on both sides finds the pattern anywhere in the string. 'Mrs.' indicates married women in Victorian naming conventions."},{id:"d12q3",difficulty:"medium",points:15,hintPenalty:5,title:"Scandinavian Names",description:"Find passengers whose **Name ends with 'son'**. Show Name.",tableUsed:"passengers",columnsNeeded:["Name"],filterCondition:"Name LIKE '%son'",hint:"LIKE '%son' - anything followed by 'son' at the end",solution:"SELECT Name FROM passengers WHERE Name LIKE '%son';",alternativeSolutions:["SELECT Name FROM passengers WHERE Name LIKE '%son'"],expectedResult:{columns:["Name"],rowCount:32,preview:[["Andersson, Mr. Anders Johan"],["Johnson, Mrs. Oscar W"],["Olsson, Miss. Elina"],["Nilsson, Mr. August Ferdinand"],["Svensson, Mr. Johan"]],note:"32 passengers with names ending in 'son' (common Scandinavian pattern)"},explanation:"Many Scandinavian names end in 'son' (meaning 'son of'): Johnson, Andersson, Nilsson, etc."},{id:"d12q4",difficulty:"medium-hard",points:20,hintPenalty:6,title:"Young Boys",description:"Find passengers with **'Master'** in their name (title for young boys). Show Name and Age.",tableUsed:"passengers",columnsNeeded:["Name","Age"],filterCondition:"Name LIKE '%Master%'",hint:"'Master' was the title for young boys. Use %Master%",solution:"SELECT Name, Age FROM passengers WHERE Name LIKE '%Master%';",alternativeSolutions:["SELECT Name, Age FROM passengers WHERE Name LIKE '%Master%'"],expectedResult:{columns:["Name","Age"],rowCount:40,preview:[["Palsson, Master. Gosta Leonard",2],["Moor, Master. Meier",6],["Rice, Master. Eugene",2],["Goodwin, Master. Sidney Leonard",1],["Goodwin, Master. William Frederick",11]],note:"40 young boys with title 'Master'"},explanation:"'Master' was the historical title for boys. 40 boys under the title 'Master' were aboard."},{id:"d12q5",difficulty:"hard",points:25,hintPenalty:8,title:"Multiple Patterns",description:"Find passengers whose name **starts with 'S'** AND **contains 'Miss'**. Show Name.",tableUsed:"passengers",columnsNeeded:["Name"],filterCondition:"Name LIKE 'S%' AND Name LIKE '%Miss%'",hint:"Combine two LIKE conditions with AND",solution:"SELECT Name FROM passengers WHERE Name LIKE 'S%' AND Name LIKE '%Miss%';",alternativeSolutions:["SELECT Name FROM passengers WHERE Name LIKE 'S%' AND Name LIKE '%Miss%'"],expectedResult:{columns:["Name"],rowCount:12,preview:[["Sandstrom, Miss. Marguerite Rut"],["Sjoblom, Miss. Anna Sofia"],["Strom, Miss. Telma Matilda"],["Skoog, Miss. Mabel"],["Skoog, Miss. Margit Elizabeth"]],note:"12 unmarried women (Miss) with last names starting with S"},explanation:"Combining patterns: name starts with S (last name) and contains 'Miss' (unmarried woman). 12 passengers match."}]},{day:13,week:2,title:"Working with NULL",description:"Handle missing values in your queries",concepts:["NULL","IS NULL","IS NOT NULL","COALESCE"],dataset:"titanic",tableUsed:"passengers",tableSchema:[{column:"Name",type:"TEXT",description:"Passenger name"},{column:"Age",type:"REAL",description:"Age (177 NULL values)"},{column:"Cabin",type:"TEXT",description:"Cabin (687 NULL values)"},{column:"Embarked",type:"TEXT",description:"Port (2 NULL values)"}],lesson:'# Handling NULL Values ❓\n\nNULL means "unknown" or "missing" - NOT zero or empty string.\n\n## Check for NULL\n\n```sql\nSELECT * FROM passengers WHERE Age IS NULL;\nSELECT * FROM passengers WHERE Age IS NOT NULL;\n```\n\n⚠️ **Important**: = NULL doesn\'t work! Always use IS NULL.\n\n## COALESCE - Replace NULL\n\n```sql\nSELECT Name, COALESCE(Age, 0) AS age\nFROM passengers;\n```\n\nReturns Age if not null, otherwise 0.',questions:[{id:"d13q1",difficulty:"easy",points:5,hintPenalty:2,title:"Missing Ages",description:"Find passengers with **unknown age** (Age IS NULL). Show Name only.",tableUsed:"passengers",columnsNeeded:["Name"],filterCondition:"Age IS NULL",hint:"Use IS NULL, not = NULL: WHERE Age IS NULL",solution:"SELECT Name FROM passengers WHERE Age IS NULL;",alternativeSolutions:["SELECT Name FROM passengers WHERE Age IS NULL"],expectedResult:{columns:["Name"],rowCount:177,preview:[["Moran, Mr. James"],["Storey, Mr. Thomas"],["Lam, Mr. Ali"],["Connolly, Miss. Kate"],["Parkes, Mr. Francis"]],note:"177 passengers have no recorded age"},explanation:"IS NULL finds rows where the value is missing. 177 passengers had no recorded age."},{id:"d13q2",difficulty:"easy-medium",points:10,hintPenalty:3,title:"Known Ages",description:"Find passengers with **known age** (Age IS NOT NULL). Show Name and Age.",tableUsed:"passengers",columnsNeeded:["Name","Age"],filterCondition:"Age IS NOT NULL",hint:"IS NOT NULL finds non-missing values",solution:"SELECT Name, Age FROM passengers WHERE Age IS NOT NULL;",alternativeSolutions:["SELECT Name, Age FROM passengers WHERE Age IS NOT NULL"],expectedResult:{columns:["Name","Age"],rowCount:714,preview:[["Braund, Mr. Owen Harris",22],["Cumings, Mrs. John Bradley",38],["Heikkinen, Miss. Laina",26],["Futrelle, Mrs. Jacques Heath",35],["Allen, Mr. William Henry",35]],note:"714 passengers have recorded ages (891 - 177 = 714)"},explanation:"714 of 891 passengers have recorded ages. IS NOT NULL finds non-missing values."},{id:"d13q3",difficulty:"medium",points:15,hintPenalty:5,title:"Has Embarked",description:"Count passengers **with** an embarkation port recorded (embarked IS NOT NULL).",tableUsed:"passengers",aggregateFunction:"COUNT(*)",filterCondition:"embarked IS NOT NULL",hint:"WHERE embarked IS NOT NULL with COUNT(*)",solution:"SELECT COUNT(*) AS has_embarked FROM passengers WHERE embarked IS NOT NULL;",alternativeSolutions:["SELECT COUNT(*) AS has_embarked FROM passengers WHERE embarked IS NOT NULL"],expectedResult:{columns:["has_embarked"],rowCount:1,preview:[[889]],fullResult:!0,note:"889 of 891 passengers had embarkation port recorded"},explanation:"889 passengers (99.8%) had their embarkation port recorded - only 2 were missing."},{id:"d13q4",difficulty:"medium-hard",points:20,hintPenalty:6,title:"Replace NULL Age",description:"Show Name and Age, but **replace NULL ages with 0** using COALESCE. Call it **age_filled**.",tableUsed:"passengers",columnsNeeded:["Name","Age"],hint:"COALESCE(Age, 0) returns Age if not null, else 0",solution:"SELECT Name, COALESCE(Age, 0) AS age_filled FROM passengers;",alternativeSolutions:["SELECT Name, COALESCE(Age, 0) AS age_filled FROM passengers"],expectedResult:{columns:["Name","age_filled"],rowCount:891,preview:[["Braund, Mr. Owen Harris",22],["Cumings, Mrs. John Bradley",38],["Heikkinen, Miss. Laina",26],["Futrelle, Mrs. Jacques Heath",35],["Allen, Mr. William Henry",35],["Moran, Mr. James",0]],note:"NULL ages now show as 0 (Moran had NULL age)"},explanation:"COALESCE returns the first non-NULL value. If Age is NULL, it returns 0 instead."},{id:"d13q5",difficulty:"hard",points:25,hintPenalty:8,title:"NULL Statistics",description:"Count how many passengers have **NULL Age** vs **NOT NULL Age** in one query. Show null_count and not_null_count.",tableUsed:"passengers",aggregateFunction:"SUM(CASE...)",hint:"Use SUM with CASE: SUM(CASE WHEN Age IS NULL THEN 1 ELSE 0 END)",solution:"SELECT SUM(CASE WHEN Age IS NULL THEN 1 ELSE 0 END) AS null_count, SUM(CASE WHEN Age IS NOT NULL THEN 1 ELSE 0 END) AS not_null_count FROM passengers;",alternativeSolutions:["SELECT SUM(CASE WHEN Age IS NULL THEN 1 ELSE 0 END) AS null_count, SUM(CASE WHEN Age IS NOT NULL THEN 1 ELSE 0 END) AS not_null_count FROM passengers"],expectedResult:{columns:["null_count","not_null_count"],rowCount:1,preview:[[177,714]],fullResult:!0,note:"177 NULL + 714 NOT NULL = 891 total"},explanation:"CASE inside SUM counts conditionally. 177 passengers have NULL ages, 714 have known ages. Total: 891."}]},{day:14,week:2,title:"CASE Statements",description:"Add conditional logic to your queries",concepts:["CASE","WHEN","THEN","ELSE","END"],dataset:"titanic",tableUsed:"passengers",tableSchema:[{column:"Name",type:"TEXT",description:"Passenger name"},{column:"Age",type:"REAL",description:"Age in years"},{column:"Pclass",type:"INTEGER",description:"1, 2, or 3"},{column:"Fare",type:"REAL",description:"Ticket price"},{column:"Survived",type:"INTEGER",description:"0 or 1"}],lesson:"# Conditional Logic with CASE 🔀\n\n## Basic CASE\n\n```sql\nSELECT Name,\n  CASE \n    WHEN Age < 18 THEN 'Child'\n    WHEN Age < 65 THEN 'Adult'\n    ELSE 'Senior'\n  END AS age_group\nFROM passengers;\n```\n\n## Simple CASE (equality)\n\n```sql\nSELECT Name,\n  CASE Pclass\n    WHEN 1 THEN 'First'\n    WHEN 2 THEN 'Second'\n    WHEN 3 THEN 'Third'\n  END AS class_name\nFROM passengers;\n```",questions:[{id:"d14q1",difficulty:"easy",points:5,hintPenalty:2,title:"Survival Status",description:"Create a **status** column: 'Survived' if Survived=1, 'Died' if Survived=0. Show Name and status.",tableUsed:"passengers",columnsNeeded:["Name","Survived"],hint:"CASE WHEN Survived = 1 THEN 'Survived' ELSE 'Died' END",solution:"SELECT Name, CASE WHEN Survived = 1 THEN 'Survived' ELSE 'Died' END AS status FROM passengers;",alternativeSolutions:["SELECT Name, CASE WHEN Survived = 1 THEN 'Survived' ELSE 'Died' END AS status FROM passengers"],expectedResult:{columns:["Name","status"],rowCount:891,preview:[["Braund, Mr. Owen Harris","Died"],["Cumings, Mrs. John Bradley","Survived"],["Heikkinen, Miss. Laina","Survived"],["Futrelle, Mrs. Jacques Heath","Survived"],["Allen, Mr. William Henry","Died"]],note:"Human-readable status instead of 0/1"},explanation:"CASE transforms numeric codes into readable labels. Much clearer than seeing 0 or 1."},{id:"d14q2",difficulty:"easy-medium",points:10,hintPenalty:3,title:"Class Names",description:"Create **class_name**: 'First', 'Second', or 'Third' based on Pclass. Show Name and class_name.",tableUsed:"passengers",columnsNeeded:["Name","Pclass"],hint:"CASE Pclass WHEN 1 THEN 'First' WHEN 2 THEN 'Second' ELSE 'Third' END",solution:"SELECT Name, CASE Pclass WHEN 1 THEN 'First' WHEN 2 THEN 'Second' ELSE 'Third' END AS class_name FROM passengers;",alternativeSolutions:["SELECT Name, CASE WHEN Pclass = 1 THEN 'First' WHEN Pclass = 2 THEN 'Second' ELSE 'Third' END AS class_name FROM passengers;"],expectedResult:{columns:["Name","class_name"],rowCount:891,preview:[["Braund, Mr. Owen Harris","Third"],["Cumings, Mrs. John Bradley","First"],["Heikkinen, Miss. Laina","Third"],["Futrelle, Mrs. Jacques Heath","First"],["Allen, Mr. William Henry","Third"]],note:"Class numbers converted to readable names"},explanation:"Simple CASE compares one column to multiple values. 'First' is clearer than '1' for reports."},{id:"d14q3",difficulty:"medium",points:15,hintPenalty:5,title:"Age Groups",description:"Create **age_group**: 'Child' (Age<18), 'Adult' (18-59), 'Senior' (60+). Show Name, Age, and age_group.",tableUsed:"passengers",columnsNeeded:["Name","Age"],hint:"CASE WHEN Age < 18 THEN 'Child' WHEN Age < 60 THEN 'Adult' ELSE 'Senior' END",solution:"SELECT Name, Age, CASE WHEN Age < 18 THEN 'Child' WHEN Age < 60 THEN 'Adult' ELSE 'Senior' END AS age_group FROM passengers;",alternativeSolutions:["SELECT Name, Age, CASE WHEN Age < 18 THEN 'Child' WHEN Age >= 60 THEN 'Senior' ELSE 'Adult' END AS age_group FROM passengers;"],expectedResult:{columns:["Name","Age","age_group"],rowCount:891,preview:[["Braund, Mr. Owen Harris",22,"Adult"],["Cumings, Mrs. John Bradley",38,"Adult"],["Heikkinen, Miss. Laina",26,"Adult"],["Palsson, Master. Gosta Leonard",2,"Child"],["Fortune, Mr. Charles Alexander",64,"Senior"]],note:"Age categorized into groups"},explanation:"WHEN conditions are checked in order - first match wins. NULL ages will fall through to 'Senior' (the ELSE)."},{id:"d14q4",difficulty:"medium-hard",points:20,hintPenalty:6,title:"Fare Categories",description:"Create **fare_category**: 'Budget' (<20), 'Standard' (20-100), 'Premium' (>100). Show Name, Fare, and fare_category.",tableUsed:"passengers",columnsNeeded:["Name","Fare"],hint:"CASE WHEN Fare < 20 THEN 'Budget' WHEN Fare <= 100 THEN 'Standard' ELSE 'Premium' END",solution:"SELECT Name, Fare, CASE WHEN Fare < 20 THEN 'Budget' WHEN Fare <= 100 THEN 'Standard' ELSE 'Premium' END AS fare_category FROM passengers;",alternativeSolutions:["SELECT Name, Fare, CASE WHEN Fare < 20 THEN 'Budget' WHEN Fare > 100 THEN 'Premium' ELSE 'Standard' END AS fare_category FROM passengers;"],expectedResult:{columns:["Name","Fare","fare_category"],rowCount:891,preview:[["Braund, Mr. Owen Harris",7.25,"Budget"],["Cumings, Mrs. John Bradley",71.28,"Standard"],["Heikkinen, Miss. Laina",7.925,"Budget"],["Astor, Col. John Jacob",227.525,"Premium"],["Cardeza, Mr. Thomas Drake Martinez",512.3292,"Premium"]],note:"Fares categorized into price tiers"},explanation:"CASE creates categorical data from continuous numbers. Useful for grouping data into ranges."},{id:"d14q5",difficulty:"hard",points:25,hintPenalty:8,title:"Count by Category",description:"Count passengers in each age group (Child/Adult/Senior) in **one query**. Show children, adults, seniors.",tableUsed:"passengers",aggregateFunction:"SUM(CASE...)",hint:"SUM(CASE WHEN Age < 18 THEN 1 ELSE 0 END) AS children, etc.",solution:"SELECT SUM(CASE WHEN Age < 18 THEN 1 ELSE 0 END) AS children, SUM(CASE WHEN Age >= 18 AND Age < 60 THEN 1 ELSE 0 END) AS adults, SUM(CASE WHEN Age >= 60 THEN 1 ELSE 0 END) AS seniors FROM passengers WHERE Age IS NOT NULL;",alternativeSolutions:["SELECT SUM(CASE WHEN Age < 18 THEN 1 ELSE 0 END) AS children, SUM(CASE WHEN Age BETWEEN 18 AND 59 THEN 1 ELSE 0 END) AS adults, SUM(CASE WHEN Age >= 60 THEN 1 ELSE 0 END) AS seniors FROM passengers WHERE Age IS NOT NULL;"],expectedResult:{columns:["children","adults","seniors"],rowCount:1,preview:[[113,563,38]],fullResult:!0,note:"113 children + 563 adults + 38 seniors = 714 (excludes 177 NULL ages)"},explanation:"CASE inside SUM creates pivot-style counts. 113 children, 563 adults, 38 seniors (excluding NULL ages)."}]},{day:15,week:3,title:"Introduction to Subqueries",description:"Use queries inside other queries",concepts:["Subquery","Scalar subquery","Nested queries"],dataset:"titanic",tableUsed:"passengers",tableSchema:[{column:"Name",type:"TEXT",description:"Passenger name"},{column:"Age",type:"REAL",description:"Age in years"},{column:"Fare",type:"REAL",description:"Ticket price"},{column:"Pclass",type:"INTEGER",description:"1, 2, or 3"}],lesson:"# Subqueries - Query Inside Query 🎭\n\n## Scalar Subquery\n\nA subquery that returns a single value:\n\n```sql\nSELECT * FROM passengers\nWHERE Fare > (SELECT AVG(Fare) FROM passengers);\n```\n\nThe inner query runs first, then the outer query uses that result.\n\n## Compare to Average\n\n```sql\nSELECT Name, Age,\n  (SELECT AVG(Age) FROM passengers) AS overall_avg\nFROM passengers;\n```",questions:[{id:"d15q1",difficulty:"easy",points:5,hintPenalty:2,title:"Above Average Fare",description:"Find passengers who paid **more than the average fare**. Show Name and Fare.",tableUsed:"passengers",columnsNeeded:["Name","Fare"],filterCondition:"Fare > (SELECT AVG(Fare) ...)",hint:"WHERE Fare > (SELECT AVG(Fare) FROM passengers)",solution:"SELECT Name, Fare FROM passengers WHERE Fare > (SELECT AVG(Fare) FROM passengers);",alternativeSolutions:["SELECT Name, Fare FROM passengers WHERE Fare > (SELECT AVG(Fare) FROM passengers)"],expectedResult:{columns:["Name","Fare"],rowCount:164,preview:[["Cumings, Mrs. John Bradley",71.28],["Futrelle, Mrs. Jacques Heath",53.1],["McCarthy, Mr. Timothy J",51.8625],["Fortune, Mr. Charles Alexander",263],["Sloper, Mr. William Thompson",35.5]],note:"164 passengers paid more than average (£32.20)"},explanation:"The subquery calculates average fare (£32.20), then the outer query finds passengers above that. 164 paid more than average."},{id:"d15q2",difficulty:"easy-medium",points:10,hintPenalty:3,title:"Above Average Age",description:"Find passengers **older than the average age**. Show Name and Age.",tableUsed:"passengers",columnsNeeded:["Name","Age"],filterCondition:"Age > (SELECT AVG(Age) ...)",hint:"Same pattern: WHERE Age > (SELECT AVG(Age) FROM passengers)",solution:"SELECT Name, Age FROM passengers WHERE Age > (SELECT AVG(Age) FROM passengers);",alternativeSolutions:["SELECT Name, Age FROM passengers WHERE Age > (SELECT AVG(Age) FROM passengers)"],expectedResult:{columns:["Name","Age"],rowCount:303,preview:[["Cumings, Mrs. John Bradley",38],["Futrelle, Mrs. Jacques Heath",35],["Allen, Mr. William Henry",35],["McCarthy, Mr. Timothy J",54],["Fortune, Mr. Charles Alexander",64]],note:"303 passengers were older than average (29.7 years)"},explanation:"303 passengers were older than the average age of 29.7 years."},{id:"d15q3",difficulty:"medium",points:15,hintPenalty:5,title:"Maximum Fare",description:"Find the passenger(s) who paid the **maximum fare**. Show Name and Fare.",tableUsed:"passengers",columnsNeeded:["Name","Fare"],filterCondition:"Fare = (SELECT MAX(Fare) ...)",hint:"WHERE Fare = (SELECT MAX(Fare) FROM passengers)",solution:"SELECT Name, Fare FROM passengers WHERE Fare = (SELECT MAX(Fare) FROM passengers);",alternativeSolutions:["SELECT Name, Fare FROM passengers WHERE Fare = (SELECT MAX(Fare) FROM passengers)"],expectedResult:{columns:["Name","Fare"],rowCount:3,preview:[["Ward, Miss. Anna",512.3292],["Cardeza, Mr. Thomas Drake Martinez",512.3292],["Lesurer, Mr. Gustave J",512.3292]],fullResult:!0,note:"3 passengers tied for highest fare (£512.33)"},explanation:"Three passengers paid the highest fare of £512.33 - they likely shared a luxury suite."},{id:"d15q4",difficulty:"medium-hard",points:20,hintPenalty:6,title:"First Class Above Overall Average",description:"Find **first class** passengers who paid **more than the overall average fare** (all classes). Show Name, Pclass, and Fare.",tableUsed:"passengers",columnsNeeded:["Name","Pclass","Fare"],filterCondition:"Pclass = 1 AND Fare > (SELECT AVG(Fare) ...)",hint:"WHERE Pclass = 1 AND Fare > (SELECT AVG(Fare) FROM passengers)",solution:"SELECT Name, Pclass, Fare FROM passengers WHERE Pclass = 1 AND Fare > (SELECT AVG(Fare) FROM passengers);",alternativeSolutions:["SELECT Name, Pclass, Fare FROM passengers WHERE Pclass = 1 AND Fare > (SELECT AVG(Fare) FROM passengers)"],expectedResult:{columns:["Name","Pclass","Fare"],rowCount:160,preview:[["Cumings, Mrs. John Bradley",1,71.28],["Futrelle, Mrs. Jacques Heath",1,53.1],["McCarthy, Mr. Timothy J",1,51.8625],["Fortune, Mr. Charles Alexander",1,263],["Sloper, Mr. William Thompson",1,35.5]],note:"160 of 216 first-class passengers paid above overall average"},explanation:"160 of 216 first-class passengers (74%) paid more than the overall average of £32."},{id:"d15q5",difficulty:"hard",points:25,hintPenalty:8,title:"Youngest Passengers",description:"Find passenger(s) who have the **minimum age** in the dataset. Show Name and Age.",tableUsed:"passengers",columnsNeeded:["Name","Age"],filterCondition:"Age = (SELECT MIN(Age) ...)",hint:"WHERE Age = (SELECT MIN(Age) FROM passengers)",solution:"SELECT Name, Age FROM passengers WHERE Age = (SELECT MIN(Age) FROM passengers);",alternativeSolutions:["SELECT Name, Age FROM passengers WHERE Age = (SELECT MIN(Age) FROM passengers)"],expectedResult:{columns:["Name","Age"],rowCount:1,preview:[["Thomas, Master. Assad Alexander",.42]],fullResult:!0,note:"Youngest passenger: 0.42 years old (~5 months)"},explanation:"The youngest passenger was an infant named Assad Alexander Thomas, just 5 months old (0.42 years)."}]}]},"undefined"!=typeof window&&(window.sqlChallenge30Days=window.sqlChallenge30Days),console.log("30-Day SQL Challenge Part 1 loaded: Days 1-15 (75 questions)"),function(){window.sqlChallenge30Days||(window.sqlChallenge30Days={days:[],tables:{},scoring:{}});const e=[{day:16,week:3,title:"INNER JOIN",description:"Combine data from multiple tables",concepts:["INNER JOIN","ON","Table aliases"],dataset:"ecommerce",tablesUsed:["customers","orders"],tableSchemas:{customers:[{column:"customer_id",type:"INTEGER",description:"Customer ID"},{column:"name",type:"TEXT",description:"Customer name"},{column:"email",type:"TEXT",description:"Email"},{column:"membership",type:"TEXT",description:"Membership tier"}],orders:[{column:"order_id",type:"INTEGER",description:"Order ID"},{column:"customer_id",type:"INTEGER",description:"FK to customers"},{column:"product",type:"TEXT",description:"Product name"},{column:"total",type:"REAL",description:"Order total"},{column:"order_date",type:"TEXT",description:"Order date"}]},lesson:"# INNER JOIN\n\n```sql\nSELECT c.name, o.total\nFROM customers c\nINNER JOIN orders o ON c.customer_id = o.customer_id;\n```",questions:[{id:"d16q1",difficulty:"easy",points:5,title:"Basic Join",description:"Join customers and orders. Show customer name and order total.",dataset:"ecommerce",solution:"SELECT customers.name, orders.total FROM customers INNER JOIN orders ON customers.customer_id = orders.customer_id;",alternativeSolutions:["SELECT c.name, o.total FROM customers c INNER JOIN orders o ON c.customer_id = o.customer_id;"],expectedResult:{columns:["name","total"],rowCount:40,preview:[["John Smith",1299.99],["Emma Wilson",99.98],["Michael Brown",349.99]],note:"40 orders with customer names"},explanation:"INNER JOIN connects tables where customer_id matches in both."},{id:"d16q2",difficulty:"easy-medium",points:10,title:"Join with Aliases",description:"Same query using c and o as table aliases.",dataset:"ecommerce",solution:"SELECT c.name, o.total FROM customers c INNER JOIN orders o ON c.customer_id = o.customer_id;",alternativeSolutions:[],expectedResult:{columns:["name","total"],rowCount:40,preview:[["John Smith",1299.99]],note:"Shorter with aliases"},explanation:"Aliases make queries shorter and more readable."},{id:"d16q3",difficulty:"medium",points:15,title:"Multiple Columns",description:"Show customer name, membership, product, and order_date.",dataset:"ecommerce",solution:"SELECT c.name, c.membership, o.product, o.order_date FROM customers c INNER JOIN orders o ON c.customer_id = o.customer_id;",alternativeSolutions:[],expectedResult:{columns:["name","membership","product","order_date"],rowCount:40,preview:[["John Smith","Gold","Laptop Pro","2024-01-15"]],note:"Columns from both tables"},explanation:"After JOIN, you can SELECT any column from either table."},{id:"d16q4",difficulty:"medium-hard",points:20,title:"Join with Filter",description:"Find orders over $200. Show customer name and total.",dataset:"ecommerce",solution:"SELECT c.name, o.total FROM customers c INNER JOIN orders o ON c.customer_id = o.customer_id WHERE o.total > 200;",alternativeSolutions:[],expectedResult:{columns:["name","total"],rowCount:15,preview:[["John Smith",1299.99],["Michael Brown",349.99]],note:"15 orders over $200"},explanation:"WHERE filters the joined results."},{id:"d16q5",difficulty:"hard",points:25,title:"Join with Aggregation",description:"For each customer, show name and total_spent (SUM of order totals).",dataset:"ecommerce",solution:"SELECT c.name, SUM(o.total) AS total_spent FROM customers c INNER JOIN orders o ON c.customer_id = o.customer_id GROUP BY c.name;",alternativeSolutions:["SELECT c.name, SUM(o.total) AS total_spent FROM customers c INNER JOIN orders o ON c.customer_id = o.customer_id GROUP BY c.customer_id;"],expectedResult:{columns:["name","total_spent"],rowCount:10,preview:[["John Smith",3339.92],["Emma Wilson",979.95]],note:"10 customers with orders"},explanation:"JOIN + GROUP BY calculates per-customer totals."}]},{day:17,week:3,title:"LEFT JOIN",description:"Include all rows from left table",concepts:["LEFT JOIN","NULL in joins","Finding missing"],dataset:"ecommerce",tablesUsed:["customers","orders"],lesson:"# LEFT JOIN\n\nReturns ALL left table rows, NULL for missing matches.\n\n```sql\nSELECT c.name, o.total\nFROM customers c\nLEFT JOIN orders o ON c.customer_id = o.customer_id;\n```",questions:[{id:"d17q1",difficulty:"easy",points:5,title:"Basic Left Join",description:"LEFT JOIN to show all customers and their orders (including those with none).",dataset:"ecommerce",solution:"SELECT c.name, o.total FROM customers c LEFT JOIN orders o ON c.customer_id = o.customer_id;",alternativeSolutions:[],expectedResult:{columns:["name","total"],rowCount:43,preview:[["John Smith",1299.99],["Amy Taylor",null]],note:"43 rows: 40 orders + 3 customers without"},explanation:"LEFT JOIN includes all customers, even those with no orders."},{id:"d17q2",difficulty:"easy-medium",points:10,title:"Count with Left Join",description:"Show all customers with their order_count (0 if none).",dataset:"ecommerce",solution:"SELECT c.name, COUNT(o.order_id) AS order_count FROM customers c LEFT JOIN orders o ON c.customer_id = o.customer_id GROUP BY c.name;",alternativeSolutions:["SELECT c.name, COUNT(o.order_id) AS order_count FROM customers c LEFT JOIN orders o ON c.customer_id = o.customer_id GROUP BY c.customer_id;"],expectedResult:{columns:["name","order_count"],rowCount:13,preview:[["John Smith",7],["Amy Taylor",0]],note:"All 13 customers shown"},explanation:"COUNT(o.order_id) gives 0 for customers without orders."},{id:"d17q3",difficulty:"medium",points:15,title:"Find No Orders",description:"Find customers who have never placed an order.",dataset:"ecommerce",solution:"SELECT c.name FROM customers c LEFT JOIN orders o ON c.customer_id = o.customer_id WHERE o.order_id IS NULL;",alternativeSolutions:[],expectedResult:{columns:["name"],rowCount:3,preview:[["Amy Taylor"],["Mark Johnson"],["Nina Patel"]],note:"3 customers with no orders"},explanation:"WHERE o.order_id IS NULL finds unmatched rows."},{id:"d17q4",difficulty:"medium-hard",points:20,title:"Complete Summary",description:"All customers: name, order_count, total_spent (0 if no orders). Use COALESCE.",dataset:"ecommerce",solution:"SELECT c.name, COUNT(o.order_id) AS order_count, COALESCE(SUM(o.total), 0) AS total_spent FROM customers c LEFT JOIN orders o ON c.customer_id = o.customer_id GROUP BY c.name;",alternativeSolutions:[],expectedResult:{columns:["name","order_count","total_spent"],rowCount:13,preview:[["John Smith",7,3339.92],["Amy Taylor",0,0]],note:"Complete customer summary"},explanation:"COALESCE replaces NULL with 0 for customers without orders."},{id:"d17q5",difficulty:"hard",points:25,title:"High-Value Only",description:"Show all customers with their total_spent. Only include those who spent over $500 OR have no orders.",dataset:"ecommerce",solution:"SELECT c.name, COALESCE(SUM(o.total), 0) AS total_spent FROM customers c LEFT JOIN orders o ON c.customer_id = o.customer_id GROUP BY c.name HAVING total_spent > 500 OR total_spent = 0;",alternativeSolutions:[],expectedResult:{columns:["name","total_spent"],rowCount:8,preview:[["John Smith",3339.92],["Amy Taylor",0]],note:"Big spenders + inactive customers"},explanation:"HAVING filters grouped results after aggregation."}]},{day:18,week:3,title:"UNION & UNION ALL",description:"Combine results from multiple queries",concepts:["UNION","UNION ALL","Set operations"],dataset:"titanic",tableUsed:"passengers",lesson:"# UNION\n\nUNION removes duplicates. UNION ALL keeps all rows.",questions:[{id:"d18q1",difficulty:"easy",points:5,title:"Simple Union",description:"Get names of first class OR survivors using UNION.",solution:"SELECT Name FROM passengers WHERE Pclass = 1 UNION SELECT Name FROM passengers WHERE Survived = 1;",alternativeSolutions:[],expectedResult:{columns:["Name"],rowCount:422,preview:[["Cumings, Mrs. John Bradley"]],note:"422 unique names"},explanation:"UNION removes duplicates."},{id:"d18q2",difficulty:"easy-medium",points:10,title:"Union All",description:"Same with UNION ALL to keep duplicates.",solution:"SELECT Name FROM passengers WHERE Pclass = 1 UNION ALL SELECT Name FROM passengers WHERE Survived = 1;",alternativeSolutions:[],expectedResult:{columns:["Name"],rowCount:558,preview:[["Cumings, Mrs. John Bradley"]],note:"558 rows (136 duplicates)"},explanation:"UNION ALL: 216 + 342 = 558."},{id:"d18q3",difficulty:"medium",points:15,title:"Labeled Summary",description:"Show 'First Class' and 'Survivors' counts as labeled rows.",solution:"SELECT 'First Class' AS category, COUNT(*) AS count FROM passengers WHERE Pclass = 1 UNION ALL SELECT 'Survivors', COUNT(*) FROM passengers WHERE Survived = 1;",alternativeSolutions:[],expectedResult:{columns:["category","count"],rowCount:2,preview:[["First Class",216],["Survivors",342]],fullResult:!0,note:"Labeled summary report"},explanation:"Labels make reports readable."},{id:"d18q4",difficulty:"medium-hard",points:20,title:"Three-Way Union",description:"Count each class as three labeled rows.",solution:"SELECT 'First' AS class, COUNT(*) AS count FROM passengers WHERE Pclass = 1 UNION ALL SELECT 'Second', COUNT(*) FROM passengers WHERE Pclass = 2 UNION ALL SELECT 'Third', COUNT(*) FROM passengers WHERE Pclass = 3;",alternativeSolutions:[],expectedResult:{columns:["class","count"],rowCount:3,preview:[["First",216],["Second",184],["Third",491]],fullResult:!0,note:"Class breakdown"},explanation:"Chain multiple UNIONs."},{id:"d18q5",difficulty:"hard",points:25,title:"Survival Matrix",description:"Create: Male Survivors, Female Survivors, Male Deaths, Female Deaths.",solution:"SELECT 'Male Survivors' AS category, COUNT(*) AS count FROM passengers WHERE Sex = 'male' AND Survived = 1 UNION ALL SELECT 'Female Survivors', COUNT(*) FROM passengers WHERE Sex = 'female' AND Survived = 1 UNION ALL SELECT 'Male Deaths', COUNT(*) FROM passengers WHERE Sex = 'male' AND Survived = 0 UNION ALL SELECT 'Female Deaths', COUNT(*) FROM passengers WHERE Sex = 'female' AND Survived = 0;",alternativeSolutions:[],expectedResult:{columns:["category","count"],rowCount:4,preview:[["Male Survivors",109],["Female Survivors",233],["Male Deaths",468],["Female Deaths",81]],fullResult:!0,note:"Complete survival breakdown"},explanation:"Four-way gender × survival."}]},{day:19,week:3,title:"String Functions",description:"Manipulate text data",concepts:["UPPER","LOWER","LENGTH","SUBSTR","REPLACE"],dataset:"titanic",tableUsed:"passengers",lesson:"# String Functions\n\nUPPER, LOWER, LENGTH, SUBSTR, REPLACE",questions:[{id:"d19q1",difficulty:"easy",points:5,title:"Uppercase",description:"Show names in UPPERCASE.",solution:"SELECT UPPER(Name) AS name_upper FROM passengers;",alternativeSolutions:[],expectedResult:{columns:["name_upper"],rowCount:891,preview:[["BRAUND, MR. OWEN HARRIS"]],note:"All uppercase"},explanation:"UPPER converts to uppercase."},{id:"d19q2",difficulty:"easy-medium",points:10,title:"Name Length",description:"Show Name and its length.",solution:"SELECT Name, LENGTH(Name) AS name_length FROM passengers;",alternativeSolutions:[],expectedResult:{columns:["Name","name_length"],rowCount:891,preview:[["Braund, Mr. Owen Harris",23]],note:"Character count"},explanation:"LENGTH counts characters."},{id:"d19q3",difficulty:"medium",points:15,title:"First 15 Characters",description:"Show first 15 characters as short_name.",solution:"SELECT SUBSTR(Name, 1, 15) AS short_name FROM passengers;",alternativeSolutions:[],expectedResult:{columns:["short_name"],rowCount:891,preview:[["Braund, Mr. Owe"]],note:"Truncated names"},explanation:"SUBSTR extracts substring."},{id:"d19q4",difficulty:"medium-hard",points:20,title:"Replace Title",description:"Replace 'Mr.' with 'Mister'.",solution:"SELECT REPLACE(Name, 'Mr.', 'Mister') AS formal_name FROM passengers;",alternativeSolutions:[],expectedResult:{columns:["formal_name"],rowCount:891,preview:[["Braund, Mister Owen Harris"]],note:"'Mr.' → 'Mister'"},explanation:"REPLACE substitutes text."},{id:"d19q5",difficulty:"hard",points:25,title:"Extract Last Name",description:"Extract last name (before comma).",solution:"SELECT SUBSTR(Name, 1, INSTR(Name, ',') - 1) AS last_name FROM passengers;",alternativeSolutions:[],expectedResult:{columns:["last_name"],rowCount:891,preview:[["Braund"],["Cumings"]],note:"Text before comma"},explanation:"INSTR finds comma position."}]},{day:20,week:3,title:"Math Functions & ROUND",description:"Calculations and rounding",concepts:["ROUND","ABS","Arithmetic"],dataset:"titanic",tableUsed:"passengers",lesson:"# Math Functions\n\nROUND(value, decimals), ABS(value)",questions:[{id:"d20q1",difficulty:"easy",points:5,title:"Round Fare",description:"Show Fare rounded to whole numbers.",solution:"SELECT Name, ROUND(Fare, 0) AS fare_rounded FROM passengers;",alternativeSolutions:[],expectedResult:{columns:["Name","fare_rounded"],rowCount:891,preview:[["Braund, Mr. Owen Harris",7]],note:"Rounded to integers"},explanation:"ROUND(value, 0) = nearest integer."},{id:"d20q2",difficulty:"easy-medium",points:10,title:"Two Decimals",description:"Show Fare rounded to 2 decimal places.",solution:"SELECT Name, ROUND(Fare, 2) AS fare_rounded FROM passengers;",alternativeSolutions:[],expectedResult:{columns:["Name","fare_rounded"],rowCount:891,preview:[["Braund, Mr. Owen Harris",7.25]],note:"2 decimal places"},explanation:"ROUND with precision."},{id:"d20q3",difficulty:"medium",points:15,title:"Family Size",description:"Calculate family_size = SibSp + Parch + 1.",solution:"SELECT Name, SibSp + Parch + 1 AS family_size FROM passengers;",alternativeSolutions:[],expectedResult:{columns:["Name","family_size"],rowCount:891,preview:[["Braund, Mr. Owen Harris",2]],note:"Including self"},explanation:"Simple arithmetic."},{id:"d20q4",difficulty:"medium-hard",points:20,title:"Fare Per Person",description:"Fare / family_size, rounded to 2 decimals.",solution:"SELECT Name, ROUND(Fare / (SibSp + Parch + 1), 2) AS fare_per_person FROM passengers;",alternativeSolutions:[],expectedResult:{columns:["Name","fare_per_person"],rowCount:891,preview:[["Braund, Mr. Owen Harris",3.63]],note:"Cost per family member"},explanation:"Division with rounding."},{id:"d20q5",difficulty:"hard",points:25,title:"Rounded Statistics",description:"avg_fare, min_fare, max_fare, fare_range - all rounded.",solution:"SELECT ROUND(AVG(Fare), 2) AS avg_fare, ROUND(MIN(Fare), 2) AS min_fare, ROUND(MAX(Fare), 2) AS max_fare, ROUND(MAX(Fare) - MIN(Fare), 2) AS fare_range FROM passengers;",alternativeSolutions:[],expectedResult:{columns:["avg_fare","min_fare","max_fare","fare_range"],rowCount:1,preview:[[32.2,0,512.33,512.33]],fullResult:!0,note:"Fare statistics"},explanation:"Multiple aggregates with ROUND."}]},{day:21,week:3,title:"ROW_NUMBER",description:"Number rows without grouping",concepts:["ROW_NUMBER","OVER","PARTITION BY"],dataset:"titanic",tableUsed:"passengers",lesson:"# ROW_NUMBER\n\nROW_NUMBER() OVER (ORDER BY col) assigns sequential numbers.",questions:[{id:"d21q1",difficulty:"easy",points:5,title:"Simple Row Number",description:"Add row_num ordered by PassengerId.",solution:"SELECT Name, PassengerId, ROW_NUMBER() OVER (ORDER BY PassengerId) AS row_num FROM passengers;",alternativeSolutions:[],expectedResult:{columns:["Name","PassengerId","row_num"],rowCount:891,preview:[["Braund, Mr. Owen Harris",1,1],["Cumings, Mrs. John Bradley",2,2]],note:"1-891 sequential"},explanation:"ROW_NUMBER assigns sequential numbers."},{id:"d21q2",difficulty:"easy-medium",points:10,title:"Rank by Fare",description:"Rank by Fare descending.",solution:"SELECT Name, Fare, ROW_NUMBER() OVER (ORDER BY Fare DESC) AS fare_rank FROM passengers;",alternativeSolutions:[],expectedResult:{columns:["Name","Fare","fare_rank"],rowCount:891,preview:[["Ward, Miss. Anna",512.33,1]],note:"Highest fare = rank 1"},explanation:"DESC for highest first."},{id:"d21q3",difficulty:"medium",points:15,title:"Top 5 Fares",description:"Find top 5 by fare using subquery.",solution:"SELECT * FROM (SELECT Name, Fare, ROW_NUMBER() OVER (ORDER BY Fare DESC) AS rank FROM passengers) WHERE rank <= 5;",alternativeSolutions:[],expectedResult:{columns:["Name","Fare","rank"],rowCount:5,preview:[["Ward, Miss. Anna",512.33,1]],note:"Top 5 highest fares"},explanation:"Filter window results in subquery."},{id:"d21q4",difficulty:"medium-hard",points:20,title:"Youngest Ranked",description:"Rank by Age ascending (youngest = 1).",solution:"SELECT Name, Age, ROW_NUMBER() OVER (ORDER BY Age ASC) AS age_rank FROM passengers WHERE Age IS NOT NULL;",alternativeSolutions:[],expectedResult:{columns:["Name","Age","age_rank"],rowCount:714,preview:[["Thomas, Master. Assad Alexander",.42,1]],note:"Youngest first"},explanation:"Youngest gets rank 1."},{id:"d21q5",difficulty:"hard",points:25,title:"Rank Within Class",description:"Rank by Fare within each Pclass.",solution:"SELECT Name, Pclass, Fare, ROW_NUMBER() OVER (PARTITION BY Pclass ORDER BY Fare DESC) AS class_rank FROM passengers;",alternativeSolutions:[],expectedResult:{columns:["Name","Pclass","Fare","class_rank"],rowCount:891,preview:[["Ward, Miss. Anna",1,512.33,1]],note:"Separate ranking per class"},explanation:"PARTITION BY creates separate rankings."}]},{day:22,week:4,title:"RANK vs DENSE_RANK",description:"Handle ties in rankings",concepts:["RANK","DENSE_RANK","Handling ties"],dataset:"titanic",tableUsed:"passengers",lesson:"# RANK vs DENSE_RANK\n\nRANK: 1,2,2,4 (skips)\nDENSE_RANK: 1,2,2,3 (no skip)",questions:[{id:"d22q1",difficulty:"easy",points:5,title:"Basic RANK",description:"RANK by Fare descending.",solution:"SELECT Name, Fare, RANK() OVER (ORDER BY Fare DESC) AS rank FROM passengers;",alternativeSolutions:[],expectedResult:{columns:["Name","Fare","rank"],rowCount:891,preview:[["Ward, Miss. Anna",512.33,1]],note:"Ties get same rank"},explanation:"RANK handles ties."},{id:"d22q2",difficulty:"easy-medium",points:10,title:"DENSE_RANK",description:"Same with DENSE_RANK.",solution:"SELECT Name, Fare, DENSE_RANK() OVER (ORDER BY Fare DESC) AS dense_rank FROM passengers;",alternativeSolutions:[],expectedResult:{columns:["Name","Fare","dense_rank"],rowCount:891,preview:[["Ward, Miss. Anna",512.33,1]],note:"No gaps after ties"},explanation:"DENSE_RANK doesn't skip."},{id:"d22q3",difficulty:"medium",points:15,title:"Compare Both",description:"Show both RANK and DENSE_RANK.",solution:"SELECT Name, Fare, RANK() OVER (ORDER BY Fare DESC) AS rank, DENSE_RANK() OVER (ORDER BY Fare DESC) AS dense_rank FROM passengers;",alternativeSolutions:[],expectedResult:{columns:["Name","Fare","rank","dense_rank"],rowCount:891,preview:[["Ward, Miss. Anna",512.33,1,1]],note:"Compare rankings"},explanation:"See how ties differ."},{id:"d22q4",difficulty:"medium-hard",points:20,title:"Top 3 Per Class",description:"Top 3 fares in each class.",solution:"SELECT * FROM (SELECT Name, Pclass, Fare, DENSE_RANK() OVER (PARTITION BY Pclass ORDER BY Fare DESC) AS dr FROM passengers) WHERE dr <= 3;",alternativeSolutions:[],expectedResult:{columns:["Name","Pclass","Fare","dr"],rowCount:9,preview:[["Ward, Miss. Anna",1,512.33,1]],note:"Top 3 per class"},explanation:"Top N per group pattern."},{id:"d22q5",difficulty:"hard",points:25,title:"Percentile",description:"Show fare percentile.",solution:"SELECT Name, Fare, ROUND(PERCENT_RANK() OVER (ORDER BY Fare) * 100, 1) AS percentile FROM passengers WHERE Fare > 0;",alternativeSolutions:[],expectedResult:{columns:["Name","Fare","percentile"],rowCount:876,preview:[],note:"Percentile ranking"},explanation:"PERCENT_RANK for percentiles."}]},{day:23,week:4,title:"LAG and LEAD",description:"Access adjacent rows",concepts:["LAG","LEAD","Row comparison"],dataset:"titanic",tableUsed:"passengers",lesson:"# LAG and LEAD\n\nLAG gets previous row. LEAD gets next row.",questions:[{id:"d23q1",difficulty:"easy",points:5,title:"Previous Fare",description:"Show fare and previous fare.",solution:"SELECT Name, Fare, LAG(Fare) OVER (ORDER BY PassengerId) AS prev_fare FROM passengers;",alternativeSolutions:[],expectedResult:{columns:["Name","Fare","prev_fare"],rowCount:891,preview:[["Braund, Mr. Owen Harris",7.25,null]],note:"NULL for first row"},explanation:"LAG gets previous row."},{id:"d23q2",difficulty:"easy-medium",points:10,title:"Next Fare",description:"Show fare and next fare.",solution:"SELECT Name, Fare, LEAD(Fare) OVER (ORDER BY PassengerId) AS next_fare FROM passengers;",alternativeSolutions:[],expectedResult:{columns:["Name","Fare","next_fare"],rowCount:891,preview:[["Braund, Mr. Owen Harris",7.25,71.28]],note:"LEAD gets next"},explanation:"LEAD gets next row."},{id:"d23q3",difficulty:"medium",points:15,title:"Fare Difference",description:"Calculate difference from previous.",solution:"SELECT Name, Fare, Fare - LAG(Fare) OVER (ORDER BY PassengerId) AS fare_diff FROM passengers;",alternativeSolutions:[],expectedResult:{columns:["Name","Fare","fare_diff"],rowCount:891,preview:[["Cumings, Mrs. John Bradley",71.28,64.03]],note:"Row-to-row difference"},explanation:"Subtract for differences."},{id:"d23q4",difficulty:"medium-hard",points:20,title:"LAG with Default",description:"prev_fare with 0 as default.",solution:"SELECT Name, Fare, LAG(Fare, 1, 0) OVER (ORDER BY PassengerId) AS prev_fare FROM passengers;",alternativeSolutions:[],expectedResult:{columns:["Name","Fare","prev_fare"],rowCount:891,preview:[["Braund, Mr. Owen Harris",7.25,0]],note:"0 instead of NULL"},explanation:"Third param is default."},{id:"d23q5",difficulty:"hard",points:25,title:"Direction Indicator",description:"Show + or - vs previous.",solution:"SELECT Name, Fare, CASE WHEN Fare > LAG(Fare) OVER (ORDER BY PassengerId) THEN '+' WHEN Fare < LAG(Fare) OVER (ORDER BY PassengerId) THEN '-' ELSE '=' END AS vs_prev FROM passengers;",alternativeSolutions:[],expectedResult:{columns:["Name","Fare","vs_prev"],rowCount:891,preview:[["Cumings, Mrs. John Bradley",71.28,"+"]],note:"Direction indicators"},explanation:"CASE with LAG."}]},{day:24,week:4,title:"Running Totals",description:"Cumulative calculations",concepts:["SUM OVER","Running total","Cumulative"],dataset:"titanic",tableUsed:"passengers",lesson:"# Running Totals\n\nSUM() OVER (ORDER BY col) creates running totals.",questions:[{id:"d24q1",difficulty:"easy",points:5,title:"Running Total",description:"Running total of Fare.",solution:"SELECT Name, Fare, SUM(Fare) OVER (ORDER BY PassengerId) AS running_total FROM passengers;",alternativeSolutions:[],expectedResult:{columns:["Name","Fare","running_total"],rowCount:891,preview:[["Braund, Mr. Owen Harris",7.25,7.25]],note:"Cumulative sum"},explanation:"Running total accumulates."},{id:"d24q2",difficulty:"easy-medium",points:10,title:"Running Count",description:"Running count of passengers.",solution:"SELECT Name, COUNT(*) OVER (ORDER BY PassengerId) AS running_count FROM passengers;",alternativeSolutions:[],expectedResult:{columns:["Name","running_count"],rowCount:891,preview:[["Braund, Mr. Owen Harris",1]],note:"Running count"},explanation:"COUNT in window function."},{id:"d24q3",difficulty:"medium",points:15,title:"Running Average",description:"Running average of Fare.",solution:"SELECT Name, Fare, ROUND(AVG(Fare) OVER (ORDER BY PassengerId), 2) AS running_avg FROM passengers;",alternativeSolutions:[],expectedResult:{columns:["Name","Fare","running_avg"],rowCount:891,preview:[["Braund, Mr. Owen Harris",7.25,7.25]],note:"Running average"},explanation:"Running avg updates each row."},{id:"d24q4",difficulty:"medium-hard",points:20,title:"Per-Class Running",description:"Running total within each class.",solution:"SELECT Name, Pclass, Fare, SUM(Fare) OVER (PARTITION BY Pclass ORDER BY PassengerId) AS class_total FROM passengers;",alternativeSolutions:[],expectedResult:{columns:["Name","Pclass","Fare","class_total"],rowCount:891,preview:[["Cumings, Mrs. John Bradley",1,71.28,71.28]],note:"Per-class totals"},explanation:"PARTITION BY resets totals."},{id:"d24q5",difficulty:"hard",points:25,title:"Cumulative Percent",description:"Fare as % of running total.",solution:"SELECT Name, Fare, ROUND(Fare / SUM(Fare) OVER (ORDER BY PassengerId) * 100, 2) AS pct_of_running FROM passengers;",alternativeSolutions:[],expectedResult:{columns:["Name","Fare","pct_of_running"],rowCount:891,preview:[["Braund, Mr. Owen Harris",7.25,100]],note:"First = 100%"},explanation:"First row is 100% of itself."}]},{day:25,week:4,title:"CTEs (WITH)",description:"Named subqueries for cleaner code",concepts:["WITH","CTE","Named subquery"],dataset:"titanic",tableUsed:"passengers",lesson:"# CTEs\n\nWITH name AS (query) SELECT ... FROM name;",questions:[{id:"d25q1",difficulty:"easy",points:5,title:"Simple CTE",description:"CTE for survivors, count them.",solution:"WITH survivors AS (SELECT * FROM passengers WHERE Survived = 1) SELECT COUNT(*) AS survivor_count FROM survivors;",alternativeSolutions:[],expectedResult:{columns:["survivor_count"],rowCount:1,preview:[[342]],fullResult:!0,note:"342 survivors"},explanation:"CTE creates named subquery."},{id:"d25q2",difficulty:"easy-medium",points:10,title:"CTE with Aggregate",description:"First class avg fare via CTE.",solution:"WITH first_class AS (SELECT * FROM passengers WHERE Pclass = 1) SELECT ROUND(AVG(Fare), 2) AS avg_fare FROM first_class;",alternativeSolutions:[],expectedResult:{columns:["avg_fare"],rowCount:1,preview:[[84.15]],fullResult:!0,note:"£84.15 average"},explanation:"CTE simplifies query."},{id:"d25q3",difficulty:"medium",points:15,title:"CTE with Filter",description:"Above-average fare passengers by class.",solution:"WITH above_avg AS (SELECT * FROM passengers WHERE Fare > (SELECT AVG(Fare) FROM passengers)) SELECT Pclass, COUNT(*) AS count FROM above_avg GROUP BY Pclass;",alternativeSolutions:[],expectedResult:{columns:["Pclass","count"],rowCount:3,preview:[[1,145]],note:"Count per class"},explanation:"CTE can contain subqueries."},{id:"d25q4",difficulty:"medium-hard",points:20,title:"Multiple CTEs",description:"Compare male vs female survival.",solution:"WITH males AS (SELECT * FROM passengers WHERE Sex = 'male'), females AS (SELECT * FROM passengers WHERE Sex = 'female') SELECT 'Male' AS sex, ROUND(AVG(Survived) * 100, 1) AS survival_rate FROM males UNION ALL SELECT 'Female', ROUND(AVG(Survived) * 100, 1) FROM females;",alternativeSolutions:[],expectedResult:{columns:["sex","survival_rate"],rowCount:2,preview:[["Male",18.9],["Female",74.2]],fullResult:!0,note:"Gender comparison"},explanation:"Multiple CTEs with comma."},{id:"d25q5",difficulty:"hard",points:25,title:"CTE with Join",description:"Compare passengers to class average.",solution:"WITH class_stats AS (SELECT Pclass, AVG(Fare) AS avg_fare FROM passengers GROUP BY Pclass) SELECT p.Name, p.Pclass, p.Fare, ROUND(c.avg_fare, 2) AS class_avg FROM passengers p JOIN class_stats c ON p.Pclass = c.Pclass;",alternativeSolutions:[],expectedResult:{columns:["Name","Pclass","Fare","class_avg"],rowCount:891,preview:[["Cumings, Mrs. John Bradley",1,71.28,84.15]],note:"Individual vs class avg"},explanation:"CTEs can be joined."}]},{day:26,week:4,title:"IN and EXISTS",description:"Subquery filtering",concepts:["IN","NOT IN","EXISTS"],dataset:"titanic",tableUsed:"passengers",lesson:"# IN and EXISTS\n\nIN checks list membership. EXISTS checks if subquery returns rows.",questions:[{id:"d26q1",difficulty:"easy",points:5,title:"Simple IN",description:"Passengers in class 1 or 2.",solution:"SELECT Name, Pclass FROM passengers WHERE Pclass IN (1, 2);",alternativeSolutions:[],expectedResult:{columns:["Name","Pclass"],rowCount:400,preview:[["Cumings, Mrs. John Bradley",1]],note:"400 passengers"},explanation:"IN checks list."},{id:"d26q2",difficulty:"easy-medium",points:10,title:"NOT IN",description:"NOT in class 3.",solution:"SELECT Name, Pclass FROM passengers WHERE Pclass NOT IN (3);",alternativeSolutions:[],expectedResult:{columns:["Name","Pclass"],rowCount:400,preview:[["Cumings, Mrs. John Bradley",1]],note:"Same result"},explanation:"NOT IN excludes."},{id:"d26q3",difficulty:"medium",points:15,title:"IN with Subquery",description:"From ports with avg fare > $30.",solution:"SELECT Name, Embarked FROM passengers WHERE Embarked IN (SELECT Embarked FROM passengers GROUP BY Embarked HAVING AVG(Fare) > 30);",alternativeSolutions:[],expectedResult:{columns:["Name","Embarked"],rowCount:812,preview:[["Cumings, Mrs. John Bradley","C"]],note:"High-fare ports"},explanation:"Subquery returns list."},{id:"d26q4",difficulty:"medium-hard",points:20,title:"High Max Classes",description:"Classes with max fare > $200.",solution:"SELECT Name, Pclass, Fare FROM passengers WHERE Pclass IN (SELECT Pclass FROM passengers GROUP BY Pclass HAVING MAX(Fare) > 200);",alternativeSolutions:[],expectedResult:{columns:["Name","Pclass","Fare"],rowCount:891,preview:[["Braund, Mr. Owen Harris",3,7.25]],note:"All classes!"},explanation:"All classes had >$200."},{id:"d26q5",difficulty:"hard",points:25,title:"Not Max Fare",description:"Not paying class max fare.",solution:"SELECT Name, Pclass, Fare FROM passengers WHERE Fare NOT IN (SELECT MAX(Fare) FROM passengers GROUP BY Pclass);",alternativeSolutions:[],expectedResult:{columns:["Name","Pclass","Fare"],rowCount:885,preview:[["Braund, Mr. Owen Harris",3,7.25]],note:"Excludes 6 top payers"},explanation:"Excludes max per class."}]},{day:27,week:4,title:"COALESCE and NULLIF",description:"Elegant NULL handling",concepts:["COALESCE","NULLIF"],dataset:"titanic",tableUsed:"passengers",lesson:"# COALESCE and NULLIF\n\nCOALESCE: first non-NULL. NULLIF: NULL if equal.",questions:[{id:"d27q1",difficulty:"easy",points:5,title:"Replace NULL",description:"NULL embarked → 'Unknown'.",solution:"SELECT name, COALESCE(embarked, 'Unknown') AS port FROM passengers;",alternativeSolutions:[],expectedResult:{columns:["name","port"],rowCount:891,preview:[["Braund, Mr. Owen Harris","S"]],note:"NULL → 'Unknown'"},explanation:"COALESCE provides default."},{id:"d27q2",difficulty:"easy-medium",points:10,title:"Default Age",description:"NULL ages → 0.",solution:"SELECT Name, COALESCE(Age, 0) AS age FROM passengers;",alternativeSolutions:[],expectedResult:{columns:["Name","age"],rowCount:891,preview:[["Braund, Mr. Owen Harris",22]],note:"NULL → 0"},explanation:"Replace NULL with 0."},{id:"d27q3",difficulty:"medium",points:15,title:"Chain Defaults",description:"Empty string AND NULL → 'Unknown'.",solution:"SELECT Name, COALESCE(NULLIF(Embarked, ''), 'Unknown') AS port FROM passengers;",alternativeSolutions:[],expectedResult:{columns:["Name","port"],rowCount:891,preview:[["Braund, Mr. Owen Harris","S"]],note:"Empty → NULL → default"},explanation:"NULLIF converts empty to NULL."},{id:"d27q4",difficulty:"medium-hard",points:20,title:"Average with Default",description:"Avg age treating NULL as 30.",solution:"SELECT ROUND(AVG(COALESCE(Age, 30)), 2) AS avg_age_filled FROM passengers;",alternativeSolutions:[],expectedResult:{columns:["avg_age_filled"],rowCount:1,preview:[[29.76]],fullResult:!0,note:"NULLs counted as 30"},explanation:"Fill before averaging."},{id:"d27q5",difficulty:"hard",points:25,title:"Safe Division",description:"Fare per person avoiding div/0.",solution:"SELECT Name, Fare, SibSp + Parch + 1 AS family, Fare / NULLIF(SibSp + Parch + 1, 0) AS fare_per_person FROM passengers;",alternativeSolutions:[],expectedResult:{columns:["Name","Fare","family","fare_per_person"],rowCount:891,preview:[["Braund, Mr. Owen Harris",7.25,2,3.625]],note:"Safe division"},explanation:"NULLIF prevents div/0."}]},{day:28,week:4,title:"BETWEEN",description:"Range filtering",concepts:["BETWEEN","NOT BETWEEN"],dataset:"titanic",tableUsed:"passengers",lesson:"# BETWEEN\n\nBETWEEN is inclusive: 20 AND 40 means 20 ≤ x ≤ 40.",questions:[{id:"d28q1",difficulty:"easy",points:5,title:"Age Range",description:"Passengers aged 20-30.",solution:"SELECT Name, Age FROM passengers WHERE Age BETWEEN 20 AND 30;",alternativeSolutions:[],expectedResult:{columns:["Name","Age"],rowCount:220,preview:[["Braund, Mr. Owen Harris",22]],note:"220 passengers"},explanation:"BETWEEN is inclusive."},{id:"d28q2",difficulty:"easy-medium",points:10,title:"Fare Range",description:"Fares $50-$100.",solution:"SELECT Name, Fare FROM passengers WHERE Fare BETWEEN 50 AND 100;",alternativeSolutions:[],expectedResult:{columns:["Name","Fare"],rowCount:52,preview:[["Cumings, Mrs. John Bradley",71.28]],note:"52 in range"},explanation:"Works with decimals."},{id:"d28q3",difficulty:"medium",points:15,title:"NOT BETWEEN",description:"Ages NOT 18-60.",solution:"SELECT Name, Age FROM passengers WHERE Age NOT BETWEEN 18 AND 60 AND Age IS NOT NULL;",alternativeSolutions:[],expectedResult:{columns:["Name","Age"],rowCount:151,preview:[["Palsson, Master. Gosta Leonard",2]],note:"Children and seniors"},explanation:"NOT BETWEEN for outside."},{id:"d28q4",difficulty:"medium-hard",points:20,title:"Combined Filters",description:"Class 1/2, aged 30-50.",solution:"SELECT Name, Pclass, Age FROM passengers WHERE Pclass IN (1, 2) AND Age BETWEEN 30 AND 50;",alternativeSolutions:[],expectedResult:{columns:["Name","Pclass","Age"],rowCount:150,preview:[["Cumings, Mrs. John Bradley",1,38]],note:"IN + BETWEEN"},explanation:"Combine filters."},{id:"d28q5",difficulty:"hard",points:25,title:"Fare Brackets",description:"Count in fare brackets: 0-20, 20-50, 50-100, 100+.",solution:"SELECT SUM(CASE WHEN Fare BETWEEN 0 AND 20 THEN 1 ELSE 0 END) AS budget, SUM(CASE WHEN Fare > 20 AND Fare <= 50 THEN 1 ELSE 0 END) AS standard, SUM(CASE WHEN Fare > 50 AND Fare <= 100 THEN 1 ELSE 0 END) AS premium, SUM(CASE WHEN Fare > 100 THEN 1 ELSE 0 END) AS luxury FROM passengers;",alternativeSolutions:[],expectedResult:{columns:["budget","standard","premium","luxury"],rowCount:1,preview:[[635,164,52,40]],fullResult:!0,note:"Fare brackets"},explanation:"CASE with BETWEEN."}]},{day:29,week:5,title:"Query Optimization",description:"Write efficient queries",concepts:["Best practices","Performance"],dataset:"titanic",tableUsed:"passengers",lesson:"# Query Optimization\n\n1. Select only needed columns\n2. Filter early\n3. Use LIMIT for testing",questions:[{id:"d29q1",difficulty:"easy",points:5,title:"Specific Columns",description:"Only Name and Fare for class 1.",solution:"SELECT Name, Fare FROM passengers WHERE Pclass = 1;",alternativeSolutions:[],expectedResult:{columns:["Name","Fare"],rowCount:216,preview:[["Cumings, Mrs. John Bradley",71.28]],note:"2 columns, not *"},explanation:"Specific > SELECT *"},{id:"d29q2",difficulty:"easy-medium",points:10,title:"Filter First",description:"Top 5 first class fares.",solution:"SELECT Name, Fare FROM passengers WHERE Pclass = 1 ORDER BY Fare DESC LIMIT 5;",alternativeSolutions:[],expectedResult:{columns:["Name","Fare"],rowCount:5,preview:[["Ward, Miss. Anna",512.33]],fullResult:!1,note:"Filter, sort, limit"},explanation:"Filter → sort → limit."},{id:"d29q3",difficulty:"medium",points:15,title:"Test Sample",description:"Sample 10 passengers.",solution:"SELECT Name, Age, Fare FROM passengers ORDER BY PassengerId LIMIT 10;",alternativeSolutions:[],expectedResult:{columns:["Name","Age","Fare"],rowCount:10,preview:[["Braund, Mr. Owen Harris",22,7.25]],note:"LIMIT for testing"},explanation:"LIMIT for quick tests."},{id:"d29q4",difficulty:"medium-hard",points:20,title:"Efficient Count",description:"Count first class survivors.",solution:"SELECT COUNT(*) AS first_class_survivors FROM passengers WHERE Pclass = 1 AND Survived = 1;",alternativeSolutions:[],expectedResult:{columns:["first_class_survivors"],rowCount:1,preview:[[136]],fullResult:!0,note:"Direct filter"},explanation:"WHERE faster than CASE."},{id:"d29q5",difficulty:"hard",points:25,title:"Optimized Analysis",description:"Avg fare by class with 100+ passengers.",solution:"SELECT Pclass, ROUND(AVG(Fare), 2) AS avg_fare, COUNT(*) AS count FROM passengers GROUP BY Pclass HAVING COUNT(*) >= 100 ORDER BY Pclass;",alternativeSolutions:[],expectedResult:{columns:["Pclass","avg_fare","count"],rowCount:3,preview:[[1,84.15,216],[2,20.66,184],[3,13.68,491]],fullResult:!0,note:"All classes qualify"},explanation:"GROUP + HAVING + ORDER."}]},{day:30,week:5,title:"Final Challenge",description:"Combine everything!",concepts:["All concepts"],dataset:"titanic",tableUsed:"passengers",tableSchema:[{column:"PassengerId",type:"INTEGER",description:"Unique ID (1-891)"},{column:"Survived",type:"INTEGER",description:"0=Died, 1=Survived"},{column:"Pclass",type:"INTEGER",description:"1=First, 2=Second, 3=Third"},{column:"Name",type:"TEXT",description:"Full name with title"},{column:"Sex",type:"TEXT",description:"'male' or 'female'"},{column:"Age",type:"REAL",description:"Age in years (177 NULL)"},{column:"SibSp",type:"INTEGER",description:"Siblings/spouses aboard"},{column:"Parch",type:"INTEGER",description:"Parents/children aboard"},{column:"Fare",type:"REAL",description:"Ticket price (£)"},{column:"Embarked",type:"TEXT",description:"S/C/Q port code"}],lesson:"# Final Challenge 🏆\n\nCongratulations on Day 30! Combine everything you've learned.",questions:[{id:"d30q1",difficulty:"easy",points:5,title:"Survival Summary",description:"Total, survivors, deaths, survival_rate (%).",solution:"SELECT COUNT(*) AS total, SUM(Survived) AS survivors, COUNT(*) - SUM(Survived) AS deaths, ROUND(AVG(Survived) * 100, 1) AS survival_rate FROM passengers;",alternativeSolutions:[],expectedResult:{columns:["total","survivors","deaths","survival_rate"],rowCount:1,preview:[[891,342,549,38.4]],fullResult:!0,note:"Complete overview"},explanation:"891 passengers, 342 survived (38.4%)."},{id:"d30q2",difficulty:"easy-medium",points:10,title:"Class & Gender",description:"Survival rate by Pclass and Sex, ordered.",solution:"SELECT Pclass, Sex, COUNT(*) AS count, ROUND(AVG(Survived) * 100, 1) AS survival_rate FROM passengers GROUP BY Pclass, Sex ORDER BY survival_rate DESC;",alternativeSolutions:[],expectedResult:{columns:["Pclass","Sex","count","survival_rate"],rowCount:6,preview:[[1,"female",94,96.8],[2,"female",76,92.1],[3,"female",144,50],[1,"male",122,36.9],[2,"male",108,15.7],[3,"male",347,13.5]],fullResult:!0,note:"First class women: 97%!"},explanation:"Class × gender survival analysis."},{id:"d30q3",difficulty:"medium",points:15,title:"Age Groups",description:"Survival by Child/Adult/Senior.",solution:"SELECT CASE WHEN Age < 18 THEN 'Child' WHEN Age <= 60 THEN 'Adult' ELSE 'Senior' END AS age_group, COUNT(*) AS count, ROUND(AVG(Survived) * 100, 1) AS survival_rate FROM passengers WHERE Age IS NOT NULL GROUP BY CASE WHEN Age < 18 THEN 'Child' WHEN Age <= 60 THEN 'Adult' ELSE 'Senior' END ORDER BY survival_rate DESC;",alternativeSolutions:[],expectedResult:{columns:["age_group","count","survival_rate"],rowCount:3,preview:[["Child",113,54],["Adult",563,38.4],["Senior",38,22.7]],fullResult:!0,note:"Children: 54% survival"},explanation:"Age group analysis with CASE."},{id:"d30q4",difficulty:"medium-hard",points:20,title:"Top Survivors",description:"Top 3 highest-paying survivors per class.",solution:"SELECT * FROM (SELECT Name, Pclass, Fare, ROW_NUMBER() OVER (PARTITION BY Pclass ORDER BY Fare DESC) AS rank FROM passengers WHERE Survived = 1) WHERE rank <= 3 ORDER BY Pclass, rank;",alternativeSolutions:[],expectedResult:{columns:["Name","Pclass","Fare","rank"],rowCount:9,preview:[["Cardeza, Mr. Thomas Drake Martinez",1,512.33,1],["Ward, Miss. Anna",1,512.33,2]],note:"Top 3 per class"},explanation:"Window function + filter."},{id:"d30q5",difficulty:"hard",points:25,title:"Port Analysis",description:"Per port: passengers, survivors, avg_fare, avg_age, common_class.",solution:"WITH port_stats AS (SELECT Embarked, COUNT(*) AS passengers, SUM(Survived) AS survivors, ROUND(AVG(Fare), 2) AS avg_fare, ROUND(AVG(Age), 1) AS avg_age FROM passengers WHERE Embarked IS NOT NULL AND Embarked != '' GROUP BY Embarked) SELECT p.*, (SELECT Pclass FROM passengers WHERE Embarked = p.Embarked GROUP BY Pclass ORDER BY COUNT(*) DESC LIMIT 1) AS common_class FROM port_stats p ORDER BY passengers DESC;",alternativeSolutions:[],expectedResult:{columns:["Embarked","passengers","survivors","avg_fare","avg_age","common_class"],rowCount:3,preview:[["S",644,217,27.08,29.4,3],["C",168,93,59.95,30.8,1],["Q",77,30,13.28,28.1,3]],fullResult:!0,note:"Complete port analysis!"},explanation:"CTE + aggregates + correlated subquery!"}]}];window.sqlChallenge30Days&&window.sqlChallenge30Days.days&&(window.sqlChallenge30Days.days=window.sqlChallenge30Days.days.concat(e)),console.log("Days 16-30 loaded: "+e.length+" days, "+5*e.length+" questions")}(),window.getDayData=function(e){return window.sqlChallenge30Days?.days?.find(s=>s.day===e)},window.challengeScoring={easy:{points:5,hintPenalty:2},"easy-medium":{points:10,hintPenalty:3},medium:{points:15,hintPenalty:5},"medium-hard":{points:20,hintPenalty:6},hard:{points:25,hintPenalty:8},passRequirement:3,perfectBonus:10},console.log("30-Day SQL Challenge complete!");